(self.webpackChunkbattleship=self.webpackChunkbattleship||[]).push([[519],{227:(t,e,r)=>{"use strict";r.d(e,{Z:()=>pn});var i=r(1798),n=r.n(i);function a(t,e,r,i,n,a,s){try{var o=t[a](s),h=o.value}catch(t){return void r(t)}o.done?e(h):Promise.resolve(h).then(i,n)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var s=t.apply(e,r);function o(t){a(s,i,n,o,h,"next",t)}function h(t){a(s,i,n,o,h,"throw",t)}o(void 0)}))}}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(8674),r(4723),r(5306),r(3157),r(6992),r(3948),r(5827),r(7852),r(3123);var h=r(4087),l=(r(3210),r(6131)),c=(r(2023),r(2772),r(5069),function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)});function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function d(t,e){var r=t[0],i=t[1];return[r*Math.cos(e)-i*Math.sin(e),r*Math.sin(e)+i*Math.cos(e)]}function g(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r++)if("number"!=typeof t[r])throw new Error("assertNumbers arguments["+r+"] is not a number. "+typeof t[r]+" == typeof "+t[r]);return!0}var f=Math.PI;function p(t,e,r){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var i=t.rX,n=t.rY,a=t.x,s=t.y;i=Math.abs(t.rX),n=Math.abs(t.rY);var o=d([(e-a)/2,(r-s)/2],-t.xRot/180*f),h=o[0],l=o[1],c=Math.pow(h,2)/Math.pow(i,2)+Math.pow(l,2)/Math.pow(n,2);1<c&&(i*=Math.sqrt(c),n*=Math.sqrt(c)),t.rX=i,t.rY=n;var u=Math.pow(i,2)*Math.pow(l,2)+Math.pow(n,2)*Math.pow(h,2),g=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(i,2)*Math.pow(n,2)-u)/u)),p=i*l/n*g,v=-n*h/i*g,m=d([p,v],t.xRot/180*f);t.cX=m[0]+(e+a)/2,t.cY=m[1]+(r+s)/2,t.phi1=Math.atan2((l-v)/n,(h-p)/i),t.phi2=Math.atan2((-l-v)/n,(-h-p)/i),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*f),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*f),t.phi1*=180/f,t.phi2*=180/f}function v(t,e,r){g(t,e,r);var i=t*t+e*e-r*r;if(0>i)return[];if(0===i)return[[t*r/(t*t+e*e),e*r/(t*t+e*e)]];var n=Math.sqrt(i);return[[(t*r+e*n)/(t*t+e*e),(e*r-t*n)/(t*t+e*e)],[(t*r-e*n)/(t*t+e*e),(e*r+t*n)/(t*t+e*e)]]}var m,y=Math.PI/180;function x(t,e,r){return(1-r)*t+r*e}function b(t,e,r,i){return t+Math.cos(i/180*f)*e+Math.sin(i/180*f)*r}function _(t,e,r,i){var n=1e-6,a=e-t,s=r-e,o=3*a+3*(i-r)-6*s,h=6*(s-a),l=3*a;return Math.abs(o)<n?[-l/h]:function(t,e,r){void 0===r&&(r=1e-6);var i=t*t/4-e;if(i<-r)return[];if(i<=r)return[-t/2];var n=Math.sqrt(i);return[-t/2-n,-t/2+n]}(h/o,l/o,n)}function S(t,e,r,i,n){var a=1-n;return t*(a*a*a)+e*(3*a*a*n)+r*(3*a*n*n)+i*(n*n*n)}!function(t){function e(){return n((function(t,e,r){return t.relative&&(void 0!==t.x1&&(t.x1+=e),void 0!==t.y1&&(t.y1+=r),void 0!==t.x2&&(t.x2+=e),void 0!==t.y2&&(t.y2+=r),void 0!==t.x&&(t.x+=e),void 0!==t.y&&(t.y+=r),t.relative=!1),t}))}function r(){var t=NaN,e=NaN,r=NaN,i=NaN;return n((function(n,a,s){return n.type&O.SMOOTH_CURVE_TO&&(n.type=O.CURVE_TO,t=isNaN(t)?a:t,e=isNaN(e)?s:e,n.x1=n.relative?a-t:2*a-t,n.y1=n.relative?s-e:2*s-e),n.type&O.CURVE_TO?(t=n.relative?a+n.x2:n.x2,e=n.relative?s+n.y2:n.y2):(t=NaN,e=NaN),n.type&O.SMOOTH_QUAD_TO&&(n.type=O.QUAD_TO,r=isNaN(r)?a:r,i=isNaN(i)?s:i,n.x1=n.relative?a-r:2*a-r,n.y1=n.relative?s-i:2*s-i),n.type&O.QUAD_TO?(r=n.relative?a+n.x1:n.x1,i=n.relative?s+n.y1:n.y1):(r=NaN,i=NaN),n}))}function i(){var t=NaN,e=NaN;return n((function(r,i,n){if(r.type&O.SMOOTH_QUAD_TO&&(r.type=O.QUAD_TO,t=isNaN(t)?i:t,e=isNaN(e)?n:e,r.x1=r.relative?i-t:2*i-t,r.y1=r.relative?n-e:2*n-e),r.type&O.QUAD_TO){t=r.relative?i+r.x1:r.x1,e=r.relative?n+r.y1:r.y1;var a=r.x1,s=r.y1;r.type=O.CURVE_TO,r.x1=((r.relative?0:i)+2*a)/3,r.y1=((r.relative?0:n)+2*s)/3,r.x2=(r.x+2*a)/3,r.y2=(r.y+2*s)/3}else t=NaN,e=NaN;return r}))}function n(t){var e=0,r=0,i=NaN,n=NaN;return function(a){if(isNaN(i)&&!(a.type&O.MOVE_TO))throw new Error("path must start with moveto");var s=t(a,e,r,i,n);return a.type&O.CLOSE_PATH&&(e=i,r=n),void 0!==a.x&&(e=a.relative?e+a.x:a.x),void 0!==a.y&&(r=a.relative?r+a.y:a.y),a.type&O.MOVE_TO&&(i=e,n=r),s}}function a(t,e,r,i,a,s){return g(t,e,r,i,a,s),n((function(n,o,h,l){var c=n.x1,u=n.x2,d=n.relative&&!isNaN(l),g=void 0!==n.x?n.x:d?0:o,f=void 0!==n.y?n.y:d?0:h;function p(t){return t*t}n.type&O.HORIZ_LINE_TO&&0!==e&&(n.type=O.LINE_TO,n.y=n.relative?0:h),n.type&O.VERT_LINE_TO&&0!==r&&(n.type=O.LINE_TO,n.x=n.relative?0:o),void 0!==n.x&&(n.x=n.x*t+f*r+(d?0:a)),void 0!==n.y&&(n.y=g*e+n.y*i+(d?0:s)),void 0!==n.x1&&(n.x1=n.x1*t+n.y1*r+(d?0:a)),void 0!==n.y1&&(n.y1=c*e+n.y1*i+(d?0:s)),void 0!==n.x2&&(n.x2=n.x2*t+n.y2*r+(d?0:a)),void 0!==n.y2&&(n.y2=u*e+n.y2*i+(d?0:s));var v=t*i-e*r;if(void 0!==n.xRot&&(1!==t||0!==e||0!==r||1!==i))if(0===v)delete n.rX,delete n.rY,delete n.xRot,delete n.lArcFlag,delete n.sweepFlag,n.type=O.LINE_TO;else{var m=n.xRot*Math.PI/180,y=Math.sin(m),x=Math.cos(m),b=1/p(n.rX),_=1/p(n.rY),S=p(x)*b+p(y)*_,w=2*y*x*(b-_),C=p(y)*b+p(x)*_,P=S*i*i-w*e*i+C*e*e,A=w*(t*i+e*r)-2*(S*r*i+C*t*e),T=S*r*r-w*t*r+C*t*t,k=(Math.atan2(A,P-T)+Math.PI)%Math.PI/2,M=Math.sin(k),E=Math.cos(k);n.rX=Math.abs(v)/Math.sqrt(P*p(E)+A*M*E+T*p(M)),n.rY=Math.abs(v)/Math.sqrt(P*p(M)-A*M*E+T*p(E)),n.xRot=180*k/Math.PI}return void 0!==n.sweepFlag&&0>v&&(n.sweepFlag=+!n.sweepFlag),n}))}t.ROUND=function(t){function e(e){return Math.round(e*t)/t}return void 0===t&&(t=1e13),g(t),function(t){return void 0!==t.x1&&(t.x1=e(t.x1)),void 0!==t.y1&&(t.y1=e(t.y1)),void 0!==t.x2&&(t.x2=e(t.x2)),void 0!==t.y2&&(t.y2=e(t.y2)),void 0!==t.x&&(t.x=e(t.x)),void 0!==t.y&&(t.y=e(t.y)),void 0!==t.rX&&(t.rX=e(t.rX)),void 0!==t.rY&&(t.rY=e(t.rY)),t}},t.TO_ABS=e,t.TO_REL=function(){return n((function(t,e,r){return t.relative||(void 0!==t.x1&&(t.x1-=e),void 0!==t.y1&&(t.y1-=r),void 0!==t.x2&&(t.x2-=e),void 0!==t.y2&&(t.y2-=r),void 0!==t.x&&(t.x-=e),void 0!==t.y&&(t.y-=r),t.relative=!0),t}))},t.NORMALIZE_HVZ=function(t,e,r){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===r&&(r=!0),n((function(i,n,a,s,o){if(isNaN(s)&&!(i.type&O.MOVE_TO))throw new Error("path must start with moveto");return e&&i.type&O.HORIZ_LINE_TO&&(i.type=O.LINE_TO,i.y=i.relative?0:a),r&&i.type&O.VERT_LINE_TO&&(i.type=O.LINE_TO,i.x=i.relative?0:n),t&&i.type&O.CLOSE_PATH&&(i.type=O.LINE_TO,i.x=i.relative?s-n:s,i.y=i.relative?o-a:o),i.type&O.ARC&&(0===i.rX||0===i.rY)&&(i.type=O.LINE_TO,delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag),i}))},t.NORMALIZE_ST=r,t.QT_TO_C=i,t.INFO=n,t.SANITIZE=function(t){void 0===t&&(t=0),g(t);var e=NaN,r=NaN,i=NaN,a=NaN;return n((function(n,s,o,h,l){var c=Math.abs,u=!1,d=0,g=0;if(n.type&O.SMOOTH_CURVE_TO&&(d=isNaN(e)?0:s-e,g=isNaN(r)?0:o-r),n.type&(O.CURVE_TO|O.SMOOTH_CURVE_TO)?(e=n.relative?s+n.x2:n.x2,r=n.relative?o+n.y2:n.y2):(e=NaN,r=NaN),n.type&O.SMOOTH_QUAD_TO?(i=isNaN(i)?s:2*s-i,a=isNaN(a)?o:2*o-a):n.type&O.QUAD_TO?(i=n.relative?s+n.x1:n.x1,a=n.relative?o+n.y1:n.y2):(i=NaN,a=NaN),n.type&O.LINE_COMMANDS||n.type&O.ARC&&(0===n.rX||0===n.rY||!n.lArcFlag)||n.type&O.CURVE_TO||n.type&O.SMOOTH_CURVE_TO||n.type&O.QUAD_TO||n.type&O.SMOOTH_QUAD_TO){var f=void 0===n.x?0:n.relative?n.x:n.x-s,p=void 0===n.y?0:n.relative?n.y:n.y-o;d=isNaN(i)?void 0===n.x1?d:n.relative?n.x:n.x1-s:i-s,g=isNaN(a)?void 0===n.y1?g:n.relative?n.y:n.y1-o:a-o;var v=void 0===n.x2?0:n.relative?n.x:n.x2-s,m=void 0===n.y2?0:n.relative?n.y:n.y2-o;c(f)<=t&&c(p)<=t&&c(d)<=t&&c(g)<=t&&c(v)<=t&&c(m)<=t&&(u=!0)}return n.type&O.CLOSE_PATH&&c(s-h)<=t&&c(o-l)<=t&&(u=!0),u?[]:n}))},t.MATRIX=a,t.ROTATE=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=0),g(t,e,r);var i=Math.sin(t),n=Math.cos(t);return a(n,i,-i,n,e-e*n+r*i,r-e*i-r*n)},t.TRANSLATE=function(t,e){return void 0===e&&(e=0),g(t,e),a(1,0,0,1,t,e)},t.SCALE=function(t,e){return void 0===e&&(e=t),g(t,e),a(t,0,0,e,0,0)},t.SKEW_X=function(t){return g(t),a(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return g(t),a(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),g(t),a(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),g(t),a(1,0,0,-1,0,t)},t.A_TO_C=function(){return n((function(t,e,r){return O.ARC===t.type?function(t,e,r){var i,n,a,s;t.cX||p(t,e,r);for(var o=Math.min(t.phi1,t.phi2),h=Math.max(t.phi1,t.phi2)-o,l=Math.ceil(h/90),c=new Array(l),u=e,g=r,f=0;f<l;f++){var v=x(t.phi1,t.phi2,f/l),m=x(t.phi1,t.phi2,(f+1)/l),b=m-v,_=4/3*Math.tan(b*y/4),S=[Math.cos(v*y)-_*Math.sin(v*y),Math.sin(v*y)+_*Math.cos(v*y)],w=S[0],C=S[1],P=[Math.cos(m*y),Math.sin(m*y)],A=P[0],T=P[1],k=[A+_*Math.sin(m*y),T-_*Math.cos(m*y)],M=k[0],E=k[1];c[f]={relative:t.relative,type:O.CURVE_TO};var R=function(e,r){var i=d([e*t.rX,r*t.rY],t.xRot),n=i[0],a=i[1];return[t.cX+n,t.cY+a]};i=R(w,C),c[f].x1=i[0],c[f].y1=i[1],n=R(M,E),c[f].x2=n[0],c[f].y2=n[1],a=R(A,T),c[f].x=a[0],c[f].y=a[1],t.relative&&(c[f].x1-=u,c[f].y1-=g,c[f].x2-=u,c[f].y2-=g,c[f].x-=u,c[f].y-=g),u=(s=[c[f].x,c[f].y])[0],g=s[1]}return c}(t,t.relative?0:e,t.relative?0:r):t}))},t.ANNOTATE_ARCS=function(){return n((function(t,e,r){return t.relative&&(e=0,r=0),O.ARC===t.type&&p(t,e,r),t}))},t.CLONE=function(){return function(t){var e={};for(var r in t)e[r]=t[r];return e}},t.CALCULATE_BOUNDS=function(){var t=e(),a=i(),s=r(),o=n((function(e,r,i){var n=s(a(t(function(t){var e={};for(var r in t)e[r]=t[r];return e}(e))));function h(t){t>o.maxX&&(o.maxX=t),t<o.minX&&(o.minX=t)}function l(t){t>o.maxY&&(o.maxY=t),t<o.minY&&(o.minY=t)}if(n.type&O.DRAWING_COMMANDS&&(h(r),l(i)),n.type&O.HORIZ_LINE_TO&&h(n.x),n.type&O.VERT_LINE_TO&&l(n.y),n.type&O.LINE_TO&&(h(n.x),l(n.y)),n.type&O.CURVE_TO){h(n.x),l(n.y);for(var c=0,u=_(r,n.x1,n.x2,n.x);c<u.length;c++)0<(L=u[c])&&1>L&&h(S(r,n.x1,n.x2,n.x,L));for(var d=0,g=_(i,n.y1,n.y2,n.y);d<g.length;d++)0<(L=g[d])&&1>L&&l(S(i,n.y1,n.y2,n.y,L))}if(n.type&O.ARC){h(n.x),l(n.y),p(n,r,i);for(var f=n.xRot/180*Math.PI,m=Math.cos(f)*n.rX,y=Math.sin(f)*n.rX,x=-Math.sin(f)*n.rY,w=Math.cos(f)*n.rY,C=n.phi1<n.phi2?[n.phi1,n.phi2]:-180>n.phi2?[n.phi2+360,n.phi1+360]:[n.phi2,n.phi1],P=C[0],A=C[1],T=function(t){var e=t[0],r=t[1],i=180*Math.atan2(r,e)/Math.PI;return i<P?i+360:i},k=0,M=v(x,-m,0).map(T);k<M.length;k++)(L=M[k])>P&&L<A&&h(b(n.cX,m,x,L));for(var E=0,R=v(w,-y,0).map(T);E<R.length;E++){var L;(L=R[E])>P&&L<A&&l(b(n.cY,y,w,L))}}return e}));return o.minX=1/0,o.maxX=-1/0,o.minY=1/0,o.maxY=-1/0,o}}(m||(m={}));var w,C=function(){function t(){}return t.prototype.round=function(t){return this.transform(m.ROUND(t))},t.prototype.toAbs=function(){return this.transform(m.TO_ABS())},t.prototype.toRel=function(){return this.transform(m.TO_REL())},t.prototype.normalizeHVZ=function(t,e,r){return this.transform(m.NORMALIZE_HVZ(t,e,r))},t.prototype.normalizeST=function(){return this.transform(m.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(m.QT_TO_C())},t.prototype.aToC=function(){return this.transform(m.A_TO_C())},t.prototype.sanitize=function(t){return this.transform(m.SANITIZE(t))},t.prototype.translate=function(t,e){return this.transform(m.TRANSLATE(t,e))},t.prototype.scale=function(t,e){return this.transform(m.SCALE(t,e))},t.prototype.rotate=function(t,e,r){return this.transform(m.ROTATE(t,e,r))},t.prototype.matrix=function(t,e,r,i,n,a){return this.transform(m.MATRIX(t,e,r,i,n,a))},t.prototype.skewX=function(t){return this.transform(m.SKEW_X(t))},t.prototype.skewY=function(t){return this.transform(m.SKEW_Y(t))},t.prototype.xSymmetry=function(t){return this.transform(m.X_AXIS_SYMMETRY(t))},t.prototype.ySymmetry=function(t){return this.transform(m.Y_AXIS_SYMMETRY(t))},t.prototype.annotateArcs=function(){return this.transform(m.ANNOTATE_ARCS())},t}(),P=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},A=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},T=function(t){function e(){var e=t.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return u(e,t),e.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},e.prototype.parse=function(t,e){var r=this;void 0===e&&(e=[]);for(var i=function(t){e.push(t),r.curArgs.length=0,r.canParseCommandOrComma=!0},n=0;n<t.length;n++){var a=t[n],s=!(this.curCommandType!==O.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),o=A(a)&&("0"===this.curNumber&&"0"===a||s);if(!A(a)||o)if("e"!==a&&"E"!==a)if("-"!==a&&"+"!==a||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==a||this.curNumberHasExp||this.curNumberHasDecimal||s){if(this.curNumber&&-1!==this.curCommandType){var h=Number(this.curNumber);if(isNaN(h))throw new SyntaxError("Invalid number ending at "+n);if(this.curCommandType===O.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>h)throw new SyntaxError('Expected positive number, got "'+h+'" at index "'+n+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+n+'"');this.curArgs.push(h),this.curArgs.length===k[this.curCommandType]&&(O.HORIZ_LINE_TO===this.curCommandType?i({type:O.HORIZ_LINE_TO,relative:this.curCommandRelative,x:h}):O.VERT_LINE_TO===this.curCommandType?i({type:O.VERT_LINE_TO,relative:this.curCommandRelative,y:h}):this.curCommandType===O.MOVE_TO||this.curCommandType===O.LINE_TO||this.curCommandType===O.SMOOTH_QUAD_TO?(i({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),O.MOVE_TO===this.curCommandType&&(this.curCommandType=O.LINE_TO)):this.curCommandType===O.CURVE_TO?i({type:O.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===O.SMOOTH_CURVE_TO?i({type:O.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===O.QUAD_TO?i({type:O.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===O.ARC&&i({type:O.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!P(a))if(","===a&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==a&&"-"!==a&&"."!==a)if(o)this.curNumber=a,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+n+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+a+'" at index '+n+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==a&&"Z"!==a)if("h"===a||"H"===a)this.curCommandType=O.HORIZ_LINE_TO,this.curCommandRelative="h"===a;else if("v"===a||"V"===a)this.curCommandType=O.VERT_LINE_TO,this.curCommandRelative="v"===a;else if("m"===a||"M"===a)this.curCommandType=O.MOVE_TO,this.curCommandRelative="m"===a;else if("l"===a||"L"===a)this.curCommandType=O.LINE_TO,this.curCommandRelative="l"===a;else if("c"===a||"C"===a)this.curCommandType=O.CURVE_TO,this.curCommandRelative="c"===a;else if("s"===a||"S"===a)this.curCommandType=O.SMOOTH_CURVE_TO,this.curCommandRelative="s"===a;else if("q"===a||"Q"===a)this.curCommandType=O.QUAD_TO,this.curCommandRelative="q"===a;else if("t"===a||"T"===a)this.curCommandType=O.SMOOTH_QUAD_TO,this.curCommandRelative="t"===a;else{if("a"!==a&&"A"!==a)throw new SyntaxError('Unexpected character "'+a+'" at index '+n+".");this.curCommandType=O.ARC,this.curCommandRelative="a"===a}else e.push({type:O.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=a,this.curNumberHasDecimal="."===a}else this.curNumber+=a,this.curNumberHasDecimal=!0;else this.curNumber+=a;else this.curNumber+=a,this.curNumberHasExp=!0;else this.curNumber+=a,this.curNumberHasExpDigits=this.curNumberHasExp}return e},e.prototype.transform=function(t){return Object.create(this,{parse:{value:function(e,r){void 0===r&&(r=[]);for(var i=0,n=Object.getPrototypeOf(this).parse.call(this,e);i<n.length;i++){var a=n[i],s=t(a);Array.isArray(s)?r.push.apply(r,s):r.push(s)}return r}}})},e}(C),O=function(t){function e(r){var i=t.call(this)||this;return i.commands="string"==typeof r?e.parse(r):r,i}return u(e,t),e.prototype.encode=function(){return e.encode(this.commands)},e.prototype.getBounds=function(){var t=m.CALCULATE_BOUNDS();return this.transform(t),t},e.prototype.transform=function(t){for(var e=[],r=0,i=this.commands;r<i.length;r++){var n=t(i[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return this.commands=e,this},e.encode=function(t){return function(t){var e="";Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var i=t[r];if(i.type===O.CLOSE_PATH)e+="z";else if(i.type===O.HORIZ_LINE_TO)e+=(i.relative?"h":"H")+i.x;else if(i.type===O.VERT_LINE_TO)e+=(i.relative?"v":"V")+i.y;else if(i.type===O.MOVE_TO)e+=(i.relative?"m":"M")+i.x+" "+i.y;else if(i.type===O.LINE_TO)e+=(i.relative?"l":"L")+i.x+" "+i.y;else if(i.type===O.CURVE_TO)e+=(i.relative?"c":"C")+i.x1+" "+i.y1+" "+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===O.SMOOTH_CURVE_TO)e+=(i.relative?"s":"S")+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===O.QUAD_TO)e+=(i.relative?"q":"Q")+i.x1+" "+i.y1+" "+i.x+" "+i.y;else if(i.type===O.SMOOTH_QUAD_TO)e+=(i.relative?"t":"T")+i.x+" "+i.y;else{if(i.type!==O.ARC)throw new Error('Unexpected command type "'+i.type+'" at index '+r+".");e+=(i.relative?"a":"A")+i.rX+" "+i.rY+" "+i.xRot+" "+ +i.lArcFlag+" "+ +i.sweepFlag+" "+i.x+" "+i.y}}return e}(t)},e.parse=function(t){var e=new T,r=[];return e.parse(t,r),e.finish(r),r},e.CLOSE_PATH=1,e.MOVE_TO=2,e.HORIZ_LINE_TO=4,e.VERT_LINE_TO=8,e.LINE_TO=16,e.CURVE_TO=32,e.SMOOTH_CURVE_TO=64,e.QUAD_TO=128,e.SMOOTH_QUAD_TO=256,e.ARC=512,e.LINE_COMMANDS=e.LINE_TO|e.HORIZ_LINE_TO|e.VERT_LINE_TO,e.DRAWING_COMMANDS=e.HORIZ_LINE_TO|e.VERT_LINE_TO|e.LINE_TO|e.CURVE_TO|e.SMOOTH_CURVE_TO|e.QUAD_TO|e.SMOOTH_QUAD_TO|e.ARC,e}(C),k=((w={})[O.MOVE_TO]=2,w[O.LINE_TO]=2,w[O.HORIZ_LINE_TO]=1,w[O.VERT_LINE_TO]=1,w[O.CLOSE_PATH]=0,w[O.QUAD_TO]=4,w[O.SMOOTH_QUAD_TO]=2,w[O.CURVE_TO]=6,w[O.SMOOTH_CURVE_TO]=4,w[O.ARC]=7,w);function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}r(9714);var E=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],R=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function L(t,e,r,i,n,a){if(!(isNaN(a)||a<1)){a|=0;var s=function(t,e,r,i,n){if("string"==typeof t&&(t=document.getElementById(t)),!t||"object"!==M(t)||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var a=t.getContext("2d");try{return a.getImageData(e,r,i,n)}catch(t){throw new Error("unable to access image data: "+t)}}(t,e,r,i,n);s=function(t,e,r,i,n,a){for(var s,o=t.data,h=2*a+1,l=i-1,c=n-1,u=a+1,d=u*(u+1)/2,g=new N,f=g,p=1;p<h;p++)f=f.next=new N,p===u&&(s=f);f.next=g;for(var v=null,m=null,y=0,x=0,b=E[a],_=R[a],S=0;S<n;S++){f=g;for(var w=o[x],C=o[x+1],P=o[x+2],A=o[x+3],T=0;T<u;T++)f.r=w,f.g=C,f.b=P,f.a=A,f=f.next;for(var O=0,k=0,M=0,L=0,I=u*w,D=u*C,G=u*P,F=u*A,V=d*w,B=d*C,z=d*P,j=d*A,H=1;H<u;H++){var W=x+((l<H?l:H)<<2),U=o[W],Y=o[W+1],X=o[W+2],q=o[W+3],Q=u-H;V+=(f.r=U)*Q,B+=(f.g=Y)*Q,z+=(f.b=X)*Q,j+=(f.a=q)*Q,O+=U,k+=Y,M+=X,L+=q,f=f.next}v=g,m=s;for(var $=0;$<i;$++){var Z=j*b>>_;if(o[x+3]=Z,0!==Z){var K=255/Z;o[x]=(V*b>>_)*K,o[x+1]=(B*b>>_)*K,o[x+2]=(z*b>>_)*K}else o[x]=o[x+1]=o[x+2]=0;V-=I,B-=D,z-=G,j-=F,I-=v.r,D-=v.g,G-=v.b,F-=v.a;var J=$+a+1;J=y+(J<l?J:l)<<2,V+=O+=v.r=o[J],B+=k+=v.g=o[J+1],z+=M+=v.b=o[J+2],j+=L+=v.a=o[J+3],v=v.next;var tt=m,et=tt.r,rt=tt.g,it=tt.b,nt=tt.a;I+=et,D+=rt,G+=it,F+=nt,O-=et,k-=rt,M-=it,L-=nt,m=m.next,x+=4}y+=i}for(var at=0;at<i;at++){var st=o[x=at<<2],ot=o[x+1],ht=o[x+2],lt=o[x+3],ct=u*st,ut=u*ot,dt=u*ht,gt=u*lt,ft=d*st,pt=d*ot,vt=d*ht,mt=d*lt;f=g;for(var yt=0;yt<u;yt++)f.r=st,f.g=ot,f.b=ht,f.a=lt,f=f.next;for(var xt=i,bt=0,_t=0,St=0,wt=0,Ct=1;Ct<=a;Ct++){x=xt+at<<2;var Pt=u-Ct;ft+=(f.r=st=o[x])*Pt,pt+=(f.g=ot=o[x+1])*Pt,vt+=(f.b=ht=o[x+2])*Pt,mt+=(f.a=lt=o[x+3])*Pt,wt+=st,bt+=ot,_t+=ht,St+=lt,f=f.next,Ct<c&&(xt+=i)}x=at,v=g,m=s;for(var At=0;At<n;At++){var Tt=x<<2;o[Tt+3]=lt=mt*b>>_,lt>0?(lt=255/lt,o[Tt]=(ft*b>>_)*lt,o[Tt+1]=(pt*b>>_)*lt,o[Tt+2]=(vt*b>>_)*lt):o[Tt]=o[Tt+1]=o[Tt+2]=0,ft-=ct,pt-=ut,vt-=dt,mt-=gt,ct-=v.r,ut-=v.g,dt-=v.b,gt-=v.a,Tt=at+((Tt=At+u)<c?Tt:c)*i<<2,ft+=wt+=v.r=o[Tt],pt+=bt+=v.g=o[Tt+1],vt+=_t+=v.b=o[Tt+2],mt+=St+=v.a=o[Tt+3],v=v.next,ct+=st=m.r,ut+=ot=m.g,dt+=ht=m.b,gt+=lt=m.a,wt-=st,bt-=ot,_t-=ht,St-=lt,m=m.next,x+=i}}return t}(s,0,0,i,n,a),t.getContext("2d").putImageData(s,e,r)}}var N=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function I(t){return t.replace(/(?!\u3000)\s+/gm," ")}function D(t){return((t||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[]).map(parseFloat)}var G=/^[A-Z-]+$/;function F(t){var e=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(t)||[];return e[2]||e[3]||e[4]}var V=/(\[[^\]]+\])/g,B=/(#[^\s+>~.[:]+)/g,z=/(\.[^\s+>~.[:]+)/g,j=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,H=/(:[\w-]+\([^)]*\))/gi,W=/(:[^\s+>~.[:]+)/g,U=/([^\s+>~.[:]+)/g;function Y(t,e){var r=e.exec(t);return r?[t.replace(e," "),r.length]:[t,0]}var X=1e-8;function q(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function Q(t,e){return(t[0]*e[0]+t[1]*e[1])/(q(t)*q(e))}function $(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Q(t,e))}function Z(t){return t*t*t}function K(t){return 3*t*t*(1-t)}function J(t){return 3*t*(1-t)*(1-t)}function tt(t){return(1-t)*(1-t)*(1-t)}function et(t){return t*t}function rt(t){return 2*t*(1-t)}function it(t){return(1-t)*(1-t)}class nt{constructor(t,e,r){this.document=t,this.name=e,this.value=r,this.isNormalizedColor=!1}static empty(t){return new nt(t,"EMPTY","")}split(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",{document:e,name:r}=this;return I(this.getString()).trim().split(t).map((t=>new nt(e,r,t)))}hasValue(t){var{value:e}=this;return null!==e&&""!==e&&(t||0!==e)&&void 0!==e}isString(t){var{value:e}=this,r="string"==typeof e;return r&&t?t.test(e):r}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return void 0===t||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return void 0===t?0:parseFloat(t);var{value:e}=this,r=parseFloat(e);return this.isString(/%$/)&&(r/=100),r}getString(t){return void 0===t||this.hasValue()?void 0===this.value?"":String(this.value):String(t)}getColor(t){var e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=function(t){if(!t.startsWith("rgb"))return t;var e=3;return t.replace(/\d+(\.\d+)?/g,((t,r)=>e--&&r?String(Math.round(parseFloat(t))):t))}(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasValue())return 0;var[r,i]="boolean"==typeof t?[void 0,t]:[t],{viewPort:n}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(n.computeSize("x"),n.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(n.computeSize("x"),n.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*n.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*n.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return 15*this.getNumber();case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case this.isString(/%$/)&&i:return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*n.computeSize(r);default:var a=this.getNumber();return e&&a<1?a*n.computeSize(r):a}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():1e3*this.getNumber():0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),e=/#([^)'"]+)/.exec(t);return e&&(e=e[1]),e||(e=t),this.document.definitions[e]}getFillStyleDefinition(t,e){var r=this.getDefinition();if(!r)return null;if("function"==typeof r.createGradient)return r.createGradient(this.document.ctx,t,e);if("function"==typeof r.createPattern){if(r.getHrefAttribute().hasValue()){var i=r.getAttribute("patternTransform");r=r.getHrefAttribute().getDefinition(),i.hasValue()&&r.getAttribute("patternTransform",!0).setValue(i.value)}return r.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){return this.hasValue()?nt.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var e=this.getColor(),r=e.length,i=0,n=0;n<r&&(","===e[n]&&i++,3!==i);n++);if(t.hasValue()&&this.isString()&&3!==i){var a=new l(e);a.ok&&(a.alpha=t.getNumber(),e=a.toRGBA())}return new nt(this.document,this.name,e)}}nt.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class at{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return"number"==typeof t?t:"x"===t?this.width:"y"===t?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class st{constructor(t,e){this.x=t,this.y=e}static parse(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,[r=e,i=e]=D(t);return new st(r,i)}static parseScale(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,[r=e,i=r]=D(t);return new st(r,i)}static parsePath(t){for(var e=D(t),r=e.length,i=[],n=0;n<r;n+=2)i.push(new st(e[n],e[n+1]));return i}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:e,y:r}=this,i=e*t[0]+r*t[2]+t[4],n=e*t[1]+r*t[3]+t[5];this.x=i,this.y=n}}class ot{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:e,onMouseMove:r}=this,i=t.ctx.canvas;i.onclick=e,i.onmousemove=r,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:e,eventElements:r}=this,{style:i}=t.ctx.canvas;i&&(i.cursor=""),e.forEach(((t,e)=>{for(var{run:i}=t,n=r[e];n;)i(n),n=n.parent})),this.events=[],this.eventElements=[]}}checkPath(t,e){if(this.working&&e){var{events:r,eventElements:i}=this;r.forEach(((r,n)=>{var{x:a,y:s}=r;!i[n]&&e.isPointInPath&&e.isPointInPath(a,s)&&(i[n]=t)}))}}checkBoundingBox(t,e){if(this.working&&e){var{events:r,eventElements:i}=this;r.forEach(((r,n)=>{var{x:a,y:s}=r;!i[n]&&e.isPointInBox(a,s)&&(i[n]=t)}))}}mapXY(t,e){for(var{window:r,ctx:i}=this.screen,n=new st(t,e),a=i.canvas;a;)n.x-=a.offsetLeft,n.y-=a.offsetTop,a=a.offsetParent;return r.scrollX&&(n.x+=r.scrollX),r.scrollY&&(n.y+=r.scrollY),n}onClick(t){var{x:e,y:r}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:r,run(t){t.onClick&&t.onClick()}})}onMouseMove(t){var{x:e,y:r}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:r,run(t){t.onMouseMove&&t.onMouseMove()}})}}var ht="undefined"!=typeof window?window:null,lt="undefined"!=typeof fetch?fetch.bind(void 0):null;class ct{constructor(t){var{fetch:e=lt,window:r=ht}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new at,this.mouse=new ot(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=r,this.fetch=e}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every((t=>t()));return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:e,ctx:r,aspectRatio:i,width:n,desiredWidth:a,height:s,desiredHeight:o,minX:h=0,minY:l=0,refX:c,refY:u,clip:d=!1,clipX:g=0,clipY:f=0}=t,p=I(i).replace(/^defer\s/,""),[v,m]=p.split(" "),y=v||"xMidYMid",x=m||"meet",b=n/a,_=s/o,S=Math.min(b,_),w=Math.max(b,_),C=a,P=o;"meet"===x&&(C*=S,P*=S),"slice"===x&&(C*=w,P*=w);var A=new nt(e,"refX",c),T=new nt(e,"refY",u),O=A.hasValue()&&T.hasValue();if(O&&r.translate(-S*A.getPixels("x"),-S*T.getPixels("y")),d){var k=S*g,M=S*f;r.beginPath(),r.moveTo(k,M),r.lineTo(n,M),r.lineTo(n,s),r.lineTo(k,s),r.closePath(),r.clip()}if(!O){var E="meet"===x&&S===_,R="slice"===x&&w===_,L="meet"===x&&S===b,N="slice"===x&&w===b;y.startsWith("xMid")&&(E||R)&&r.translate(n/2-C/2,0),y.endsWith("YMid")&&(L||N)&&r.translate(0,s/2-P/2),y.startsWith("xMax")&&(E||R)&&r.translate(n-C,0),y.endsWith("YMax")&&(L||N)&&r.translate(0,s-P)}switch(!0){case"none"===y:r.scale(b,_);break;case"meet"===x:r.scale(S,S);break;case"slice"===x:r.scale(w,w)}r.translate(-h,-l)}start(t){var{enableRedraw:e=!1,ignoreMouse:r=!1,ignoreAnimation:i=!1,ignoreDimensions:n=!1,ignoreClear:a=!1,forceRedraw:s,scaleWidth:o,scaleHeight:l,offsetX:c,offsetY:u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{FRAMERATE:d,mouse:g}=this,f=1e3/d;if(this.frameDuration=f,this.readyPromise=new Promise((t=>{this.resolveReady=t})),this.isReady()&&this.render(t,n,a,o,l,c,u),e){var p=Date.now(),v=p,m=0,y=()=>{p=Date.now(),(m=p-v)>=f&&(v=p-m%f,this.shouldUpdate(i,s)&&(this.render(t,n,a,o,l,c,u),g.runEvents())),this.intervalId=h(y)};r||g.start(),this.intervalId=h(y)}}stop(){this.intervalId&&(h.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){var{frameDuration:r}=this;if(this.animations.reduce(((t,e)=>e.update(r)||t),!1))return!0}return!("function"!=typeof e||!e())||!(this.isReadyLock||!this.isReady())||!!this.mouse.hasEvents()}render(t,e,r,i,n,a,s){var{CLIENT_WIDTH:o,CLIENT_HEIGHT:h,viewPort:l,ctx:c,isFirstRender:u}=this,d=c.canvas;l.clear(),d.width&&d.height?l.setCurrent(d.width,d.height):l.setCurrent(o,h);var g=t.getStyle("width"),f=t.getStyle("height");!e&&(u||"number"!=typeof i&&"number"!=typeof n)&&(g.hasValue()&&(d.width=g.getPixels("x"),d.style&&(d.style.width="".concat(d.width,"px"))),f.hasValue()&&(d.height=f.getPixels("y"),d.style&&(d.style.height="".concat(d.height,"px"))));var p=d.clientWidth||d.width,v=d.clientHeight||d.height;if(e&&g.hasValue()&&f.hasValue()&&(p=g.getPixels("x"),v=f.getPixels("y")),l.setCurrent(p,v),"number"==typeof a&&t.getAttribute("x",!0).setValue(a),"number"==typeof s&&t.getAttribute("y",!0).setValue(s),"number"==typeof i||"number"==typeof n){var m=D(t.getAttribute("viewBox").getString()),y=0,x=0;if("number"==typeof i){var b=t.getStyle("width");b.hasValue()?y=b.getPixels("x")/i:isNaN(m[2])||(y=m[2]/i)}if("number"==typeof n){var _=t.getStyle("height");_.hasValue()?x=_.getPixels("y")/n:isNaN(m[3])||(x=m[3]/n)}y||(y=x),x||(x=y),t.getAttribute("width",!0).setValue(i),t.getAttribute("height",!0).setValue(n);var S=t.getStyle("transform",!0,!0);S.setValue("".concat(S.getString()," scale(").concat(1/y,", ").concat(1/x,")"))}r||c.clearRect(0,0,p,v),t.render(c),u&&(this.isFirstRender=!1)}}ct.defaultWindow=ht,ct.defaultFetch=lt;var{defaultFetch:ut}=ct,dt="undefined"!=typeof DOMParser?DOMParser:null;class gt{constructor(){var{fetch:t=ut,DOMParser:e=dt}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.fetch=t,this.DOMParser=e}parse(t){var e=this;return s((function*(){return t.startsWith("<")?e.parseFromString(t):e.load(t)}))()}parseFromString(t){var e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch(r){return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t}load(t){var e=this;return s((function*(){var r=yield e.fetch(t),i=yield r.text();return e.parseFromString(i)}))()}}class ft{constructor(t,e,r){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=D(e),this.originX=r[0],this.originY=r[1]}apply(t){var{originX:e,originY:r,matrix:i}=this,n=e.getPixels("x"),a=r.getPixels("y");t.translate(n,a),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.translate(-n,-a)}unapply(t){var{originX:e,originY:r,matrix:i}=this,n=i[0],a=i[2],s=i[4],o=i[1],h=i[3],l=i[5],c=1/(n*(1*h-0*l)-a*(1*o-0*l)+s*(0*o-0*h)),u=e.getPixels("x"),d=r.getPixels("y");t.translate(u,d),t.transform(c*(1*h-0*l),c*(0*l-1*o),c*(0*s-1*a),c*(1*n-0*s),c*(a*l-s*h),c*(s*o-n*l)),t.translate(-u,-d)}applyToPoint(t){t.applyTransform(this.matrix)}}class pt extends ft{constructor(t,e,r){super(t,e,r),this.type="skew",this.angle=null,this.angle=new nt(t,"angle",e)}}class vt{constructor(t,e,r){this.document=t,this.transforms=[];var i=function(t){return I(t).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}(e);i.forEach((t=>{if("none"!==t){var[e,i]=function(t){var[e,r]=t.split("(");return[e.trim(),r.trim().replace(")","")]}(t),n=vt.transformTypes[e];void 0!==n&&this.transforms.push(new n(this.document,i,r))}}))}static fromElement(t,e){var r=e.getStyle("transform",!1,!0),[i,n=i]=e.getStyle("transform-origin",!1,!0).split(),a=[i,n];return r.hasValue()?new vt(t,r.getString(),a):null}apply(t){for(var{transforms:e}=this,r=e.length,i=0;i<r;i++)e[i].apply(t)}unapply(t){for(var{transforms:e}=this,r=e.length-1;r>=0;r--)e[r].unapply(t)}applyToPoint(t){for(var{transforms:e}=this,r=e.length,i=0;i<r;i++)e[i].applyToPoint(t)}}vt.transformTypes={translate:class{constructor(t,e){this.type="translate",this.point=null,this.point=st.parse(e)}apply(t){var{x:e,y:r}=this.point;t.translate(e||0,r||0)}unapply(t){var{x:e,y:r}=this.point;t.translate(-1*e||0,-1*r||0)}applyToPoint(t){var{x:e,y:r}=this.point;t.applyTransform([1,0,0,1,e||0,r||0])}},rotate:class{constructor(t,e,r){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=D(e);this.angle=new nt(t,"angle",i[0]),this.originX=r[0],this.originY=r[1],this.cx=i[1]||0,this.cy=i[2]||0}apply(t){var{cx:e,cy:r,originX:i,originY:n,angle:a}=this,s=e+i.getPixels("x"),o=r+n.getPixels("y");t.translate(s,o),t.rotate(a.getRadians()),t.translate(-s,-o)}unapply(t){var{cx:e,cy:r,originX:i,originY:n,angle:a}=this,s=e+i.getPixels("x"),o=r+n.getPixels("y");t.translate(s,o),t.rotate(-1*a.getRadians()),t.translate(-s,-o)}applyToPoint(t){var{cx:e,cy:r,angle:i}=this,n=i.getRadians();t.applyTransform([1,0,0,1,e||0,r||0]),t.applyTransform([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),0,0]),t.applyTransform([1,0,0,1,-e||0,-r||0])}},scale:class{constructor(t,e,r){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var i=st.parseScale(e);0!==i.x&&0!==i.y||(i.x=X,i.y=X),this.scale=i,this.originX=r[0],this.originY=r[1]}apply(t){var{scale:{x:e,y:r},originX:i,originY:n}=this,a=i.getPixels("x"),s=n.getPixels("y");t.translate(a,s),t.scale(e,r||e),t.translate(-a,-s)}unapply(t){var{scale:{x:e,y:r},originX:i,originY:n}=this,a=i.getPixels("x"),s=n.getPixels("y");t.translate(a,s),t.scale(1/e,1/r||e),t.translate(-a,-s)}applyToPoint(t){var{x:e,y:r}=this.scale;t.applyTransform([e||0,0,0,r||0,0,0])}},matrix:ft,skewX:class extends pt{constructor(t,e,r){super(t,e,r),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}},skewY:class extends pt{constructor(t,e,r){super(t,e,r),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}};class mt{constructor(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.document=t,this.node=e,this.captureTextNodes=r,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],e&&1===e.nodeType){if(Array.from(e.attributes).forEach((e=>{var r,i=(r=e.nodeName,G.test(r)?r.toLowerCase():r);this.attributes[i]=new nt(t,i,e.value)})),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var i=this.getAttribute("style").getString().split(";").map((t=>t.trim()));i.forEach((e=>{if(e){var[r,i]=e.split(":").map((t=>t.trim()));this.styles[r]=new nt(t,r,i)}}))}var{definitions:n}=t,a=this.getAttribute("id");a.hasValue()&&(n[a.getString()]||(n[a.getString()]=this)),Array.from(e.childNodes).forEach((e=>{if(1===e.nodeType)this.addChild(e);else if(r&&(3===e.nodeType||4===e.nodeType)){var i=t.createTextNode(e);i.getText().length>0&&this.addChild(i)}}))}}getAttribute(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attributes[t];if(!r&&e){var i=new nt(this.document,t,"");return this.attributes[t]=i,i}return r||nt.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if("href"===t||t.endsWith(":href"))return this.attributes[t];return nt.empty(this.document)}getStyle(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.styles[t];if(i)return i;var n=this.getAttribute(t);if(null!=n&&n.hasValue())return this.styles[t]=n,n;if(!r){var{parent:a}=this;if(a){var s=a.getStyle(t);if(null!=s&&s.hasValue())return s}}if(e){var o=new nt(this.document,t,"");return this.styles[t]=o,o}return i||nt.empty(this.document)}render(t){if("none"!==this.getStyle("display").getString()&&"hidden"!==this.getStyle("visibility").getString()){if(t.save(),this.getStyle("mask").hasValue()){var e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if("none"!==this.getStyle("filter").getValue("none")){var r=this.getStyle("filter").getDefinition();r&&(this.applyEffects(t),r.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var e=vt.fromElement(this.document,this);e&&e.apply(t);var r=this.getStyle("clip-path",!1,!0);if(r.hasValue()){var i=r.getDefinition();i&&i.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach((e=>{e.render(t)}))}addChild(t){var e=t instanceof mt?t:this.document.createElement(t);e.parent=this,mt.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var{node:e}=this;if("function"==typeof e.matches)return e.matches(t);var r=e.getAttribute("class");return!(!r||""===r)&&r.split(" ").some((e=>".".concat(e)===t))}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:e}=this.document;for(var r in t)if(!r.startsWith("@")&&this.matchesSelector(r)){var i=t[r],n=e[r];if(i)for(var a in i){var s=this.stylesSpecificity[a];void 0===s&&(s="000"),n>=s&&(this.styles[a]=i[a],this.stylesSpecificity[a]=n)}}}removeStyles(t,e){return e.reduce(((e,r)=>{var i=t.getStyle(r);if(!i.hasValue())return e;var n=i.getString();return i.setValue(""),[...e,[r,n]]}),[])}restoreStyles(t,e){e.forEach((e=>{var[r,i]=e;t.getStyle(r,!0).setValue(i)}))}}mt.ignoreChildTypes=["title"];class yt extends mt{constructor(t,e,r){super(t,e,r)}}function xt(t){var e=t.trim();return/^('|")/.test(e)?e:'"'.concat(e,'"')}function bt(t){if(!t)return"";var e=t.trim().toLowerCase();switch(e){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return e;default:return/^oblique\s+(-|)\d+deg$/.test(e)?e:""}}function _t(t){if(!t)return"";var e=t.trim().toLowerCase();switch(e){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return e;default:return/^[\d.]+$/.test(e)?e:""}}class St{constructor(t,e,r,i,n,a){var s=a?"string"==typeof a?St.parse(a):a:{};this.fontFamily=n||s.fontFamily,this.fontSize=i||s.fontSize,this.fontStyle=t||s.fontStyle,this.fontWeight=r||s.fontWeight,this.fontVariant=e||s.fontVariant}static parse(){var t=arguments.length>1?arguments[1]:void 0,e="",r="",i="",n="",a="",s=I(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().split(" "),o={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return s.forEach((t=>{switch(!0){case!o.fontStyle&&St.styles.includes(t):"inherit"!==t&&(e=t),o.fontStyle=!0;break;case!o.fontVariant&&St.variants.includes(t):"inherit"!==t&&(r=t),o.fontStyle=!0,o.fontVariant=!0;break;case!o.fontWeight&&St.weights.includes(t):"inherit"!==t&&(i=t),o.fontStyle=!0,o.fontVariant=!0,o.fontWeight=!0;break;case!o.fontSize:"inherit"!==t&&([n]=t.split("/")),o.fontStyle=!0,o.fontVariant=!0,o.fontWeight=!0,o.fontSize=!0;break;default:"inherit"!==t&&(a+=t)}})),new St(e,r,i,n,a,t)}toString(){return[bt(this.fontStyle),this.fontVariant,_t(this.fontWeight),this.fontSize,(t=this.fontFamily,"undefined"==typeof process?t:t.trim().split(",").map(xt).join(","))].join(" ").trim();var t}}St.styles="normal|italic|oblique|inherit",St.variants="normal|small-caps|inherit",St.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class wt{constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.NaN,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.NaN,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.NaN,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.NaN;this.x1=t,this.y1=e,this.x2=r,this.y2=i,this.addPoint(t,e),this.addPoint(r,i)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){void 0!==t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),void 0!==e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:e,y1:r,x2:i,y2:n}=t;this.addPoint(e,r),this.addPoint(i,n)}}sumCubic(t,e,r,i,n){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*r+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*n}bezierCurveAdd(t,e,r,i,n){var a=6*e-12*r+6*i,s=-3*e+9*r-9*i+3*n,o=3*r-3*e;if(0!==s){var h=Math.pow(a,2)-4*o*s;if(!(h<0)){var l=(-a+Math.sqrt(h))/(2*s);0<l&&l<1&&(t?this.addX(this.sumCubic(l,e,r,i,n)):this.addY(this.sumCubic(l,e,r,i,n)));var c=(-a-Math.sqrt(h))/(2*s);0<c&&c<1&&(t?this.addX(this.sumCubic(c,e,r,i,n)):this.addY(this.sumCubic(c,e,r,i,n)))}}else{if(0===a)return;var u=-o/a;0<u&&u<1&&(t?this.addX(this.sumCubic(u,e,r,i,n)):this.addY(this.sumCubic(u,e,r,i,n)))}}addBezierCurve(t,e,r,i,n,a,s,o){this.addPoint(t,e),this.addPoint(s,o),this.bezierCurveAdd(!0,t,r,n,s),this.bezierCurveAdd(!1,e,i,a,o)}addQuadraticCurve(t,e,r,i,n,a){var s=t+2/3*(r-t),o=e+2/3*(i-e),h=s+1/3*(n-t),l=o+1/3*(a-e);this.addBezierCurve(t,e,s,h,o,l,n,a)}isPointInBox(t,e){var{x1:r,y1:i,x2:n,y2:a}=this;return r<=t&&t<=n&&i<=e&&e<=a}}class Ct extends O{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new st(0,0),this.control=new st(0,0),this.current=new st(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:e}=this;return t>=e.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y",r=new st(this.command[t],this.command[e]);return this.makeAbsolute(r)}getAsControlPoint(t,e){var r=this.getPoint(t,e);return this.control=r,r}getAsCurrentPoint(t,e){var r=this.getPoint(t,e);return this.current=r,r}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==O.CURVE_TO&&t!==O.SMOOTH_CURVE_TO&&t!==O.QUAD_TO&&t!==O.SMOOTH_QUAD_TO)return this.current;var{current:{x:e,y:r},control:{x:i,y:n}}=this;return new st(2*e-i,2*r-n)}makeAbsolute(t){if(this.command.relative){var{x:e,y:r}=this.current;t.x+=e,t.y+=r}return t}addMarker(t,e,r){var{points:i,angles:n}=this;r&&n.length>0&&!n[n.length-1]&&(n[n.length-1]=i[i.length-1].angleTo(r)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,e=t.length,r=0;r<e;r++)if(!t[r])for(var i=r+1;i<e;i++)if(t[i]){t[r]=t[i];break}return t}}class Pt extends mt{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,e=this;e;){var r=e.getStyle("opacity",!1,!0);r.hasValue(!0)&&(t*=r.getNumber()),e=e.parent}return t}setContext(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e){var r=this.getStyle("fill"),i=this.getStyle("fill-opacity"),n=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(r.isUrlDefinition()){var s=r.getFillStyleDefinition(this,i);s&&(t.fillStyle=s)}else if(r.hasValue()){"currentColor"===r.getString()&&r.setValue(this.getStyle("color").getColor());var o=r.getColor();"inherit"!==o&&(t.fillStyle="none"===o?"rgba(0,0,0,0)":o)}if(i.hasValue()){var h=new nt(this.document,"fill",t.fillStyle).addOpacity(i).getColor();t.fillStyle=h}if(n.isUrlDefinition()){var l=n.getFillStyleDefinition(this,a);l&&(t.strokeStyle=l)}else if(n.hasValue()){"currentColor"===n.getString()&&n.setValue(this.getStyle("color").getColor());var c=n.getString();"inherit"!==c&&(t.strokeStyle="none"===c?"rgba(0,0,0,0)":c)}if(a.hasValue()){var u=new nt(this.document,"stroke",t.strokeStyle).addOpacity(a).getString();t.strokeStyle=u}var d=this.getStyle("stroke-width");if(d.hasValue()){var g=d.getPixels();t.lineWidth=g||X}var f=this.getStyle("stroke-linecap"),p=this.getStyle("stroke-linejoin"),v=this.getStyle("stroke-miterlimit"),m=this.getStyle("stroke-dasharray"),y=this.getStyle("stroke-dashoffset");if(f.hasValue()&&(t.lineCap=f.getString()),p.hasValue()&&(t.lineJoin=p.getString()),v.hasValue()&&(t.miterLimit=v.getNumber()),m.hasValue()&&"none"!==m.getString()){var x=D(m.getString());void 0!==t.setLineDash?t.setLineDash(x):void 0!==t.webkitLineDash?t.webkitLineDash=x:void 0===t.mozDash||1===x.length&&0===x[0]||(t.mozDash=x);var b=y.getPixels();void 0!==t.lineDashOffset?t.lineDashOffset=b:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=b:void 0!==t.mozDashOffset&&(t.mozDashOffset=b)}}if(this.modifiedEmSizeStack=!1,void 0!==t.font){var _=this.getStyle("font"),S=this.getStyle("font-style"),w=this.getStyle("font-variant"),C=this.getStyle("font-weight"),P=this.getStyle("font-size"),A=this.getStyle("font-family"),T=new St(S.getString(),w.getString(),C.getString(),P.hasValue()?"".concat(P.getPixels(!0),"px"):"",A.getString(),St.parse(_.getString(),t.font));S.setValue(T.fontStyle),w.setValue(T.fontVariant),C.setValue(T.fontWeight),P.setValue(T.fontSize),A.setValue(T.fontFamily),t.font=T.toString(),P.isPixels()&&(this.document.emSize=P.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}}class At extends Pt{constructor(t,e,r){super(t,e,r),this.type="path",this.pathParser=null,this.pathParser=new Ct(this.getAttribute("d").getString())}path(t){var{pathParser:e}=this,r=new wt;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case Ct.MOVE_TO:this.pathM(t,r);break;case Ct.LINE_TO:this.pathL(t,r);break;case Ct.HORIZ_LINE_TO:this.pathH(t,r);break;case Ct.VERT_LINE_TO:this.pathV(t,r);break;case Ct.CURVE_TO:this.pathC(t,r);break;case Ct.SMOOTH_CURVE_TO:this.pathS(t,r);break;case Ct.QUAD_TO:this.pathQ(t,r);break;case Ct.SMOOTH_QUAD_TO:this.pathT(t,r);break;case Ct.ARC:this.pathA(t,r);break;case Ct.CLOSE_PATH:this.pathZ(t,r)}return r}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,e=t.getMarkerPoints(),r=t.getMarkerAngles(),i=e.map(((t,e)=>[t,r[e]]));return i}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var e=this.getStyle("fill-rule");""!==t.fillStyle&&("inherit"!==e.getString("inherit")?t.fill(e.getString()):t.fill()),""!==t.strokeStyle&&("non-scaling-stroke"===this.getAttribute("vector-effect").getString()?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var r=this.getMarkers();if(r){var i=r.length-1,n=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),s=this.getStyle("marker-end");if(n.isUrlDefinition()){var o=n.getDefinition(),[h,l]=r[0];o.render(t,h,l)}if(a.isUrlDefinition())for(var c=a.getDefinition(),u=1;u<i;u++){var[d,g]=r[u];c.render(t,d,g)}if(s.isUrlDefinition()){var f=s.getDefinition(),[p,v]=r[i];f.render(t,p,v)}}}static pathM(t){var e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){var{pathParser:r}=this,{point:i}=At.pathM(r),{x:n,y:a}=i;r.addMarker(i),e.addPoint(n,a),t&&t.moveTo(n,a)}static pathL(t){var{current:e}=t;return{current:e,point:t.getAsCurrentPoint()}}pathL(t,e){var{pathParser:r}=this,{current:i,point:n}=At.pathL(r),{x:a,y:s}=n;r.addMarker(n,i),e.addPoint(a,s),t&&t.lineTo(a,s)}static pathH(t){var{current:e,command:r}=t,i=new st((r.relative?e.x:0)+r.x,e.y);return t.current=i,{current:e,point:i}}pathH(t,e){var{pathParser:r}=this,{current:i,point:n}=At.pathH(r),{x:a,y:s}=n;r.addMarker(n,i),e.addPoint(a,s),t&&t.lineTo(a,s)}static pathV(t){var{current:e,command:r}=t,i=new st(e.x,(r.relative?e.y:0)+r.y);return t.current=i,{current:e,point:i}}pathV(t,e){var{pathParser:r}=this,{current:i,point:n}=At.pathV(r),{x:a,y:s}=n;r.addMarker(n,i),e.addPoint(a,s),t&&t.lineTo(a,s)}static pathC(t){var{current:e}=t;return{current:e,point:t.getPoint("x1","y1"),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}pathC(t,e){var{pathParser:r}=this,{current:i,point:n,controlPoint:a,currentPoint:s}=At.pathC(r);r.addMarker(s,a,n),e.addBezierCurve(i.x,i.y,n.x,n.y,a.x,a.y,s.x,s.y),t&&t.bezierCurveTo(n.x,n.y,a.x,a.y,s.x,s.y)}static pathS(t){var{current:e}=t;return{current:e,point:t.getReflectedControlPoint(),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}pathS(t,e){var{pathParser:r}=this,{current:i,point:n,controlPoint:a,currentPoint:s}=At.pathS(r);r.addMarker(s,a,n),e.addBezierCurve(i.x,i.y,n.x,n.y,a.x,a.y,s.x,s.y),t&&t.bezierCurveTo(n.x,n.y,a.x,a.y,s.x,s.y)}static pathQ(t){var{current:e}=t;return{current:e,controlPoint:t.getAsControlPoint("x1","y1"),currentPoint:t.getAsCurrentPoint()}}pathQ(t,e){var{pathParser:r}=this,{current:i,controlPoint:n,currentPoint:a}=At.pathQ(r);r.addMarker(a,n,n),e.addQuadraticCurve(i.x,i.y,n.x,n.y,a.x,a.y),t&&t.quadraticCurveTo(n.x,n.y,a.x,a.y)}static pathT(t){var{current:e}=t,r=t.getReflectedControlPoint();return t.control=r,{current:e,controlPoint:r,currentPoint:t.getAsCurrentPoint()}}pathT(t,e){var{pathParser:r}=this,{current:i,controlPoint:n,currentPoint:a}=At.pathT(r);r.addMarker(a,n,n),e.addQuadraticCurve(i.x,i.y,n.x,n.y,a.x,a.y),t&&t.quadraticCurveTo(n.x,n.y,a.x,a.y)}static pathA(t){var{current:e,command:r}=t,{rX:i,rY:n,xRot:a,lArcFlag:s,sweepFlag:o}=r,h=a*(Math.PI/180),l=t.getAsCurrentPoint(),c=new st(Math.cos(h)*(e.x-l.x)/2+Math.sin(h)*(e.y-l.y)/2,-Math.sin(h)*(e.x-l.x)/2+Math.cos(h)*(e.y-l.y)/2),u=Math.pow(c.x,2)/Math.pow(i,2)+Math.pow(c.y,2)/Math.pow(n,2);u>1&&(i*=Math.sqrt(u),n*=Math.sqrt(u));var d=(s===o?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(n,2)-Math.pow(i,2)*Math.pow(c.y,2)-Math.pow(n,2)*Math.pow(c.x,2))/(Math.pow(i,2)*Math.pow(c.y,2)+Math.pow(n,2)*Math.pow(c.x,2)));isNaN(d)&&(d=0);var g=new st(d*i*c.y/n,d*-n*c.x/i),f=new st((e.x+l.x)/2+Math.cos(h)*g.x-Math.sin(h)*g.y,(e.y+l.y)/2+Math.sin(h)*g.x+Math.cos(h)*g.y),p=$([1,0],[(c.x-g.x)/i,(c.y-g.y)/n]),v=[(c.x-g.x)/i,(c.y-g.y)/n],m=[(-c.x-g.x)/i,(-c.y-g.y)/n],y=$(v,m);return Q(v,m)<=-1&&(y=Math.PI),Q(v,m)>=1&&(y=0),{currentPoint:l,rX:i,rY:n,sweepFlag:o,xAxisRotation:h,centp:f,a1:p,ad:y}}pathA(t,e){var{pathParser:r}=this,{currentPoint:i,rX:n,rY:a,sweepFlag:s,xAxisRotation:o,centp:h,a1:l,ad:c}=At.pathA(r),u=1-s?1:-1,d=l+u*(c/2),g=new st(h.x+n*Math.cos(d),h.y+a*Math.sin(d));if(r.addMarkerAngle(g,d-u*Math.PI/2),r.addMarkerAngle(i,d-u*Math.PI),e.addPoint(i.x,i.y),t&&!isNaN(l)&&!isNaN(c)){var f=n>a?n:a,p=n>a?1:n/a,v=n>a?a/n:1;t.translate(h.x,h.y),t.rotate(o),t.scale(p,v),t.arc(0,0,f,l,l+c,Boolean(1-s)),t.scale(1/p,1/v),t.rotate(-o),t.translate(-h.x,-h.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){At.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}}class Tt extends At{constructor(t,e,r){super(t,e,r),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class Ot extends Pt{constructor(t,e,r){super(t,e,new.target===Ot||r),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.setContext(t,e);var r=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();r&&(t.textBaseline=r)}initializeCoordinates(t){this.x=this.getAttribute("x").getPixels("x"),this.y=this.getAttribute("y").getPixels("y");var e=this.getAttribute("dx"),r=this.getAttribute("dy");e.hasValue()&&(this.x+=e.getPixels("x")),r.hasValue()&&(this.y+=r.getPixels("y")),this.x+=this.getAnchorDelta(t,this,0)}getBoundingBox(t){if("text"!==this.type)return this.getTElementBoundingBox(t);this.initializeCoordinates(t);var e=null;return this.children.forEach(((r,i)=>{var n=this.getChildBoundingBox(t,this,this,i);e?e.addBoundingBox(n):e=n})),e}getFontSize(){var{document:t,parent:e}=this,r=St.parse(t.ctx.font).fontSize;return e.getStyle("font-size").getNumber(r)}getTElementBoundingBox(t){var e=this.getFontSize();return new wt(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,r){var i=e[r],n=null;if(t.isArabic){var a=e.length,s=e[r-1],o=e[r+1],h="isolated";if((0===r||" "===s)&&r<a-2&&" "!==o&&(h="terminal"),r>0&&" "!==s&&r<a-2&&" "!==o&&(h="medial"),r>0&&" "!==s&&(r===a-1||" "===o)&&(h="initial"),void 0!==t.glyphs[i]){var l=t.glyphs[i];n=l instanceof Tt?l:l[h]}}else n=t.glyphs[i];return n||(n=t.missingGlyph),n}getText(){return""}getTextFromNode(t){var e=t||this.node,r=Array.from(e.parentNode.childNodes),i=r.indexOf(e),n=r.length-1,a=I(e.textContent||"");return 0===i&&(a=a.replace(/^[\n \t]+/,"")),i===n&&(a=a.replace(/[\n \t]+$/,"")),a}renderChildren(t){if("text"===this.type){this.initializeCoordinates(t),this.children.forEach(((e,r)=>{this.renderChild(t,this,this,r)}));var{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}else this.renderTElementChildren(t)}renderTElementChildren(t){var{document:e,parent:r}=this,i=this.getText(),n=r.getStyle("font-family").getDefinition();if(n)for(var{unitsPerEm:a}=n.fontFace,s=St.parse(e.ctx.font),o=r.getStyle("font-size").getNumber(s.fontSize),h=r.getStyle("font-style").getString(s.fontStyle),l=o/a,c=n.isRTL?i.split("").reverse().join(""):i,u=D(r.getAttribute("dx").getString()),d=c.length,g=0;g<d;g++){var f=this.getGlyph(n,c,g);t.translate(this.x,this.y),t.scale(l,-l);var p=t.lineWidth;t.lineWidth=t.lineWidth*a/o,"italic"===h&&t.transform(1,0,.4,1,0,0),f.render(t),"italic"===h&&t.transform(1,0,-.4,1,0,0),t.lineWidth=p,t.scale(1/l,-1/l),t.translate(-this.x,-this.y),this.x+=o*(f.horizAdvX||n.horizAdvX)/a,void 0===u[g]||isNaN(u[g])||(this.x+=u[g])}else{var{x:v,y:m}=this;t.fillStyle&&t.fillText(i,v,m),t.strokeStyle&&t.strokeText(i,v,m)}}getAnchorDelta(t,e,r){var i=this.getStyle("text-anchor").getString("start");if("start"!==i){for(var{children:n}=e,a=n.length,s=null,o=0,h=r;h<a&&(s=n[h],!(h>r&&s.getAttribute("x").hasValue()||s.getAttribute("text-anchor").hasValue()));h++)o+=s.measureTextRecursive(t);return-1*("end"===i?o:o/2)}return 0}adjustChildCoordinates(t,e,r,i){var n=r.children[i];if("function"!=typeof n.measureText)return n;t.save(),n.setContext(t,!0);var a=n.getAttribute("x"),s=n.getAttribute("y"),o=n.getAttribute("dx"),h=n.getAttribute("dy"),l=n.getAttribute("text-anchor").getString("start");if(0===i&&"textNode"!==n.type&&(a.hasValue()||a.setValue(e.getAttribute("x").getValue("0")),s.hasValue()||s.setValue(e.getAttribute("y").getValue("0")),o.hasValue()||o.setValue(e.getAttribute("dx").getValue("0")),h.hasValue()||h.setValue(e.getAttribute("dy").getValue("0"))),a.hasValue()){if(n.x=a.getPixels("x")+e.getAnchorDelta(t,r,i),"start"!==l){var c=n.measureTextRecursive(t);n.x+=-1*("end"===l?c:c/2)}o.hasValue()&&(n.x+=o.getPixels("x"))}else{if("start"!==l){var u=n.measureTextRecursive(t);e.x+=-1*("end"===l?u:u/2)}o.hasValue()&&(e.x+=o.getPixels("x")),n.x=e.x}return e.x=n.x+n.measureText(t),s.hasValue()?(n.y=s.getPixels("y"),h.hasValue()&&(n.y+=h.getPixels("y"))):(h.hasValue()&&(e.y+=h.getPixels("y")),n.y=e.y),e.y=n.y,n.clearContext(t),t.restore(),n}getChildBoundingBox(t,e,r,i){var n=this.adjustChildCoordinates(t,e,r,i);if("function"!=typeof n.getBoundingBox)return null;var a=n.getBoundingBox(t);return a?(n.children.forEach(((r,i)=>{var s=e.getChildBoundingBox(t,e,n,i);a.addBoundingBox(s)})),a):null}renderChild(t,e,r,i){var n=this.adjustChildCoordinates(t,e,r,i);n.render(t),n.children.forEach(((r,i)=>{e.renderChild(t,e,n,i)}))}measureTextRecursive(t){return this.children.reduce(((e,r)=>e+r.measureTextRecursive(t)),this.measureText(t))}measureText(t){var{measureCache:e}=this;if(~e)return e;var r=this.getText(),i=this.measureTargetText(t,r);return this.measureCache=i,i}measureTargetText(t,e){if(!e.length)return 0;var{parent:r}=this,i=r.getStyle("font-family").getDefinition();if(i){for(var n=this.getFontSize(),a=i.isRTL?e.split("").reverse().join(""):e,s=D(r.getAttribute("dx").getString()),o=a.length,h=0,l=0;l<o;l++)h+=(this.getGlyph(i,a,l).horizAdvX||i.horizAdvX)*n/i.fontFace.unitsPerEm,void 0===s[l]||isNaN(s[l])||(h+=s[l]);return h}if(!t.measureText)return 10*e.length;t.save(),this.setContext(t,!0);var{width:c}=t.measureText(e);return this.clearContext(t),t.restore(),c}}class kt extends Ot{constructor(t,e,r){super(t,e,new.target===kt||r),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class Mt extends kt{constructor(){super(...arguments),this.type="textNode"}}class Et extends Pt{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var e,{document:r}=this,{screen:i,window:n}=r,a=t.canvas;if(i.setDefaults(t),a.style&&void 0!==t.font&&n&&void 0!==n.getComputedStyle){t.font=n.getComputedStyle(a).getPropertyValue("font");var s=new nt(r,"fontSize",St.parse(t.font).fontSize);s.hasValue()&&(r.rootEmSize=s.getPixels("y"),r.emSize=r.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:o,height:h}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var l=this.getAttribute("refX"),c=this.getAttribute("refY"),u=this.getAttribute("viewBox"),d=u.hasValue()?D(u.getString()):null,g=!this.root&&"visible"!==this.getStyle("overflow").getValue("hidden"),f=0,p=0,v=0,m=0;d&&(f=d[0],p=d[1]),this.root||(o=this.getStyle("width").getPixels("x"),h=this.getStyle("height").getPixels("y"),"marker"===this.type&&(v=f,m=p,f=0,p=0)),i.viewPort.setCurrent(o,h),!this.node||this.parent&&"foreignObject"!==(null===(e=this.node.parentNode)||void 0===e?void 0:e.nodeName)||!this.getStyle("transform",!1,!0).hasValue()||this.getStyle("transform-origin",!1,!0).hasValue()||this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),d&&(o=d[2],h=d[3]),r.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:o,height:i.viewPort.height,desiredHeight:h,minX:f,minY:p,refX:l.getValue(),refY:c.getValue(),clip:g,clipX:v,clipY:m}),d&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(o,h))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getAttribute("width",!0),n=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),s=this.getAttribute("style"),o=i.getNumber(0),h=n.getNumber(0);if(r)if("string"==typeof r)this.getAttribute("preserveAspectRatio",!0).setValue(r);else{var l=this.getAttribute("preserveAspectRatio");l.hasValue()&&l.setValue(l.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(t),n.setValue(e),a.hasValue()||a.setValue("0 0 ".concat(o||t," ").concat(h||e)),s.hasValue()){var c=this.getStyle("width"),u=this.getStyle("height");c.hasValue()&&c.setValue("".concat(t,"px")),u.hasValue()&&u.setValue("".concat(e,"px"))}}}class Rt extends At{constructor(){super(...arguments),this.type="rect"}path(t){var e=this.getAttribute("x").getPixels("x"),r=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),n=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),s=this.getAttribute("ry"),o=a.getPixels("x"),h=s.getPixels("y");if(a.hasValue()&&!s.hasValue()&&(h=o),s.hasValue()&&!a.hasValue()&&(o=h),o=Math.min(o,i/2),h=Math.min(h,n/2),t){var l=(Math.sqrt(2)-1)/3*4;t.beginPath(),n>0&&i>0&&(t.moveTo(e+o,r),t.lineTo(e+i-o,r),t.bezierCurveTo(e+i-o+l*o,r,e+i,r+h-l*h,e+i,r+h),t.lineTo(e+i,r+n-h),t.bezierCurveTo(e+i,r+n-h+l*h,e+i-o+l*o,r+n,e+i-o,r+n),t.lineTo(e+o,r+n),t.bezierCurveTo(e+o-l*o,r+n,e,r+n-h+l*h,e,r+n-h),t.lineTo(e,r+h),t.bezierCurveTo(e,r+h-l*h,e+o-l*o,r,e+o,r),t.closePath())}return new wt(e,r,e+i,r+n)}getMarkers(){return null}}class Lt extends At{constructor(t,e,r){super(t,e,r),this.type="polyline",this.points=[],this.points=st.parsePath(this.getAttribute("points").getString())}path(t){var{points:e}=this,[{x:r,y:i}]=e,n=new wt(r,i);return t&&(t.beginPath(),t.moveTo(r,i)),e.forEach((e=>{var{x:r,y:i}=e;n.addPoint(r,i),t&&t.lineTo(r,i)})),n}getMarkers(){var{points:t}=this,e=t.length-1,r=[];return t.forEach(((i,n)=>{n!==e&&r.push([i,i.angleTo(t[n+1])])})),r.length>0&&r.push([t[t.length-1],r[r.length-1][1]]),r}}class Nt extends Pt{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var e=new wt;return this.children.forEach((r=>{e.addBoundingBox(r.getBoundingBox(t))})),e}}class It extends mt{constructor(t,e,r){super(t,e,r),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:i,children:n}=this;n.forEach((t=>{"stop"===t.type&&i.push(t)}))}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,r){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var{stops:n}=i,a=this.getGradient(t,e);if(!a)return this.addParentOpacity(r,n[n.length-1].color);if(n.forEach((t=>{a.addColorStop(t.offset,this.addParentOpacity(r,t.color))})),this.getAttribute("gradientTransform").hasValue()){var{document:s}=this,{MAX_VIRTUAL_PIXELS:o,viewPort:h}=s.screen,[l]=h.viewPorts,c=new Rt(s,null);c.attributes.x=new nt(s,"x",-o/3),c.attributes.y=new nt(s,"y",-o/3),c.attributes.width=new nt(s,"width",o),c.attributes.height=new nt(s,"height",o);var u=new Nt(s,null);u.attributes.transform=new nt(s,"transform",this.getAttribute("gradientTransform").getValue()),u.children=[c];var d=new Et(s,null);d.attributes.x=new nt(s,"x",0),d.attributes.y=new nt(s,"y",0),d.attributes.width=new nt(s,"width",l.width),d.attributes.height=new nt(s,"height",l.height),d.children=[u];var g=s.createCanvas(l.width,l.height),f=g.getContext("2d");return f.fillStyle=a,d.render(f),f.createPattern(g,"no-repeat")}return a}inheritStopContainer(t){this.attributesToInherit.forEach((e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())}))}addParentOpacity(t,e){return t.hasValue()?new nt(this.document,"color",e).addOpacity(t).getColor():e}}class Dt extends mt{constructor(t,e,r){super(t,e,r),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new nt(t,"values",null);var i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return"CSS"===t?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){var{initialUnits:t}=this,{progress:e,from:r,to:i}=this.getProgress(),n=r.getNumber()+(i.getNumber()-r.getNumber())*e;return"%"===t&&(n*=100),"".concat(n).concat(t)}update(t){var{parent:e}=this,r=this.getProperty();if(this.initialValue||(this.initialValue=r.getString(),this.initialUnits=r.getUnits()),this.duration>this.maxDuration){var i=this.getAttribute("fill").getString("remove");if("indefinite"===this.getAttribute("repeatCount").getString()||"indefinite"===this.getAttribute("repeatDur").getString())this.duration=0;else if("freeze"!==i||this.frozen){if("remove"===i&&!this.removed)return this.removed=!0,r.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0}else this.frozen=!0,e.animationFrozen=!0,e.animationFrozenValue=r.getString();return!1}this.duration+=t;var n=!1;if(this.begin<this.duration){var a=this.calcValue(),s=this.getAttribute("type");if(s.hasValue()){var o=s.getString();a="".concat(o,"(").concat(a,")")}r.setValue(a),n=!0}return n}getProgress(){var{document:t,values:e}=this,r={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(e.hasValue()){var i=r.progress*(e.getValue().length-1),n=Math.floor(i),a=Math.ceil(i);r.from=new nt(t,"from",parseFloat(e.getValue()[n])),r.to=new nt(t,"to",parseFloat(e.getValue()[a])),r.progress=(i-n)/(a-n)}else r.from=this.from,r.to=this.to;return r}}function Gt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Gt(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Vt=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class Bt{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,e){var r=this;return s((function*(){try{var{document:i}=r,n=(yield i.canvg.parser.load(e)).getElementsByTagName("font");Array.from(n).forEach((e=>{var r=i.createElement(e);i.definitions[t]=r}))}catch(t){console.error('Error while loading font "'.concat(e,'":'),t)}r.loaded=!0}))()}}class zt extends mt{constructor(t,e,r){super(t,e,r),this.type="style";var i=I(Array.from(e.childNodes).map((t=>t.textContent)).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,""));i.split("}").forEach((e=>{var r=e.trim();if(r){var i=r.split("{"),n=i[0].split(","),a=i[1].split(";");n.forEach((e=>{var r=e.trim();if(r){var i,n,s,o=t.styles[r]||{};if(a.forEach((e=>{var r=e.indexOf(":"),i=e.substr(0,r).trim(),n=e.substr(r+1,e.length-r).trim();i&&n&&(o[i]=new nt(t,i,n))})),t.styles[r]=o,t.stylesSpecificity[r]=(i=[0,0,0],n=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),s=0,[n,s]=Y(n,V),i[1]+=s,[n,s]=Y(n,B),i[0]+=s,[n,s]=Y(n,z),i[1]+=s,[n,s]=Y(n,j),i[2]+=s,[n,s]=Y(n,H),i[1]+=s,[n,s]=Y(n,W),i[1]+=s,n=n.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[n,s]=Y(n,U),i[2]+=s,i.join("")),"@font-face"===r){var h=o["font-family"].getString().replace(/"|'/g,"");o.src.getString().split(",").forEach((e=>{if(e.indexOf('format("svg")')>0){var r=F(e);r&&new Bt(t).load(h,r)}}))}}}))}}))}}function jt(t,e,r,i,n,a){return t[r*i*4+4*e+a]}function Ht(t,e,r,i,n,a,s){t[r*i*4+4*e+a]=s}function Wt(t,e,r){return t[e]*r}function Ut(t,e,r,i){return e+Math.cos(t)*r+Math.sin(t)*i}zt.parseExternalUrl=F;class Yt extends mt{constructor(t,e,r){super(t,e,r),this.type="feColorMatrix";var i=D(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":var n=i[0];i=[.213+.787*n,.715-.715*n,.072-.072*n,0,0,.213-.213*n,.715+.285*n,.072-.072*n,0,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var a=i[0]*Math.PI/180;i=[Ut(a,.213,.787,-.213),Ut(a,.715,-.715,-.715),Ut(a,.072,-.072,.928),0,0,Ut(a,.213,-.213,.143),Ut(a,.715,.285,.14),Ut(a,.072,-.072,-.283),0,0,Ut(a,.213,-.213,-.787),Ut(a,.715,-.715,.715),Ut(a,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,e,r,i,n){for(var{includeOpacity:a,matrix:s}=this,o=t.getImageData(0,0,i,n),h=0;h<n;h++)for(var l=0;l<i;l++){var c=jt(o.data,l,h,i,0,0),u=jt(o.data,l,h,i,0,1),d=jt(o.data,l,h,i,0,2),g=jt(o.data,l,h,i,0,3),f=Wt(s,0,c)+Wt(s,1,u)+Wt(s,2,d)+Wt(s,3,g)+Wt(s,4,1),p=Wt(s,5,c)+Wt(s,6,u)+Wt(s,7,d)+Wt(s,8,g)+Wt(s,9,1),v=Wt(s,10,c)+Wt(s,11,u)+Wt(s,12,d)+Wt(s,13,g)+Wt(s,14,1),m=Wt(s,15,c)+Wt(s,16,u)+Wt(s,17,d)+Wt(s,18,g)+Wt(s,19,1);a&&(f=0,p=0,v=0,m*=g/255),Ht(o.data,l,h,i,0,0,f),Ht(o.data,l,h,i,0,1,p),Ht(o.data,l,h,i,0,2,v),Ht(o.data,l,h,i,0,3,m)}t.clearRect(0,0,i,n),t.putImageData(o,0,0)}}class Xt extends mt{constructor(){super(...arguments),this.type="mask"}apply(t,e){var{document:r}=this,i=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),s=this.getStyle("height").getPixels("y");if(!a&&!s){var o=new wt;this.children.forEach((e=>{o.addBoundingBox(e.getBoundingBox(t))})),i=Math.floor(o.x1),n=Math.floor(o.y1),a=Math.floor(o.width),s=Math.floor(o.height)}var h=this.removeStyles(e,Xt.ignoreStyles),l=r.createCanvas(i+a,n+s),c=l.getContext("2d");r.screen.setDefaults(c),this.renderChildren(c),new Yt(r,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(c,0,0,i+a,n+s);var u=r.createCanvas(i+a,n+s),d=u.getContext("2d");r.screen.setDefaults(d),e.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=c.createPattern(l,"no-repeat"),d.fillRect(0,0,i+a,n+s),t.fillStyle=d.createPattern(u,"no-repeat"),t.fillRect(0,0,i+a,n+s),this.restoreStyles(e,h)}render(t){}}Xt.ignoreStyles=["mask","transform","clip-path"];var qt=()=>{};class Qt extends mt{constructor(){super(...arguments),this.type="filter"}apply(t,e){var{document:r,children:i}=this,n=e.getBoundingBox(t);if(n){var a=0,s=0;i.forEach((t=>{var e=t.extraFilterDistance||0;a=Math.max(a,e),s=Math.max(s,e)}));var o=Math.floor(n.width),h=Math.floor(n.height),l=o+2*a,c=h+2*s;if(!(l<1||c<1)){var u=Math.floor(n.x),d=Math.floor(n.y),g=this.removeStyles(e,Qt.ignoreStyles),f=r.createCanvas(l,c),p=f.getContext("2d");r.screen.setDefaults(p),p.translate(-u+a,-d+s),e.render(p),i.forEach((t=>{"function"==typeof t.apply&&t.apply(p,0,0,l,c)})),t.drawImage(f,0,0,l,c,u-a,d-s,l,c),this.restoreStyles(e,g)}}}render(t){}}Qt.ignoreStyles=["filter","transform","clip-path"];var $t={svg:Et,rect:Rt,circle:class extends At{constructor(){super(...arguments),this.type="circle"}path(t){var e=this.getAttribute("cx").getPixels("x"),r=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return t&&i>0&&(t.beginPath(),t.arc(e,r,i,0,2*Math.PI,!1),t.closePath()),new wt(e-i,r-i,e+i,r+i)}getMarkers(){return null}},ellipse:class extends At{constructor(){super(...arguments),this.type="ellipse"}path(t){var e=(Math.sqrt(2)-1)/3*4,r=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),n=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return t&&r>0&&i>0&&(t.beginPath(),t.moveTo(n+r,a),t.bezierCurveTo(n+r,a+e*i,n+e*r,a+i,n,a+i),t.bezierCurveTo(n-e*r,a+i,n-r,a+e*i,n-r,a),t.bezierCurveTo(n-r,a-e*i,n-e*r,a-i,n,a-i),t.bezierCurveTo(n+e*r,a-i,n+r,a-e*i,n+r,a),t.closePath()),new wt(n-r,a-i,n+r,a+i)}getMarkers(){return null}},line:class extends At{constructor(){super(...arguments),this.type="line"}getPoints(){return[new st(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new st(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:e,y:r},{x:i,y:n}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,r),t.lineTo(i,n)),new wt(e,r,i,n)}getMarkers(){var[t,e]=this.getPoints(),r=t.angleTo(e);return[[t,r],[e,r]]}},polyline:Lt,polygon:class extends Lt{constructor(){super(...arguments),this.type="polygon"}path(t){var e=super.path(t),[{x:r,y:i}]=this.points;return t&&(t.lineTo(r,i),t.closePath()),e}},path:At,pattern:class extends mt{constructor(){super(...arguments),this.type="pattern"}createPattern(t,e,r){var i=this.getStyle("width").getPixels("x",!0),n=this.getStyle("height").getPixels("y",!0),a=new Et(this.document,null);a.attributes.viewBox=new nt(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new nt(this.document,"width","".concat(i,"px")),a.attributes.height=new nt(this.document,"height","".concat(n,"px")),a.attributes.transform=new nt(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var s=this.document.createCanvas(i,n),o=s.getContext("2d"),h=this.getAttribute("x"),l=this.getAttribute("y");h.hasValue()&&l.hasValue()&&o.translate(h.getPixels("x",!0),l.getPixels("y",!0)),r.hasValue()?this.styles["fill-opacity"]=r:Reflect.deleteProperty(this.styles,"fill-opacity");for(var c=-1;c<=1;c++)for(var u=-1;u<=1;u++)o.save(),a.attributes.x=new nt(this.document,"x",c*s.width),a.attributes.y=new nt(this.document,"y",u*s.height),a.render(o),o.restore();return t.createPattern(s,"repeat")}},marker:class extends mt{constructor(){super(...arguments),this.type="marker"}render(t,e,r){if(e){var{x:i,y:n}=e,a=this.getAttribute("orient").getString("auto"),s=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(i,n),"auto"===a&&t.rotate(r),"strokeWidth"===s&&t.scale(t.lineWidth,t.lineWidth),t.save();var o=new Et(this.document,null);o.type=this.type,o.attributes.viewBox=new nt(this.document,"viewBox",this.getAttribute("viewBox").getValue()),o.attributes.refX=new nt(this.document,"refX",this.getAttribute("refX").getValue()),o.attributes.refY=new nt(this.document,"refY",this.getAttribute("refY").getValue()),o.attributes.width=new nt(this.document,"width",this.getAttribute("markerWidth").getValue()),o.attributes.height=new nt(this.document,"height",this.getAttribute("markerHeight").getValue()),o.attributes.overflow=new nt(this.document,"overflow",this.getAttribute("overflow").getValue()),o.attributes.fill=new nt(this.document,"fill",this.getAttribute("fill").getColor("black")),o.attributes.stroke=new nt(this.document,"stroke",this.getAttribute("stroke").getValue("none")),o.children=this.children,o.render(t),t.restore(),"strokeWidth"===s&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"===a&&t.rotate(-r),t.translate(-i,-n)}}},defs:class extends mt{constructor(){super(...arguments),this.type="defs"}render(){}},linearGradient:class extends It{constructor(t,e,r){super(t,e,r),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,e){var r="objectBoundingBox"===this.getGradientUnits(),i=r?e.getBoundingBox(t):null;if(r&&!i)return null;this.getAttribute("x1").hasValue()||this.getAttribute("y1").hasValue()||this.getAttribute("x2").hasValue()||this.getAttribute("y2").hasValue()||(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var n=r?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=r?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),s=r?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),o=r?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return n===s&&a===o?null:t.createLinearGradient(n,a,s,o)}},radialGradient:class extends It{constructor(t,e,r){super(t,e,r),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,e){var r="objectBoundingBox"===this.getGradientUnits(),i=e.getBoundingBox(t);if(r&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var n=r?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=r?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),s=n,o=a;this.getAttribute("fx").hasValue()&&(s=r?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(o=r?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var h=r?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),l=this.getAttribute("fr").getPixels();return t.createRadialGradient(s,o,l,n,a,h)}},stop:class extends mt{constructor(t,e,r){super(t,e,r),this.type="stop";var i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),n=this.getStyle("stop-opacity"),a=this.getStyle("stop-color",!0);""===a.getString()&&a.setValue("#000"),n.hasValue()&&(a=a.addOpacity(n)),this.offset=i,this.color=a.getColor()}},animate:Dt,animateColor:class extends Dt{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:e,to:r}=this.getProgress(),i=new l(e.getColor()),n=new l(r.getColor());if(i.ok&&n.ok){var a=i.r+(n.r-i.r)*t,s=i.g+(n.g-i.g)*t,o=i.b+(n.b-i.b)*t;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(s),", ").concat(Math.floor(o),")")}return this.getAttribute("from").getColor()}},animateTransform:class extends Dt{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:e,to:r}=this.getProgress(),i=D(e.getString()),n=D(r.getString()),a=i.map(((e,r)=>e+(n[r]-e)*t)).join(" ");return a}},font:class extends mt{constructor(t,e,r){super(t,e,r),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:i}=t,{children:n}=this;for(var a of n)switch(a.type){case"font-face":this.fontFace=a;var s=a.getStyle("font-family");s.hasValue()&&(i[s.getString()]=this);break;case"missing-glyph":this.missingGlyph=a;break;case"glyph":var o=a;o.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[o.unicode]&&(this.glyphs[o.unicode]={}),this.glyphs[o.unicode][o.arabicForm]=o):this.glyphs[o.unicode]=o}}render(){}},"font-face":class extends mt{constructor(t,e,r){super(t,e,r),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}},"missing-glyph":class extends At{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}},glyph:Tt,text:Ot,tspan:kt,tref:class extends Ot{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var e=t.children[0];if(e)return e.getText()}return""}},a:class extends Ot{constructor(t,e,r){super(t,e,r),this.type="a";var{childNodes:i}=e,n=i[0],a=i.length>0&&Array.from(i).every((t=>3===t.nodeType));this.hasText=a,this.text=a?this.getTextFromNode(n):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:e,x:r,y:i}=this,{mouse:n}=e.screen,a=new nt(e,"fontSize",St.parse(e.ctx.font).fontSize);n.isWorking()&&n.checkBoundingBox(this,new wt(r,i-a.getPixels("y"),r+this.measureText(t),i))}else if(this.children.length>0){var s=new Nt(this.document,null);s.children=this.children,s.parent=this,s.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){this.document.ctx.canvas.style.cursor="pointer"}},textPath:class extends Ot{constructor(t,e,r){super(t,e,r),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}getText(){return this.text}path(t){var{dataArray:e}=this;t&&t.beginPath(),e.forEach((e=>{var{type:r,points:i}=e;switch(r){case Ct.LINE_TO:t&&t.lineTo(i[0],i[1]);break;case Ct.MOVE_TO:t&&t.moveTo(i[0],i[1]);break;case Ct.CURVE_TO:t&&t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case Ct.QUAD_TO:t&&t.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case Ct.ARC:var[n,a,s,o,h,l,c,u]=i,d=s>o?s:o,g=s>o?1:s/o,f=s>o?o/s:1;t&&(t.translate(n,a),t.rotate(c),t.scale(g,f),t.arc(0,0,d,h,h+l,Boolean(1-u)),t.scale(1/g,1/f),t.rotate(-c),t.translate(-n,-a));break;case Ct.CLOSE_PATH:t&&t.closePath()}}))}renderChildren(t){this.setTextData(t),t.save();var e=this.parent.getStyle("text-decoration").getString(),r=this.getFontSize(),{glyphInfo:i}=this,n=t.fillStyle;"underline"===e&&t.beginPath(),i.forEach(((i,n)=>{var{p0:a,p1:s,rotation:o,text:h}=i;t.save(),t.translate(a.x,a.y),t.rotate(o),t.fillStyle&&t.fillText(h,0,0),t.strokeStyle&&t.strokeText(h,0,0),t.restore(),"underline"===e&&(0===n&&t.moveTo(a.x,a.y+r/8),t.lineTo(s.x,s.y+r/5))})),"underline"===e&&(t.lineWidth=r/20,t.strokeStyle=n,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,r,i,n,a,s,o,h){var l=a,c=this.measureText(t,o);" "===o&&"justify"===e&&r<i&&(c+=(i-r)/n),h>-1&&(l+=this.getLetterSpacingAt(h));var u=this.textHeight/20,d=this.getEquidistantPointOnPath(l,u,0),g=this.getEquidistantPointOnPath(l+c,u,0),f={p0:d,p1:g},p=d&&g?Math.atan2(g.y-d.y,g.x-d.x):0;if(s){var v=Math.cos(Math.PI/2+p)*s,m=Math.cos(-p)*s;f.p0=Ft(Ft({},d),{},{x:d.x+v,y:d.y+m}),f.p1=Ft(Ft({},g),{},{x:g.x+v,y:g.y+m})}return{offset:l+=c,segment:f,rotation:p}}measureText(t,e){var{measuresCache:r}=this,i=e||this.getText();if(r.has(i))return r.get(i);var n=this.measureTargetText(t,i);return r.set(i,n),n}setTextData(t){if(!this.glyphInfo){var e=this.getText(),r=e.split(""),i=e.split(" ").length-1,n=this.parent.getAttribute("dx").split().map((t=>t.getPixels("x"))),a=this.parent.getAttribute("dy").getPixels("y"),s=this.parent.getStyle("text-anchor").getString("start"),o=this.getStyle("letter-spacing"),h=this.parent.getStyle("letter-spacing"),l=0;o.hasValue()&&"inherit"!==o.getValue()?o.hasValue()&&"initial"!==o.getValue()&&"unset"!==o.getValue()&&(l=o.getPixels()):l=h.getPixels();var c=[],u=e.length;this.letterSpacingCache=c;for(var d=0;d<u;d++)c.push(void 0!==n[d]?n[d]:l);var g=c.reduce(((t,e,r)=>0===r?0:t+e||0),0),f=this.measureText(t),p=Math.max(f+g,0);this.textWidth=f,this.textHeight=this.getFontSize(),this.glyphInfo=[];var v=this.getPathLength(),m=this.getStyle("startOffset").getNumber(0)*v,y=0;"middle"!==s&&"center"!==s||(y=-p/2),"end"!==s&&"right"!==s||(y=-p),y+=m,r.forEach(((e,n)=>{var{offset:o,segment:h,rotation:l}=this.findSegmentToFitChar(t,s,p,v,i,y,a,e,n);y=o,h.p0&&h.p1&&this.glyphInfo.push({text:r[n],p0:h.p0,p1:h.p1,rotation:l})}))}}parsePathData(t){if(this.pathLength=-1,!t)return[];var e=[],{pathParser:r}=t;for(r.reset();!r.isEnd();){var{current:i}=r,n=i?i.x:0,a=i?i.y:0,s=r.next(),o=s.type,h=[];switch(s.type){case Ct.MOVE_TO:this.pathM(r,h);break;case Ct.LINE_TO:o=this.pathL(r,h);break;case Ct.HORIZ_LINE_TO:o=this.pathH(r,h);break;case Ct.VERT_LINE_TO:o=this.pathV(r,h);break;case Ct.CURVE_TO:this.pathC(r,h);break;case Ct.SMOOTH_CURVE_TO:o=this.pathS(r,h);break;case Ct.QUAD_TO:this.pathQ(r,h);break;case Ct.SMOOTH_QUAD_TO:o=this.pathT(r,h);break;case Ct.ARC:h=this.pathA(r);break;case Ct.CLOSE_PATH:At.pathZ(r)}s.type!==Ct.CLOSE_PATH?e.push({type:o,points:h,start:{x:n,y:a},pathLength:this.calcLength(n,a,o,h)}):e.push({type:Ct.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){var{x:r,y:i}=At.pathM(t).point;e.push(r,i)}pathL(t,e){var{x:r,y:i}=At.pathL(t).point;return e.push(r,i),Ct.LINE_TO}pathH(t,e){var{x:r,y:i}=At.pathH(t).point;return e.push(r,i),Ct.LINE_TO}pathV(t,e){var{x:r,y:i}=At.pathV(t).point;return e.push(r,i),Ct.LINE_TO}pathC(t,e){var{point:r,controlPoint:i,currentPoint:n}=At.pathC(t);e.push(r.x,r.y,i.x,i.y,n.x,n.y)}pathS(t,e){var{point:r,controlPoint:i,currentPoint:n}=At.pathS(t);return e.push(r.x,r.y,i.x,i.y,n.x,n.y),Ct.CURVE_TO}pathQ(t,e){var{controlPoint:r,currentPoint:i}=At.pathQ(t);e.push(r.x,r.y,i.x,i.y)}pathT(t,e){var{controlPoint:r,currentPoint:i}=At.pathT(t);return e.push(r.x,r.y,i.x,i.y),Ct.QUAD_TO}pathA(t){var{rX:e,rY:r,sweepFlag:i,xAxisRotation:n,centp:a,a1:s,ad:o}=At.pathA(t);return 0===i&&o>0&&(o-=2*Math.PI),1===i&&o<0&&(o+=2*Math.PI),[a.x,a.y,e,r,s,o,n,i]}calcLength(t,e,r,i){var n=0,a=null,s=null,o=0;switch(r){case Ct.LINE_TO:return this.getLineLength(t,e,i[0],i[1]);case Ct.CURVE_TO:for(n=0,a=this.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),o=.01;o<=1;o+=.01)s=this.getPointOnCubicBezier(o,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),n+=this.getLineLength(a.x,a.y,s.x,s.y),a=s;return n;case Ct.QUAD_TO:for(n=0,a=this.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),o=.01;o<=1;o+=.01)s=this.getPointOnQuadraticBezier(o,t,e,i[0],i[1],i[2],i[3]),n+=this.getLineLength(a.x,a.y,s.x,s.y),a=s;return n;case Ct.ARC:n=0;var h=i[4],l=i[5],c=i[4]+l,u=Math.PI/180;if(Math.abs(h-c)<u&&(u=Math.abs(h-c)),a=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],h,0),l<0)for(o=h-u;o>c;o-=u)s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],o,0),n+=this.getLineLength(a.x,a.y,s.x,s.y),a=s;else for(o=h+u;o<c;o+=u)s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],o,0),n+=this.getLineLength(a.x,a.y,s.x,s.y),a=s;return s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),n+this.getLineLength(a.x,a.y,s.x,s.y)}return 0}getPointOnLine(t,e,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r,o=(n-r)/(i-e+X),h=Math.sqrt(t*t/(1+o*o));i<e&&(h*=-1);var l=o*h,c=null;if(i===e)c={x:a,y:s+l};else if((s-r)/(a-e+X)===o)c={x:a+h,y:s+l};else{var u,d,g=this.getLineLength(e,r,i,n);if(g<X)return null;var f=(a-e)*(i-e)+(s-r)*(n-r);u=e+(f/=g*g)*(i-e),d=r+f*(n-r);var p=this.getLineLength(a,s,u,d),v=Math.sqrt(t*t-p*p);h=Math.sqrt(v*v/(1+o*o)),i<e&&(h*=-1),c={x:u+h,y:d+(l=o*h)}}return c}getPointOnPath(t){var e=this.getPathLength(),r=0,i=null;if(t<-5e-5||t-5e-5>e)return null;var{dataArray:n}=this;for(var a of n){if(!a||!(a.pathLength<5e-5||r+a.pathLength+5e-5<t)){var s=t-r,o=0;switch(a.type){case Ct.LINE_TO:i=this.getPointOnLine(s,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case Ct.ARC:var h=a.points[4],l=a.points[5],c=a.points[4]+l;if(o=h+s/a.pathLength*l,l<0&&o<c||l>=0&&o>c)break;i=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],o,a.points[6]);break;case Ct.CURVE_TO:(o=s/a.pathLength)>1&&(o=1),i=this.getPointOnCubicBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case Ct.QUAD_TO:(o=s/a.pathLength)>1&&(o=1),i=this.getPointOnQuadraticBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}if(i)return i;break}r+=a.pathLength}return null}getLineLength(t,e,r,i){return Math.sqrt((r-t)*(r-t)+(i-e)*(i-e))}getPathLength(){return-1===this.pathLength&&(this.pathLength=this.dataArray.reduce(((t,e)=>e.pathLength>0?t+e.pathLength:t),0)),this.pathLength}getPointOnCubicBezier(t,e,r,i,n,a,s,o,h){return{x:o*Z(t)+a*K(t)+i*J(t)+e*tt(t),y:h*Z(t)+s*K(t)+n*J(t)+r*tt(t)}}getPointOnQuadraticBezier(t,e,r,i,n,a,s){return{x:a*et(t)+i*rt(t)+e*it(t),y:s*et(t)+n*rt(t)+r*it(t)}}getPointOnEllipticalArc(t,e,r,i,n,a){var s=Math.cos(a),o=Math.sin(a),h=r*Math.cos(n),l=i*Math.sin(n);return{x:t+(h*s-l*o),y:e+(h*o+l*s)}}buildEquidistantCache(t,e){var r=this.getPathLength(),i=e||.25,n=t||r/100;if(!this.equidistantCache||this.equidistantCache.step!==n||this.equidistantCache.precision!==i){this.equidistantCache={step:n,precision:i,points:[]};for(var a=0,s=0;s<=r;s+=i){var o=this.getPointOnPath(s),h=this.getPointOnPath(s+i);o&&h&&(a+=this.getLineLength(o.x,o.y,h.x,h.y))>=n&&(this.equidistantCache.points.push({x:o.x,y:o.y,distance:s}),a-=n)}}}getEquidistantPointOnPath(t,e,r){if(this.buildEquidistantCache(e,r),t<0||t-this.getPathLength()>5e-5)return null;var i=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}},image:class extends Pt{constructor(t,e,r){super(t,e,r),this.type="image",this.loaded=!1;var i=this.getHrefAttribute().getString();if(i){var n=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);t.images.push(this),n?this.loadSvg(i):this.loadImage(i),this.isSvg=n}}loadImage(t){var e=this;return s((function*(){try{var r=yield e.document.createImage(t);e.image=r}catch(e){console.error('Error while loading image "'.concat(t,'":'),e)}e.loaded=!0}))()}loadSvg(t){var e=this;return s((function*(){var r=Vt.exec(t);if(r){var i=r[5];"base64"===r[4]?e.image=atob(i):e.image=decodeURIComponent(i)}else try{var n=yield e.document.fetch(t),a=yield n.text();e.image=a}catch(e){console.error('Error while loading image "'.concat(t,'":'),e)}e.loaded=!0}))()}renderChildren(t){var{document:e,image:r,loaded:i}=this,n=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),s=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(i&&r&&s&&o){if(t.save(),t.translate(n,a),this.isSvg){var h=e.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:s,scaleHeight:o});h.document.documentElement.parent=this,h.render()}else{var l=this.image;e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:s,desiredWidth:l.width,height:o,desiredHeight:l.height}),this.loaded&&(void 0===l.complete||l.complete)&&t.drawImage(l,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),r=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new wt(t,e,t+r,e+i)}},g:Nt,symbol:class extends Pt{constructor(){super(...arguments),this.type="symbol"}render(t){}},style:zt,use:class extends Pt{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var e=this.getAttribute("x"),r=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),r.hasValue()&&t.translate(0,r.getPixels("y"))}path(t){var{element:e}=this;e&&e.path(t)}renderChildren(t){var{document:e,element:r}=this;if(r){var i=r;if("symbol"===r.type&&((i=new Et(e,null)).attributes.viewBox=new nt(e,"viewBox",r.getAttribute("viewBox").getString()),i.attributes.preserveAspectRatio=new nt(e,"preserveAspectRatio",r.getAttribute("preserveAspectRatio").getString()),i.attributes.overflow=new nt(e,"overflow",r.getAttribute("overflow").getString()),i.children=r.children,r.styles.opacity=new nt(e,"opacity",this.calculateOpacity())),"svg"===i.type){var n=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);n.hasValue()&&(i.attributes.width=new nt(e,"width",n.getString())),a.hasValue()&&(i.attributes.height=new nt(e,"height",a.getString()))}var s=i.parent;i.parent=this,i.render(t),i.parent=s}}getBoundingBox(t){var{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){var{document:t,element:e}=this;return vt.fromElement(t,e)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}},mask:Xt,clipPath:class extends mt{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:e}=this,r=Reflect.getPrototypeOf(t),{beginPath:i,closePath:n}=t;r&&(r.beginPath=qt,r.closePath=qt),Reflect.apply(i,t,[]),this.children.forEach((i=>{if(void 0!==i.path){var a=void 0!==i.elementTransform?i.elementTransform():null;a||(a=vt.fromElement(e,i)),a&&a.apply(t),i.path(t),r&&(r.closePath=n),a&&a.unapply(t)}})),Reflect.apply(n,t,[]),t.clip(),r&&(r.beginPath=i,r.closePath=n)}render(t){}},filter:Qt,feDropShadow:class extends mt{constructor(t,e,r){super(t,e,r),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,e,r,i,n){}},feMorphology:class extends mt{constructor(){super(...arguments),this.type="feMorphology"}apply(t,e,r,i,n){}},feComposite:class extends mt{constructor(){super(...arguments),this.type="feComposite"}apply(t,e,r,i,n){}},feColorMatrix:Yt,feGaussianBlur:class extends mt{constructor(t,e,r){super(t,e,r),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,e,r,i,n){var{document:a,blurRadius:s}=this,o=a.window?a.window.document.body:null,h=t.canvas;h.id=a.getUniqueId(),o&&(h.style.display="none",o.appendChild(h)),L(h,e,r,i,n,s),o&&o.removeChild(h)}},title:class extends mt{constructor(){super(...arguments),this.type="title"}},desc:class extends mt{constructor(){super(...arguments),this.type="desc"}}};function Zt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function Kt(){return Kt=s((function*(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=document.createElement("img");return e&&(r.crossOrigin="Anonymous"),new Promise(((e,i)=>{r.onload=()=>{e(r)},r.onerror=(t,e,r,n,a)=>{i(a)},r.src=t}))})),Kt.apply(this,arguments)}class Jt{constructor(t){var{rootEmSize:e=12,emSize:r=12,createCanvas:i=Jt.createCanvas,createImage:n=Jt.createImage,anonymousCrossOrigin:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=r,this.createCanvas=i,this.createImage=this.bindCreateImage(n,a),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,e){return"boolean"==typeof e?(r,i)=>t(r,"boolean"==typeof i?i:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:e}=this;e.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every((t=>t.loaded))}isFontsLoaded(){return this.fonts.every((t=>t.loaded))}createDocumentElement(t){var e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){var e=t.nodeName.replace(/^[^:]+:/,""),r=Jt.elementTypes[e];return void 0!==r?new r(this,t):new yt(this,t)}createTextNode(t){return new Mt(this,t)}setViewBox(t){this.screen.setViewBox(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Zt(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({document:this},t))}}function te(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function ee(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?te(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}Jt.createCanvas=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},Jt.createImage=function(t){return Kt.apply(this,arguments)},Jt.elementTypes=$t;class re{constructor(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.parser=new gt(r),this.screen=new ct(t,r),this.options=r;var i=new Jt(this,r),n=i.createDocumentElement(e);this.document=i,this.documentElement=n}static from(t,e){var r=arguments;return s((function*(){var i=r.length>2&&void 0!==r[2]?r[2]:{},n=new gt(i),a=yield n.parse(e);return new re(t,a,i)}))()}static fromString(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new gt(r).parseFromString(e);return new re(t,i,r)}fork(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return re.from(t,e,ee(ee({},this.options),r))}forkString(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return re.fromString(t,e,ee(ee({},this.options),r))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,e=this;return s((function*(){var r=t.length>0&&void 0!==t[0]?t[0]:{};e.start(ee({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},r)),yield e.ready(),e.stop()}))()}start(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{documentElement:e,screen:r,options:i}=this;r.start(e,ee(ee({enableRedraw:!0},i),t))}stop(){this.screen.stop()}resize(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.documentElement.resize(t,e,r)}}const ie=re;var ne=Math.PI/180;const ae="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},se={_global:ae,version:"8.2.2",isBrowser:"undefined"!=typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle:t=>se.angleDeg?t*ne:t,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>se.DD.isDragging,isDragReady:()=>!!se.DD.node,document:ae.document,_injectGlobal(t){ae.Konva=t}},oe=t=>{se[t.prototype.getClassName()]=t};se._injectGlobal(se);class he{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new he(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){var e=Math.cos(t),r=Math.sin(t),i=this.m[0]*e+this.m[2]*r,n=this.m[1]*e+this.m[3]*r,a=this.m[0]*-r+this.m[2]*e,s=this.m[1]*-r+this.m[3]*e;return this.m[0]=i,this.m[1]=n,this.m[2]=a,this.m[3]=s,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){var r=this.m[0]+this.m[2]*e,i=this.m[1]+this.m[3]*e,n=this.m[2]+this.m[0]*t,a=this.m[3]+this.m[1]*t;return this.m[0]=r,this.m[1]=i,this.m[2]=n,this.m[3]=a,this}multiply(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],r=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],n=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],s=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=r,this.m[2]=i,this.m[3]=n,this.m[4]=a,this.m[5]=s,this}invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,r=-this.m[1]*t,i=-this.m[2]*t,n=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),s=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=r,this.m[2]=i,this.m[3]=n,this.m[4]=a,this.m[5]=s,this}getMatrix(){return this.m}setAbsolutePosition(t,e){var r=this.m[0],i=this.m[1],n=this.m[2],a=this.m[3],s=this.m[4],o=(r*(e-this.m[5])-i*(t-s))/(r*a-i*n),h=(t-s-n*o)/r;return this.translate(h,o)}decompose(){var t=this.m[0],e=this.m[1],r=this.m[2],i=this.m[3],n=t*i-e*r;let a={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=e){var s=Math.sqrt(t*t+e*e);a.rotation=e>0?Math.acos(t/s):-Math.acos(t/s),a.scaleX=s,a.scaleY=n/s,a.skewX=(t*r+e*i)/n,a.skewY=0}else if(0!=r||0!=i){var o=Math.sqrt(r*r+i*i);a.rotation=Math.PI/2-(i>0?Math.acos(-r/o):-Math.acos(r/o)),a.scaleX=n/o,a.scaleY=o,a.skewX=0,a.skewY=(t*r+e*i)/n}return a.rotation=ve._getRotation(a.rotation),a}}var le=Math.PI/180,ce=180/Math.PI,ue="Konva error: ",de={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},ge=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,fe=[];const pe="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)},ve={_isElement:t=>!(!t||1!=t.nodeType),_isFunction:t=>!!(t&&t.constructor&&t.call&&t.apply),_isPlainObject:t=>!!t&&t.constructor===Object,_isArray:t=>"[object Array]"===Object.prototype.toString.call(t),_isNumber:t=>"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)&&isFinite(t),_isString:t=>"[object String]"===Object.prototype.toString.call(t),_isBoolean:t=>"[object Boolean]"===Object.prototype.toString.call(t),isObject:t=>t instanceof Object,isValidSelector(t){if("string"!=typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:t=>0===t||t>0?1:-1,requestAnimFrame(t){fe.push(t),1===fe.length&&pe((function(){const t=fe;fe=[],t.forEach((function(t){t()}))}))},createCanvasElement(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(t){}return t},createImageElement:()=>document.createElement("img"),_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){var r=ve.createImageElement();r.onload=function(){e(r)},r.src=t},_rgbToHex:(t,e,r)=>((1<<24)+(t<<16)+(e<<8)+r).toString(16).slice(1),_hexToRgb(t){t=t.replace("#","");var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;)t="0"+t;return"#"+t},getRGB(t){var e;return t in de?{r:(e=de[t])[0],g:e[1],b:e[2]}:"#"===t[0]?this._hexToRgb(t.substring(1)):"rgb("===t.substr(0,4)?(e=ge.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:t=>(t=t||"black",ve._namedColorToRBA(t)||ve._hex3ColorToRGBA(t)||ve._hex6ColorToRGBA(t)||ve._rgbColorToRGBA(t)||ve._rgbaColorToRGBA(t)||ve._hslColorToRGBA(t)),_namedColorToRBA(t){var e=de[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){var e=(t=t.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){var e=(t=t.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){const[e,...r]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),i=Number(r[0])/360,n=Number(r[1])/100,a=Number(r[2])/100;let s,o,h;if(0===n)return h=255*a,{r:Math.round(h),g:Math.round(h),b:Math.round(h),a:1};s=a<.5?a*(1+n):a+n-a*n;const l=2*a-s,c=[0,0,0];for(let t=0;t<3;t++)o=i+1/3*-(t-1),o<0&&o++,o>1&&o--,h=6*o<1?l+6*(s-l)*o:2*o<1?s:3*o<2?l+(s-l)*(2/3-o)*6:l,c[t]=255*h;return{r:Math.round(c[0]),g:Math.round(c[1]),b:Math.round(c[2]),a:1}}},haveIntersection:(t,e)=>!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y),cloneObject(t){var e={};for(var r in t)this._isPlainObject(t[r])?e[r]=this.cloneObject(t[r]):this._isArray(t[r])?e[r]=this.cloneArray(t[r]):e[r]=t[r];return e},cloneArray:t=>t.slice(0),degToRad:t=>t*le,radToDeg:t=>t*ce,_degToRad:t=>(ve.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),ve.degToRad(t)),_radToDeg:t=>(ve.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),ve.radToDeg(t)),_getRotation:t=>se.angleDeg?ve.radToDeg(t):t,_capitalize:t=>t.charAt(0).toUpperCase()+t.slice(1),throw(t){throw new Error(ue+t)},error(t){console.error(ue+t)},warn(t){se.showWarnings&&console.warn("Konva warning: "+t)},each(t,e){for(var r in t)e(r,t[r])},_inRange:(t,e,r)=>e<=t&&t<r,_getProjectionToSegment(t,e,r,i,n,a){var s,o,h,l=(t-r)*(t-r)+(e-i)*(e-i);if(0==l)s=t,o=e,h=(n-r)*(n-r)+(a-i)*(a-i);else{var c=((n-t)*(r-t)+(a-e)*(i-e))/l;c<0?(s=t,o=e,h=(t-n)*(t-n)+(e-a)*(e-a)):c>1?(s=r,o=i,h=(r-n)*(r-n)+(i-a)*(i-a)):h=((s=t+c*(r-t))-n)*(s-n)+((o=e+c*(i-e))-a)*(o-a)}return[s,o,h]},_getProjectionToLine(t,e,r){var i=ve.cloneObject(t),n=Number.MAX_VALUE;return e.forEach((function(a,s){if(r||s!==e.length-1){var o=e[(s+1)%e.length],h=ve._getProjectionToSegment(a.x,a.y,o.x,o.y,t.x,t.y),l=h[0],c=h[1],u=h[2];u<n&&(i.x=l,i.y=c,n=u)}})),i},_prepareArrayForTween(t,e,r){var i,n=[],a=[];if(t.length>e.length){var s=e;e=t,t=s}for(i=0;i<t.length;i+=2)n.push({x:t[i],y:t[i+1]});for(i=0;i<e.length;i+=2)a.push({x:e[i],y:e[i+1]});var o=[];return a.forEach((function(t){var e=ve._getProjectionToLine(t,n,r);o.push(e.x),o.push(e.y)})),o},_prepareToStringify(t){var e;for(var r in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(r)&&t[r]&&"object"==typeof t[r])if(e=Object.getOwnPropertyDescriptor(t,r),t[r].visitedByCircularReferenceRemoval||ve._isElement(t[r])){if(!e.configurable)return null;delete t[r]}else if(null===ve._prepareToStringify(t[r])){if(!e.configurable)return null;delete t[r]}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(var r in e)t[r]=e[r];return t},_getFirstPointerId:t=>t.touches?t.changedTouches[0].identifier:999};function me(t){return ve._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||ve._isBoolean(t)?t:Object.prototype.toString.call(t)}function ye(t){return t>255?255:t<0?0:Math.round(t)}function xe(){if(se.isUnminified)return function(t,e){return ve._isNumber(t)||ve.warn(me(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function be(t){if(se.isUnminified)return function(e,r){let i=ve._isNumber(e),n=ve._isArray(e)&&e.length==t;return i||n||ve.warn(me(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function _e(){if(se.isUnminified)return function(t,e){return ve._isNumber(t)||"auto"===t||ve.warn(me(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function Se(){if(se.isUnminified)return function(t,e){return ve._isString(t)||ve.warn(me(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function we(){if(se.isUnminified)return function(t,e){const r=ve._isString(t),i="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return r||i||ve.warn(me(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function Ce(){if(se.isUnminified)return function(t,e){return!0===t||!1===t||ve.warn(me(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}var Pe="get",Ae="set";const Te={addGetterSetter(t,e,r,i,n){Te.addGetter(t,e,r),Te.addSetter(t,e,i,n),Te.addOverloadedGetterSetter(t,e)},addGetter(t,e,r){var i=Pe+ve._capitalize(e);t.prototype[i]=t.prototype[i]||function(){var t=this.attrs[e];return void 0===t?r:t}},addSetter(t,e,r,i){var n=Ae+ve._capitalize(e);t.prototype[n]||Te.overWriteSetter(t,e,r,i)},overWriteSetter(t,e,r,i){var n=Ae+ve._capitalize(e);t.prototype[n]=function(t){return r&&null!=t&&(t=r.call(this,t,e)),this._setAttr(e,t),i&&i.call(this),this}},addComponentsGetterSetter(t,e,r,i,n){var a,s,o=r.length,h=ve._capitalize,l=Pe+h(e),c=Ae+h(e);t.prototype[l]=function(){var t={};for(a=0;a<o;a++)t[s=r[a]]=this.getAttr(e+h(s));return t};var u=function(t){if(se.isUnminified)return function(e,r){return ve.isObject(e)||ve.warn(me(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(r);t.prototype[c]=function(t){var r,a=this.attrs[e];for(r in i&&(t=i.call(this,t)),u&&u.call(this,t,e),t)t.hasOwnProperty(r)&&this._setAttr(e+h(r),t[r]);return this._fireChangeEvent(e,a,t),n&&n.call(this),this},Te.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){var r=ve._capitalize(e),i=Ae+r,n=Pe+r;t.prototype[e]=function(){return arguments.length?(this[i](arguments[0]),this):this[n]()}},addDeprecatedGetterSetter(t,e,r,i){ve.error("Adding deprecated "+e);var n=Pe+ve._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[n]=function(){ve.error(a);var t=this.attrs[e];return void 0===t?r:t},Te.addSetter(t,e,i,(function(){ve.error(a)})),Te.addOverloadedGetterSetter(t,e)},backCompat(t,e){ve.each(e,(function(e,r){var i=t.prototype[r],n=Pe+ve._capitalize(e),a=Ae+ve._capitalize(e);function s(){i.apply(this,arguments),ve.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+r+'" instead.')}t.prototype[e]=s,t.prototype[n]=s,t.prototype[a]=s}))},afterSetFilter(){this._filterUpToDate=!1}};function Oe(t){var e,r,i=[],n=t.length,a=ve;for(e=0;e<n;e++)r=t[e],a._isNumber(r)?r=Math.round(1e3*r)/1e3:a._isString(r)||(r+=""),i.push(r);return i}var ke,Me=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class Ee{constructor(t){this.canvas=t,this._context=t._canvas.getContext("2d"),se.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var r,i,n,a,s=this.traceArr,o=s.length,h="";for(r=0;r<o;r++)(n=(i=s[r]).method)?(a=i.args,h+=n,t?h+="()":ve._isArray(a[0])?h+="(["+a.join(",")+"])":(e&&(a=a.map((t=>"number"==typeof t?Math.floor(t):t))),h+="("+a.join(",")+")")):(h+=i.property,t||(h+="="+i.val)),h+=";";return h}clearTrace(){this.traceArr=[]}_trace(t){var e=this.traceArr;e.push(t),e.length>=100&&e.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){var e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,r,i,n,a){this._context.arc(t,e,r,i,n,a)}arcTo(t,e,r,i,n){this._context.arcTo(t,e,r,i,n)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,r,i,n,a){this._context.bezierCurveTo(t,e,r,i,n,a)}clearRect(t,e,r,i){this._context.clearRect(t,e,r,i)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(t,e){var r=arguments;return 2===r.length?this._context.createImageData(t,e):1===r.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,r,i){return this._context.createLinearGradient(t,e,r,i)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,r,i,n,a){return this._context.createRadialGradient(t,e,r,i,n,a)}drawImage(t,e,r,i,n,a,s,o,h){var l=arguments,c=this._context;3===l.length?c.drawImage(t,e,r):5===l.length?c.drawImage(t,e,r,i,n):9===l.length&&c.drawImage(t,e,r,i,n,a,s,o,h)}ellipse(t,e,r,i,n,a,s,o){this._context.ellipse(t,e,r,i,n,a,s,o)}isPointInPath(t,e){return this._context.isPointInPath(t,e)}fill(t){t?this._context.fill(t):this._context.fill()}fillRect(t,e,r,i){this._context.fillRect(t,e,r,i)}strokeRect(t,e,r,i){this._context.strokeRect(t,e,r,i)}fillText(t,e,r,i){i?this._context.fillText(t,e,r,i):this._context.fillText(t,e,r)}measureText(t){return this._context.measureText(t)}getImageData(t,e,r,i){return this._context.getImageData(t,e,r,i)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,r,i){this._context.rect(t,e,r,i)}putImageData(t,e,r){this._context.putImageData(t,e,r)}quadraticCurveTo(t,e,r,i){this._context.quadraticCurveTo(t,e,r,i)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,r,i,n,a){this._context.setTransform(t,e,r,i,n,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,r,i){this._context.strokeText(t,e,r,i)}transform(t,e,r,i,n,a){this._context.transform(t,e,r,i,n,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t,e,r=this,i=Me.length,n=this.setAttr,a=function(t){var i,n=r[t];r[t]=function(){return e=Oe(Array.prototype.slice.call(arguments,0)),i=n.apply(r,arguments),r._trace({method:t,args:e}),i}};for(t=0;t<i;t++)a(Me[t]);r.setAttr=function(){n.apply(r,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),r._trace({property:t,val:e})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||"source-over"===e||this.setAttr("globalCompositeOperation",e)}}["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach((function(t){Object.defineProperty(Ee.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}));class Re extends Ee{_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){var e=t.fill(),r=t.getFillPriority();if(e&&"color"===r)this._fillColor(t);else{var i=t.getFillPatternImage();if(i&&"pattern"===r)this._fillPattern(t);else{var n=t.getFillLinearGradientColorStops();if(n&&"linear-gradient"===r)this._fillLinearGradient(t);else{var a=t.getFillRadialGradientColorStops();a&&"radial-gradient"===r?this._fillRadialGradient(t):e?this._fillColor(t):i?this._fillPattern(t):n?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}}}}_strokeLinearGradient(t){var e=t.getStrokeLinearGradientStartPoint(),r=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),n=this.createLinearGradient(e.x,e.y,r.x,r.y);if(i){for(var a=0;a<i.length;a+=2)n.addColorStop(i[a],i[a+1]);this.setAttr("strokeStyle",n)}}_stroke(t){var e=t.dash(),r=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!r){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),r||this.restore()}}_applyShadow(t){var e,r,i,n=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",a=null!==(r=t.getShadowBlur())&&void 0!==r?r:5,s=null!==(i=t.getShadowOffset())&&void 0!==i?i:{x:0,y:0},o=t.getAbsoluteScale(),h=this.canvas.getPixelRatio(),l=o.x*h,c=o.y*h;this.setAttr("shadowColor",n),this.setAttr("shadowBlur",a*Math.min(Math.abs(l),Math.abs(c))),this.setAttr("shadowOffsetX",s.x*l),this.setAttr("shadowOffsetY",s.y*c)}}class Le extends Ee{_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t);var i=t.hitStrokeWidth(),n="auto"===i?t.strokeWidth():i;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}class Ne{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=(t||{}).pixelRatio||se.pixelRatio||function(){if(ke)return ke;var t=ve.createCanvasElement().getContext("2d");return ke=(se._global.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}();this.pixelRatio=e,this._canvas=ve.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(t){try{return this._canvas.toDataURL()}catch(t){return ve.error("Unable to get data URL. "+t.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Te.addGetterSetter(Ne,"pixelRatio",void 0,xe());class Ie extends Ne{constructor(t={width:0,height:0}){super(t),this.context=new Re(this),this.setSize(t.width,t.height)}}class De extends Ne{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Le(this),this.setSize(t.width,t.height)}}const Ge={get isDragging(){var t=!1;return Ge._dragElements.forEach((e=>{"dragging"===e.dragStatus&&(t=!0)})),t},justDragged:!1,get node(){var t;return Ge._dragElements.forEach((e=>{t=e.node})),t},_dragElements:new Map,_drag(t){const e=[];Ge._dragElements.forEach(((r,i)=>{const{node:n}=r,a=n.getStage();a.setPointersPositions(t),void 0===r.pointerId&&(r.pointerId=ve._getFirstPointerId(t));const s=a._changedPointerPositions.find((t=>t.id===r.pointerId));if(s){if("dragging"!==r.dragStatus){var o=n.dragDistance();if(Math.max(Math.abs(s.x-r.startPointerPos.x),Math.abs(s.y-r.startPointerPos.y))<o)return;if(n.startDrag({evt:t}),!n.isDragging())return}n._setDragPosition(t,r),e.push(n)}})),e.forEach((e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)}))},_endDragBefore(t){Ge._dragElements.forEach((e=>{const{node:r}=e,i=r.getStage();if(t&&i.setPointersPositions(t),!i._changedPointerPositions.find((t=>t.id===e.pointerId)))return;"dragging"!==e.dragStatus&&"stopped"!==e.dragStatus||(Ge.justDragged=!0,se._mouseListenClick=!1,se._touchListenClick=!1,se._pointerListenClick=!1,e.dragStatus="stopped");const n=e.node.getLayer()||e.node instanceof se.Stage&&e.node;n&&n.batchDraw()}))},_endDragAfter(t){Ge._dragElements.forEach(((e,r)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),"dragging"!==e.dragStatus&&Ge._dragElements.delete(r)}))}};se.isBrowser&&(window.addEventListener("mouseup",Ge._endDragBefore,!0),window.addEventListener("touchend",Ge._endDragBefore,!0),window.addEventListener("mousemove",Ge._drag),window.addEventListener("touchmove",Ge._drag),window.addEventListener("mouseup",Ge._endDragAfter,!1),window.addEventListener("touchend",Ge._endDragAfter,!1));var Fe="absoluteOpacity",Ve="allEventListeners",Be="absoluteTransform",ze="absoluteScale",je="canvas",He="listening",We="mouseenter",Ue="mouseleave",Ye="Shape",Xe=" ",qe="stage",Qe="transform",$e="visible",Ze=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Xe);let Ke=1;class Je{constructor(t){this._id=Ke++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){t!==Qe&&t!==Be||!this._cache.get(t)?t?this._cache.delete(t):this._cache.clear():this._cache.get(t).dirty=!0}_getCache(t,e){var r=this._cache.get(t);return(void 0===r||(t===Qe||t===Be)&&!0===r.dirty)&&(r=e.call(this),this._cache.set(t,r)),r}_calculate(t,e,r){if(!this._attachedDepsListeners.get(t)){const r=e.map((t=>t+"Change.konva")).join(Xe);this.on(r,(()=>{this._clearCache(t)})),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,r)}_getCanvasCache(){return this._cache.get(je)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Be&&this.fire("absoluteTransformChange")}clearCache(){return this._cache.delete(je),this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},r={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var i=Math.ceil(e.width||r.width),n=Math.ceil(e.height||r.height),a=e.pixelRatio,s=void 0===e.x?r.x:e.x,o=void 0===e.y?r.y:e.y,h=e.offset||0,l=e.drawBorder||!1,c=e.hitCanvasPixelRatio||1;if(i&&n){s-=h,o-=h;var u=new Ie({pixelRatio:a,width:i+=2*h,height:n+=2*h}),d=new Ie({pixelRatio:a,width:0,height:0}),g=new De({pixelRatio:c,width:i,height:n}),f=u.getContext(),p=g.getContext();return g.isCache=!0,u.isCache=!0,this._cache.delete(je),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(u.getContext()._context.imageSmoothingEnabled=!1,d.getContext()._context.imageSmoothingEnabled=!1),f.save(),p.save(),f.translate(-s,-o),p.translate(-s,-o),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Fe),this._clearSelfAndDescendantCache(ze),this.drawScene(u,this),this.drawHit(g,this),this._isUnderCache=!1,f.restore(),p.restore(),l&&(f.save(),f.beginPath(),f.rect(0,0,i,n),f.closePath(),f.setAttr("strokeStyle","red"),f.setAttr("lineWidth",5),f.stroke(),f.restore()),this._cache.set(je,{scene:u,filter:d,hit:g,x:s,y:o}),this._requestDraw(),this}ve.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")}isCached(){return this._cache.has(je)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var r,i,n,a,s=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o=this.getAbsoluteTransform(e);return s.forEach((function(t){var e=o.point(t);void 0===r&&(r=n=e.x,i=a=e.y),r=Math.min(r,e.x),i=Math.min(i,e.y),n=Math.max(n,e.x),a=Math.max(a,e.y)})),{x:r,y:i,width:n-r,height:a-i}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var r=this._getCachedSceneCanvas(),i=r.pixelRatio;t.drawImage(r._canvas,0,0,r.width/i,r.height/i),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),r=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t,e,r,i,n=this.filters(),a=this._getCanvasCache(),s=a.scene,o=a.filter,h=o.getContext();if(n){if(!this._filterUpToDate){var l=s.pixelRatio;o.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio);try{for(t=n.length,h.clear(),h.drawImage(s._canvas,0,0,s.getWidth()/l,s.getHeight()/l),e=h.getImageData(0,0,o.getWidth(),o.getHeight()),r=0;r<t;r++)"function"==typeof(i=n[r])?(i.call(this,e),h.putImageData(e,0,0)):ve.error("Filter should be type of function, but got "+typeof i+" instead. Please check correct filters")}catch(t){ve.error("Unable to apply filter. "+t.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return o}return s}on(t,e){if(this._cache&&this._cache.delete(Ve),3===arguments.length)return this._delegate.apply(this,arguments);var r,i,n,a,s=t.split(Xe),o=s.length;for(r=0;r<o;r++)n=(i=s[r].split("."))[0],a=i[1]||"",this.eventListeners[n]||(this.eventListeners[n]=[]),this.eventListeners[n].push({name:a,handler:e});return this}off(t,e){var r,i,n,a,s,o=(t||"").split(Xe),h=o.length;if(this._cache&&this._cache.delete(Ve),!t)for(i in this.eventListeners)this._off(i);for(r=0;r<h;r++)if(a=(n=o[r].split("."))[0],s=n[1],a)this.eventListeners[a]&&this._off(a,s,e);else for(i in this.eventListeners)this._off(i,s,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,r){var i=this;this.on(t,(function(t){for(var n=t.target.findAncestors(e,!0,i),a=0;a<n.length;a++)(t=ve.cloneObject(t)).currentTarget=n[a],r.call(n[a],t)}))}remove(){return this.isDragging()&&this.stopDrag(),Ge._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Be),this._clearSelfAndDescendantCache(Fe),this._clearSelfAndDescendantCache(ze),this._clearSelfAndDescendantCache(qe),this._clearSelfAndDescendantCache($e),this._clearSelfAndDescendantCache(He)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this}getAttr(t){var e="get"+ve._capitalize(t);return ve._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){for(var t=this.getParent(),e=[];t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges((()=>{var e,r;if(!t)return this;for(e in t)"children"!==e&&(r="set"+ve._capitalize(e),ve._isFunction(this[r])?this[r](t[e]):this._setAttr(e,t[e]))})),this}isListening(){return this._getCache(He,this._isListening)}_isListening(t){if(!this.listening())return!1;const e=this.getParent();return!e||e===t||this===t||e._isListening(t)}isVisible(){return this._getCache($e,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const e=this.getParent();return!e||e===t||this===t||e._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var r=this.getLayer(),i=!1;Ge._dragElements.forEach((t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType||t.node.getLayer()===r)&&(i=!0)}));var n=!e&&!se.hitOnDragEnabled&&i;return this.isListening()&&this.isVisible()&&!n}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t,e,r,i,n=this.getDepth(),a=this,s=0;return"Stage"!==a.nodeType&&function o(h){for(t=[],e=h.length,r=0;r<e;r++)i=h[r],s++,i.nodeType!==Ye&&(t=t.concat(i.getChildren().slice())),i._id===a._id&&(r=e);t.length>0&&t[0].getDepth()<=n&&o(t)}(a.getStage().getChildren()),s}getDepth(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Qe),this._clearSelfAndDescendantCache(Be)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges((()=>{this.x(t.x),this.y(t.y)})),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var t=this.getStage().getPointerPosition();if(!t)return null;var e=this.getAbsoluteTransform().copy();return e.invert(),e.point(t)}getAbsolutePosition(t){let e=!1,r=this.parent;for(;r;){if(r.isCached()){e=!0;break}r=r.parent}e&&!t&&(t=!0);var i=this.getAbsoluteTransform(t).getMatrix(),n=new he,a=this.offset();return n.m=i.slice(),n.translate(a.x,a.y),n.getTranslation()}setAbsolutePosition(t){var e=this._clearTransform();this.attrs.x=e.x,this.attrs.y=e.y,delete e.x,delete e.y,this._clearCache(Qe);var r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(t.x,t.y),t={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(e),this.setPosition({x:t.x,y:t.y}),this._clearCache(Qe),this._clearSelfAndDescendantCache(Be),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,r=t.y,i=this.x(),n=this.y();return void 0!==e&&(i+=e),void 0!==r&&(n+=r),this.setPosition({x:i,y:n}),this}_eachAncestorReverse(t,e){var r,i,n=[],a=this.getParent();if(!e||e._id!==this._id){for(n.unshift(this);a&&(!e||a._id!==e._id);)n.unshift(a),a=a.parent;for(r=n.length,i=0;i<r;i++)t(n[i])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return ve.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0}moveUp(){if(!this.parent)return ve.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return ve.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return ve.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return ve.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&ve.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Fe,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t,e,r,i,n={},a=this.getAttrs();for(t in n.attrs={},a)e=a[t],ve.isObject(e)&&!ve._isPlainObject(e)&&!ve._isArray(e)||(r="function"==typeof this[t]&&this[t],delete a[t],i=r?r.call(this):null,a[t]=e,i!==e&&(n.attrs[t]=e));return n.className=this.getClassName(),ve._prepareToStringify(n)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,r){var i=[];e&&this._isMatch(t)&&i.push(this);for(var n=this.parent;n;){if(n===r)return i;n._isMatch(t)&&i.push(n),n=n.parent}return i}isAncestorOf(t){return!1}findAncestor(t,e,r){return this.findAncestors(t,e,r)[0]}_isMatch(t){if(!t)return!1;if("function"==typeof t)return t(this);var e,r,i=t.replace(/ /g,"").split(","),n=i.length;for(e=0;e<n;e++)if(r=i[e],ve.isValidSelector(r)||(ve.warn('Selector "'+r+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),ve.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),ve.warn("Konva is awesome, right?")),"#"===r.charAt(0)){if(this.id()===r.slice(1))return!0}else if("."===r.charAt(0)){if(this.hasName(r.slice(1)))return!0}else if(this.className===r||this.nodeType===r)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(qe,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():void 0}fire(t,e={},r){return e.target=e.target||this,r?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Be,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new he,this._eachAncestorReverse((function(t){var r=t.transformsEnabled();"all"===r?e.multiply(t.getTransform()):"position"===r&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this._cache.get(Be)||new he,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var r=this.transformsEnabled();if("all"===r)e.multiply(this.getTransform());else if("position"===r){const t=this.attrs.x||0,r=this.attrs.y||0,i=this.attrs.offsetX||0,n=this.attrs.offsetY||0;e.translate(t-i,r-n)}return e.dirty=!1,e}getAbsoluteScale(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Qe,this._getTransform)}_getTransform(){var t,e,r=this._cache.get(Qe)||new he;r.reset();var i=this.x(),n=this.y(),a=se.getAngle(this.rotation()),s=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,o=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,h=this.attrs.skewX||0,l=this.attrs.skewY||0,c=this.attrs.offsetX||0,u=this.attrs.offsetY||0;return 0===i&&0===n||r.translate(i,n),0!==a&&r.rotate(a),0===h&&0===l||r.skew(h,l),1===s&&1===o||r.scale(s,o),0===c&&0===u||r.translate(-1*c,-1*u),r.dirty=!1,r}clone(t){var e,r,i,n,a,s=ve.cloneObject(this.attrs);for(e in t)s[e]=t[e];var o=new this.constructor(s);for(e in this.eventListeners)for(i=(r=this.eventListeners[e]).length,n=0;n<i;n++)(a=r[n]).name.indexOf("konva")<0&&(o.eventListeners[e]||(o.eventListeners[e]=[]),o.eventListeners[e].push(a));return o}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),r=this.getStage(),i=void 0!==t.x?t.x:e.x,n=void 0!==t.y?t.y:e.y,a=t.pixelRatio||1,s=new Ie({width:t.width||e.width||(r?r.width():0),height:t.height||e.height||(r?r.height():0),pixelRatio:a}),o=s.getContext();return o.save(),(i||n)&&o.translate(-1*i,-1*n),this.drawScene(s),o.restore(),s}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){var e=(t=t||{}).mimeType||null,r=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(e,r);return t.callback&&t.callback(i),i}toImage(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,ve._urlToImage(this.toDataURL(t),(function(t){e(t)}))}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():se.dragDistance}_off(t,e,r){var i,n,a,s=this.eventListeners[t];for(i=0;i<s.length;i++)if(n=s[i].name,a=s[i].handler,!("konva"===n&&"konva"!==e||e&&n!==e||r&&r!==a)){if(s.splice(i,1),0===s.length){delete this.eventListeners[t];break}i--}}_fireChangeEvent(t,e,r){this._fire(t+"Change",{oldVal:e,newVal:r})}addName(t){if(!this.hasName(t)){var e=this.name(),r=e?e+" "+t:t;this.name(r)}return this}hasName(t){if(!t)return!1;const e=this.name();return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)}removeName(t){var e=(this.name()||"").split(/\s/g),r=e.indexOf(t);return-1!==r&&(e.splice(r,1),this.name(e.join(" "))),this}setAttr(t,e){var r=this["set"+ve._capitalize(t)];return ve._isFunction(r)?r.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(se.autoDrawEnabled){const t=this.getLayer()||this.getStage();null==t||t.batchDraw()}}_setAttr(t,e){var r=this.attrs[t];(r!==e||ve.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,r,e),this._requestDraw())}_setComponentAttr(t,e,r){var i;void 0!==r&&((i=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=r,this._fireChangeEvent(t,i,r))}_fireAndBubble(t,e,r){if(e&&this.nodeType===Ye&&(e.target=this),t!==We&&t!==Ue||!(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||"Stage"===this.nodeType&&!r)){this._fire(t,e);var i=(t===We||t===Ue)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!i&&(r&&r.parent?this._fireAndBubble.call(this.parent,t,e,r):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){let e=this._cache.get(Ve);if(!e){e={};let t=Object.getPrototypeOf(this);for(;t;)if(t.eventListeners){for(var r in t.eventListeners){const i=t.eventListeners[r],n=e[r]||[];e[r]=i.concat(n)}t=Object.getPrototypeOf(t)}else t=Object.getPrototypeOf(t);this._cache.set(Ve,e)}return e[t]}_fire(t,e){(e=e||{}).currentTarget=this,e.type=t;const r=this._getProtoListeners(t);if(r)for(var i=0;i<r.length;i++)r[i].handler.call(this,e);const n=this.eventListeners[t];if(n)for(i=0;i<n.length;i++)n[i].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition(),n=r._getPointerById(e)||r._changedPointerPositions[0]||i;Ge._dragElements.set(this._id,{node:this,startPointerPos:n,offset:{x:n.x-i.x,y:n.y-i.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){Ge._dragElements.has(this._id)||this._createDragElement(t),Ge._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const r=this.getStage()._getPointerById(e.pointerId);if(r){var i={x:r.x-e.offset.x,y:r.y-e.offset.y},n=this.dragBoundFunc();if(void 0!==n){const e=n.call(this,i,t);e?i=e:ve.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===i.x&&this._lastPos.y===i.y||(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}}stopDrag(t){const e=Ge._dragElements.get(this._id);e&&(e.dragStatus="stopped"),Ge._endDragBefore(t),Ge._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=Ge._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){if((void 0===t.evt.button||se.dragButtons.indexOf(t.evt.button)>=0)&&!this.isDragging()){var e=!1;Ge._dragElements.forEach((t=>{this.isAncestorOf(t.node)&&(e=!0)})),e||this._createDragElement(t)}}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=Ge._dragElements.get(this._id),e=t&&"dragging"===t.dragStatus,r=t&&"ready"===t.dragStatus;e?this.stopDrag():r&&Ge._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const r={x:-t.x,y:-t.y,width:e.width()+t.x,height:e.height()+t.y};return ve.haveIntersection(r,this.getClientRect())}static create(t,e){return ve._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var r,i,n,a=Je.prototype.getClassName.call(t),s=t.children;if(e&&(t.attrs.container=e),se[a]||(ve.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape"),r=new(0,se[a])(t.attrs),s)for(i=s.length,n=0;n<i;n++)r.add(Je._createNode(s[n]));return r}}Je.prototype.nodeType="Node",Je.prototype._attrsAffectingSize=[],Je.prototype.eventListeners={},Je.prototype.on.call(Je.prototype,Ze,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(Qe),this._clearSelfAndDescendantCache(Be))})),Je.prototype.on.call(Je.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache($e)})),Je.prototype.on.call(Je.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(He)})),Je.prototype.on.call(Je.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(Fe)}));const tr=Te.addGetterSetter;tr(Je,"zIndex"),tr(Je,"absolutePosition"),tr(Je,"position"),tr(Je,"x",0,xe()),tr(Je,"y",0,xe()),tr(Je,"globalCompositeOperation","source-over",Se()),tr(Je,"opacity",1,xe()),tr(Je,"name","",Se()),tr(Je,"id","",Se()),tr(Je,"rotation",0,xe()),Te.addComponentsGetterSetter(Je,"scale",["x","y"]),tr(Je,"scaleX",1,xe()),tr(Je,"scaleY",1,xe()),Te.addComponentsGetterSetter(Je,"skew",["x","y"]),tr(Je,"skewX",0,xe()),tr(Je,"skewY",0,xe()),Te.addComponentsGetterSetter(Je,"offset",["x","y"]),tr(Je,"offsetX",0,xe()),tr(Je,"offsetY",0,xe()),tr(Je,"dragDistance",null,xe()),tr(Je,"width",0,xe()),tr(Je,"height",0,xe()),tr(Je,"listening",!0,Ce()),tr(Je,"preventDefault",!0,Ce()),tr(Je,"filters",null,(function(t){return this._filterUpToDate=!1,t})),tr(Je,"visible",!0,Ce()),tr(Je,"transformsEnabled","all",Se()),tr(Je,"size"),tr(Je,"dragBoundFunc"),tr(Je,"draggable",!1,Ce()),Te.backCompat(Je,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class er extends Je{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var r=[];return e.forEach((function(e){t(e)&&r.push(e)})),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.remove()})),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.destroy()})),this.children=[],this._requestDraw(),this}add(...t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}var r=t[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var r=[];return this._descendants((i=>{const n=i._isMatch(t);return n&&r.push(i),!(!n||!e)})),r}_descendants(t){let e=!1;const r=this.getChildren();for(const i of r){if(e=t(i),e)return!0;if(i.hasChildren()&&(e=i._descendants(t),e))return!0}return!1}toObject(){var t=Je.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach((e=>{t.children.push(e.toObject())})),t}isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=Je.prototype.clone.call(this,t);return this.getChildren().forEach((function(t){e.add(t.clone())})),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach((function(r){r.isVisible()&&r.intersects(t)&&e.push(r)})),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach((function(e){e._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach((function(t,e){t.index=e})),this._requestDraw()}drawScene(t,e){var r=this.getLayer(),i=t||r&&r.getCanvas(),n=i&&i.getContext(),a=this._getCanvasCache(),s=a&&a.scene,o=i&&i.isCache;if(!this.isVisible()&&!o)return this;if(s){n.save();var h=this.getAbsoluteTransform(e).getMatrix();n.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(n),n.restore()}else this._drawChildren("drawScene",i,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var r=this.getLayer(),i=t||r&&r.hitCanvas,n=i&&i.getContext(),a=this._getCanvasCache();if(a&&a.hit){n.save();var s=this.getAbsoluteTransform(e).getMatrix();n.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._drawCachedHitCanvas(n),n.restore()}else this._drawChildren("drawHit",i,e);return this}_drawChildren(t,e,r){var i,n=e&&e.getContext(),a=this.clipWidth(),s=this.clipHeight(),o=this.clipFunc(),h=a&&s||o;const l=r===this;if(h){n.save();var c=this.getAbsoluteTransform(r),u=c.getMatrix();if(n.transform(u[0],u[1],u[2],u[3],u[4],u[5]),n.beginPath(),o)o.call(this,n,this);else{var d=this.clipX(),g=this.clipY();n.rect(d,g,a,s)}n.clip(),u=c.copy().invert().getMatrix(),n.transform(u[0],u[1],u[2],u[3],u[4],u[5])}var f=!l&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;f&&(n.save(),n._applyGlobalCompositeOperation(this)),null===(i=this.children)||void 0===i||i.forEach((function(i){i[t](e,r)})),f&&n.restore(),h&&n.restore()}getClientRect(t){var e,r,i,n,a,s,o=(t=t||{}).skipTransform,h=t.relativeTo,l=this;null===(e=this.children)||void 0===e||e.forEach((function(e){if(e.visible()){var s=e.getClientRect({relativeTo:l,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===s.width&&0===s.height||(void 0===r?(r=s.x,i=s.y,n=s.x+s.width,a=s.y+s.height):(r=Math.min(r,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x+s.width),a=Math.max(a,s.y+s.height)))}}));for(var c=this.find("Shape"),u=!1,d=0;d<c.length;d++)if(c[d]._isVisible(this)){u=!0;break}return s=u&&void 0!==r?{x:r,y:i,width:n-r,height:a-i}:{x:0,y:0,width:0,height:0},o?s:this._transformedRect(s,h)}}Te.addComponentsGetterSetter(er,"clip",["x","y","width","height"]),Te.addGetterSetter(er,"clipX",void 0,xe()),Te.addGetterSetter(er,"clipY",void 0,xe()),Te.addGetterSetter(er,"clipWidth",void 0,xe()),Te.addGetterSetter(er,"clipHeight",void 0,xe()),Te.addGetterSetter(er,"clipFunc");const rr=new Map,ir=void 0!==se._global.PointerEvent;function nr(t){return rr.get(t)}function ar(t){return{evt:t,pointerId:t.pointerId}}function sr(t,e){return rr.get(t)===e}function or(t,e){hr(t),e.getStage()&&(rr.set(t,e),ir&&e._fire("gotpointercapture",ar(new PointerEvent("gotpointercapture"))))}function hr(t,e){const r=rr.get(t);if(!r)return;const i=r.getStage();i&&i.content,rr.delete(t),ir&&r._fire("lostpointercapture",ar(new PointerEvent("lostpointercapture")))}var lr="mouseleave",cr="mouseover",ur="mouseenter",dr="mousemove",gr="mousedown",fr="mouseup",pr="pointermove",vr="pointerdown",mr="pointerup",yr="pointercancel",xr="pointerout",br="pointerleave",_r="pointerover",Sr="pointerenter",wr="contextmenu",Cr="touchstart",Pr="touchend",Ar="touchmove",Tr="touchcancel",Or="wheel",kr=[[ur,"_pointerenter"],[gr,"_pointerdown"],[dr,"_pointermove"],[fr,"_pointerup"],[lr,"_pointerleave"],[Cr,"_pointerdown"],[Ar,"_pointermove"],[Pr,"_pointerup"],[Tr,"_pointercancel"],[cr,"_pointerover"],[Or,"_wheel"],[wr,"_contextmenu"],[vr,"_pointerdown"],[pr,"_pointermove"],[mr,"_pointerup"],[yr,"_pointercancel"],["lostpointercapture","_lostpointercapture"]];const Mr={mouse:{[xr]:"mouseout",[br]:lr,[_r]:cr,[Sr]:ur,[pr]:dr,[vr]:gr,[mr]:fr,[yr]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[xr]:"touchout",[br]:"touchleave",[_r]:"touchover",[Sr]:"touchenter",[pr]:Ar,[vr]:Cr,[mr]:Pr,[yr]:Tr,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[xr]:xr,[br]:br,[_r]:_r,[Sr]:Sr,[pr]:pr,[vr]:vr,[mr]:mr,[yr]:yr,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Er=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",Rr=t=>{const e=Er(t);return"pointer"===e?se.pointerEventsEnabled&&Mr.pointer:"touch"===e?Mr.touch:"mouse"===e?Mr.mouse:void 0};function Lr(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&ve.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}const Nr=[];class Ir extends er{constructor(t){super(Lr(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Nr.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(()=>{Lr(this.attrs)})),this._checkVisibility()}_validateAdd(t){const e="Layer"===t.getType(),r="FastLayer"===t.getType();e||r||ve.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if("string"==typeof t){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var r;r="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(r)}if(!t)throw"Can not find container in document with id "+r}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var t,e=this.children,r=e.length;for(t=0;t<r;t++)e[t].clear();return this}clone(t){return t||(t={}),t.container="undefined"!=typeof document&&document.createElement("div"),er.prototype.clone.call(this,t)}destroy(){super.destroy();var t=this.content;t&&ve._isInDocument(t)&&this.container().removeChild(t);var e=Nr.indexOf(this);return e>-1&&Nr.splice(e,1),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(ve.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(t){return this._pointerPositions.find((e=>e.id===t))}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){(t=t||{}).x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();var e=new Ie({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),r=e.getContext()._context,i=this.children;return(t.x||t.y)&&r.translate(-1*t.x,-1*t.y),i.forEach((function(e){if(e.isVisible()){var i=e._toKonvaCanvas(t);r.drawImage(i._canvas,t.x,t.y,i.getWidth()/i.getPixelRatio(),i.getHeight()/i.getPixelRatio())}})),e}getIntersection(t){if(!t)return null;var e,r=this.children;for(e=r.length-1;e>=0;e--){const i=r[e].getIntersection(t);if(i)return i}return null}_resizeDOM(){var t=this.width(),e=this.height();this.content&&(this.content.style.width=t+"px",this.content.style.height=e+"px"),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach((r=>{r.setSize({width:t,height:e}),r.draw()}))}add(t,...e){if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);var i=this.children.length;return i>5&&ve.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),se.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return sr(t,this)}setPointerCapture(t){or(t,this)}releaseCapture(t){hr(t)}getLayers(){return this.children}_bindContentEvents(){se.isBrowser&&kr.forEach((([t,e])=>{this.content.addEventListener(t,(t=>{this[e](t)}))}))}_pointerenter(t){this.setPointersPositions(t);const e=Rr(t.type);this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=Rr(t.type);this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=Rr(t.type),r=Er(t.type);if(e){this.setPointersPositions(t);var i=this._getTargetShape(r),n=!Ge.isDragging||se.hitOnDragEnabled;i&&n?(i._fireAndBubble(e.pointerout,{evt:t}),i._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[r+"targetShape"]=null):n&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(t){const e=Rr(t.type),r=Er(t.type);if(e){this.setPointersPositions(t);var i=!1;this._changedPointerPositions.forEach((n=>{var a=this.getIntersection(n);if(Ge.justDragged=!1,se["_"+r+"ListenClick"]=!0,!a||!a.isListening())return;se.capturePointerEventsEnabled&&a.setPointerCapture(n.id),this[r+"ClickStartShape"]=a,a._fireAndBubble(e.pointerdown,{evt:t,pointerId:n.id}),i=!0;const s=t.type.indexOf("touch")>=0;a.preventDefault()&&t.cancelable&&s&&t.preventDefault()})),i||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(t){const e=Rr(t.type),r=Er(t.type);if(!e)return;if(Ge.isDragging&&Ge.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),Ge.isDragging&&!se.hitOnDragEnabled)return;var i={};let n=!1;var a=this._getTargetShape(r);this._changedPointerPositions.forEach((s=>{const o=nr(s.id)||this.getIntersection(s),h=s.id,l={evt:t,pointerId:h};var c=a!==o;if(c&&a&&(a._fireAndBubble(e.pointerout,Object.assign({},l),o),a._fireAndBubble(e.pointerleave,Object.assign({},l),o)),o){if(i[o._id])return;i[o._id]=!0}o&&o.isListening()?(n=!0,c&&(o._fireAndBubble(e.pointerover,Object.assign({},l),a),o._fireAndBubble(e.pointerenter,Object.assign({},l),a),this[r+"targetShape"]=o),o._fireAndBubble(e.pointermove,Object.assign({},l))):a&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:h}),this[r+"targetShape"]=null)})),n||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=Rr(t.type),r=Er(t.type);if(!e)return;this.setPointersPositions(t);const i=this[r+"ClickStartShape"],n=this[r+"ClickEndShape"];var a={};let s=!1;this._changedPointerPositions.forEach((o=>{const h=nr(o.id)||this.getIntersection(o);if(h){if(h.releaseCapture(o.id),a[h._id])return;a[h._id]=!0}const l=o.id,c={evt:t,pointerId:l};let u=!1;se["_"+r+"InDblClickWindow"]&&se["_"+r+"InDblClickWindowId"]===l?(u=!0,clearTimeout(this[r+"DblTimeout"])):Ge.justDragged||(se["_"+r+"InDblClickWindow"]=!0,se["_"+r+"InDblClickWindowId"]=l,clearTimeout(this[r+"DblTimeout"])),this[r+"DblTimeout"]=setTimeout((function(){se["_"+r+"InDblClickWindow"]=!1}),se.dblClickWindow),h&&h.isListening()?(s=!0,this[r+"ClickEndShape"]=h,h._fireAndBubble(e.pointerup,Object.assign({},c)),se["_"+r+"ListenClick"]&&i&&i===h&&(h._fireAndBubble(e.pointerclick,Object.assign({},c)),u&&n&&n===h&&h._fireAndBubble(e.pointerdblclick,Object.assign({},c)))):(this[r+"ClickEndShape"]=null,se["_"+r+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:l}),u&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:l}))})),s||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),se["_"+r+"ListenClick"]=!1,t.cancelable&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(wr,{evt:t}):this._fire(wr,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(Or,{evt:t}):this._fire(Or,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=nr(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(mr,ar(t)),hr(t.pointerId)}_lostpointercapture(t){hr(t.pointerId)}setPointersPositions(t){var e=this._getContentPosition(),r=null,i=null;void 0!==(t=t||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,(t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})),Array.prototype.forEach.call(t.changedTouches||t.touches,(t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}))):(r=(t.clientX-e.left)/e.scaleX,i=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:r,y:i},this._pointerPositions=[{x:r,y:i,id:ve._getFirstPointerId(t)}],this._changedPointerPositions=[{x:r,y:i,id:ve._getFirstPointerId(t)}])}_setPointerPosition(t){ve.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Ie({width:this.width(),height:this.height()}),this.bufferHitCanvas=new De({pixelRatio:1,width:this.width(),height:this.height()}),se.isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}}cache(){return ve.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(t){t.batchDraw()})),this}}Ir.prototype.nodeType="Stage",oe(Ir),Te.addGetterSetter(Ir,"container");var Dr="hasShadow",Gr="shadowRGBA",Fr="patternImage",Vr="linearGradient",Br="radialGradient";let zr;function jr(){return zr||(zr=ve.createCanvasElement().getContext("2d"),zr)}const Hr={};class Wr extends Je{constructor(t){let e;for(super(t);e=ve.getRandomColor(),!e||e in Hr;);this.colorKey=e,Hr[e]=this}getContext(){return ve.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return ve.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Dr,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Fr,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const t=jr().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){const e=new he;e.translate(this.fillPatternX(),this.fillPatternY()),e.rotate(se.getAngle(this.fillPatternRotation())),e.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),e.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=e.getMatrix();t.setTransform({a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]})}return t}}_getLinearGradient(){return this._getCache(Vr,this.__getLinearGradient)}__getLinearGradient(){var t=this.fillLinearGradientColorStops();if(t){for(var e=jr(),r=this.fillLinearGradientStartPoint(),i=this.fillLinearGradientEndPoint(),n=e.createLinearGradient(r.x,r.y,i.x,i.y),a=0;a<t.length;a+=2)n.addColorStop(t[a],t[a+1]);return n}}_getRadialGradient(){return this._getCache(Br,this.__getRadialGradient)}__getRadialGradient(){var t=this.fillRadialGradientColorStops();if(t){for(var e=jr(),r=this.fillRadialGradientStartPoint(),i=this.fillRadialGradientEndPoint(),n=e.createRadialGradient(r.x,r.y,this.fillRadialGradientStartRadius(),i.x,i.y,this.fillRadialGradientEndRadius()),a=0;a<t.length;a+=2)n.addColorStop(t[a],t[a+1]);return n}}getShadowRGBA(){return this._getCache(Gr,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var t=ve.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())))}hasHitStroke(){const t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){var e=this.getStage().bufferHitCanvas;return e.getContext().clear(),this.drawHit(e,null,!0),e.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Je.prototype.destroy.call(this),delete Hr[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!this.getStage())return!1;if(null!==(e=this.attrs.perfectDrawEnabled)&&void 0!==e&&!e)return!1;const r=t||this.hasFill(),i=this.hasStroke(),n=1!==this.getAbsoluteOpacity();if(r&&i&&n)return!0;const a=this.hasShadow(),s=this.shadowForStrokeEnabled();return!!(r&&i&&a&&s)}setStrokeHitEnabled(t){ve.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){const e=t.skipTransform,r=t.relativeTo,i=this.getSelfRect(),n=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,a=i.width+n,s=i.height+n,o=!t.skipShadow&&this.hasShadow(),h=o?this.shadowOffsetX():0,l=o?this.shadowOffsetY():0,c=a+Math.abs(h),u=s+Math.abs(l),d=o&&this.shadowBlur()||0,g=c+2*d,f=u+2*d;let p=0;Math.round(n/2)!==n/2&&(p=1);const v={width:g+p,height:f+p,x:-Math.round(n/2+d)+Math.min(h,0)+i.x,y:-Math.round(n/2+d)+Math.min(l,0)+i.y};return e?v:this._transformedRect(v,r)}drawScene(t,e){var r,i,n=this.getLayer(),a=t||n.getCanvas(),s=a.getContext(),o=this._getCanvasCache(),h=this.getSceneFunc(),l=this.hasShadow(),c=a.isCache,u=e===this;if(!this.isVisible()&&!u)return this;if(o){s.save();var d=this.getAbsoluteTransform(e).getMatrix();return s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!h)return this;if(s.save(),this._useBufferCanvas()&&!c){(i=(r=this.getStage().bufferCanvas).getContext()).clear(),i.save(),i._applyLineJoin(this);var g=this.getAbsoluteTransform(e).getMatrix();i.transform(g[0],g[1],g[2],g[3],g[4],g[5]),h.call(this,i,this),i.restore();var f=r.pixelRatio;l&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(r._canvas,0,0,r.width/f,r.height/f)}else s._applyLineJoin(this),u||(g=this.getAbsoluteTransform(e).getMatrix(),s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)),l&&s._applyShadow(this),h.call(this,s,this);return s.restore(),this}drawHit(t,e,r=!1){if(!this.shouldDrawHit(e,r))return this;var i=this.getLayer(),n=t||i.hitCanvas,a=n&&n.getContext(),s=this.hitFunc()||this.sceneFunc(),o=this._getCanvasCache(),h=o&&o.hit;if(this.colorKey||ve.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),h){a.save();var l=this.getAbsoluteTransform(e).getMatrix();return a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!s)return this;if(a.save(),a._applyLineJoin(this),this!==e){var c=this.getAbsoluteTransform(e).getMatrix();a.transform(c[0],c[1],c[2],c[3],c[4],c[5])}return s.call(this,a,this),a.restore(),this}drawHitFromCache(t=0){var e,r,i,n,a,s=this._getCanvasCache(),o=this._getCachedSceneCanvas(),h=s.hit,l=h.getContext(),c=h.getWidth(),u=h.getHeight();l.clear(),l.drawImage(o._canvas,0,0,c,u);try{for(i=(r=(e=l.getImageData(0,0,c,u)).data).length,n=ve._hexToRgb(this.colorKey),a=0;a<i;a+=4)r[a+3]>t?(r[a]=n.r,r[a+1]=n.g,r[a+2]=n.b,r[a+3]=255):r[a+3]=0;l.putImageData(e,0,0)}catch(t){ve.error("Unable to draw hit graph from cached scene canvas. "+t.message)}return this}hasPointerCapture(t){return sr(t,this)}setPointerCapture(t){or(t,this)}releaseCapture(t){hr(t)}}Wr.prototype._fillFunc=function(t){t.fill()},Wr.prototype._strokeFunc=function(t){t.stroke()},Wr.prototype._fillFuncHit=function(t){t.fill()},Wr.prototype._strokeFuncHit=function(t){t.stroke()},Wr.prototype._centroid=!1,Wr.prototype.nodeType="Shape",oe(Wr),Wr.prototype.eventListeners={},Wr.prototype.on.call(Wr.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(Dr)})),Wr.prototype.on.call(Wr.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(Gr)})),Wr.prototype.on.call(Wr.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",(function(){this._clearCache(Fr)})),Wr.prototype.on.call(Wr.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",(function(){this._clearCache(Vr)})),Wr.prototype.on.call(Wr.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",(function(){this._clearCache(Br)})),Te.addGetterSetter(Wr,"stroke",void 0,we()),Te.addGetterSetter(Wr,"strokeWidth",2,xe()),Te.addGetterSetter(Wr,"fillAfterStrokeEnabled",!1),Te.addGetterSetter(Wr,"hitStrokeWidth","auto",_e()),Te.addGetterSetter(Wr,"strokeHitEnabled",!0,Ce()),Te.addGetterSetter(Wr,"perfectDrawEnabled",!0,Ce()),Te.addGetterSetter(Wr,"shadowForStrokeEnabled",!0,Ce()),Te.addGetterSetter(Wr,"lineJoin"),Te.addGetterSetter(Wr,"lineCap"),Te.addGetterSetter(Wr,"sceneFunc"),Te.addGetterSetter(Wr,"hitFunc"),Te.addGetterSetter(Wr,"dash"),Te.addGetterSetter(Wr,"dashOffset",0,xe()),Te.addGetterSetter(Wr,"shadowColor",void 0,Se()),Te.addGetterSetter(Wr,"shadowBlur",0,xe()),Te.addGetterSetter(Wr,"shadowOpacity",1,xe()),Te.addComponentsGetterSetter(Wr,"shadowOffset",["x","y"]),Te.addGetterSetter(Wr,"shadowOffsetX",0,xe()),Te.addGetterSetter(Wr,"shadowOffsetY",0,xe()),Te.addGetterSetter(Wr,"fillPatternImage"),Te.addGetterSetter(Wr,"fill",void 0,we()),Te.addGetterSetter(Wr,"fillPatternX",0,xe()),Te.addGetterSetter(Wr,"fillPatternY",0,xe()),Te.addGetterSetter(Wr,"fillLinearGradientColorStops"),Te.addGetterSetter(Wr,"strokeLinearGradientColorStops"),Te.addGetterSetter(Wr,"fillRadialGradientStartRadius",0),Te.addGetterSetter(Wr,"fillRadialGradientEndRadius",0),Te.addGetterSetter(Wr,"fillRadialGradientColorStops"),Te.addGetterSetter(Wr,"fillPatternRepeat","repeat"),Te.addGetterSetter(Wr,"fillEnabled",!0),Te.addGetterSetter(Wr,"strokeEnabled",!0),Te.addGetterSetter(Wr,"shadowEnabled",!0),Te.addGetterSetter(Wr,"dashEnabled",!0),Te.addGetterSetter(Wr,"strokeScaleEnabled",!0),Te.addGetterSetter(Wr,"fillPriority","color"),Te.addComponentsGetterSetter(Wr,"fillPatternOffset",["x","y"]),Te.addGetterSetter(Wr,"fillPatternOffsetX",0,xe()),Te.addGetterSetter(Wr,"fillPatternOffsetY",0,xe()),Te.addComponentsGetterSetter(Wr,"fillPatternScale",["x","y"]),Te.addGetterSetter(Wr,"fillPatternScaleX",1,xe()),Te.addGetterSetter(Wr,"fillPatternScaleY",1,xe()),Te.addComponentsGetterSetter(Wr,"fillLinearGradientStartPoint",["x","y"]),Te.addComponentsGetterSetter(Wr,"strokeLinearGradientStartPoint",["x","y"]),Te.addGetterSetter(Wr,"fillLinearGradientStartPointX",0),Te.addGetterSetter(Wr,"strokeLinearGradientStartPointX",0),Te.addGetterSetter(Wr,"fillLinearGradientStartPointY",0),Te.addGetterSetter(Wr,"strokeLinearGradientStartPointY",0),Te.addComponentsGetterSetter(Wr,"fillLinearGradientEndPoint",["x","y"]),Te.addComponentsGetterSetter(Wr,"strokeLinearGradientEndPoint",["x","y"]),Te.addGetterSetter(Wr,"fillLinearGradientEndPointX",0),Te.addGetterSetter(Wr,"strokeLinearGradientEndPointX",0),Te.addGetterSetter(Wr,"fillLinearGradientEndPointY",0),Te.addGetterSetter(Wr,"strokeLinearGradientEndPointY",0),Te.addComponentsGetterSetter(Wr,"fillRadialGradientStartPoint",["x","y"]),Te.addGetterSetter(Wr,"fillRadialGradientStartPointX",0),Te.addGetterSetter(Wr,"fillRadialGradientStartPointY",0),Te.addComponentsGetterSetter(Wr,"fillRadialGradientEndPoint",["x","y"]),Te.addGetterSetter(Wr,"fillRadialGradientEndPointX",0),Te.addGetterSetter(Wr,"fillRadialGradientEndPointY",0),Te.addGetterSetter(Wr,"fillPatternRotation",0),Te.backCompat(Wr,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var Ur=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Yr=Ur.length;class Xr extends er{constructor(t){super(t),this.canvas=new Ie,this.hitCanvas=new De({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Je.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Je.prototype.moveUp.call(this))return!1;var t=this.getStage();return!(!t||!t.content||(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),0))}moveDown(){if(Je.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Je.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Je.prototype.remove.call(this),t&&t.parentNode&&ve._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&ve.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return(t=t||{}).width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),Je.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){const t=this.visible();this.canvas._canvas.style.display=t?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){ve.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){ve.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,ve.requestAnimFrame((()=>{this.draw(),this._waitingForDraw=!1}))),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,r=!1;;){for(let i=0;i<Yr;i++){const n=Ur[i],a=this._getIntersection({x:t.x+n.x*e,y:t.y+n.y*e}),s=a.shape;if(s)return s;if(r=!!a.antialiased,!a.antialiased)break}if(!r)return null;e+=1}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,i=r[3];if(255===i){const t=ve._rgbToHex(r[0],r[1],r[2]),e=Hr["#"+t];return e?{shape:e}:{antialiased:!0}}return i>0?{antialiased:!0}:{}}drawScene(t,e){var r=this.getLayer(),i=t||r&&r.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),er.prototype.drawScene.call(this,i,e),this._fire("draw",{node:this}),this}drawHit(t,e){var r=this.getLayer(),i=t||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),er.prototype.drawHit.call(this,i,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){ve.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return ve.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent.content){var t=this.parent;this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}}Xr.prototype.nodeType="Layer",oe(Xr),Te.addGetterSetter(Xr,"imageSmoothingEnabled",!0),Te.addGetterSetter(Xr,"clearBeforeDraw",!0),Te.addGetterSetter(Xr,"hitGraphEnabled",!0,Ce());class qr extends Xr{constructor(t){super(t),this.listening(!1),ve.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}qr.prototype.nodeType="FastLayer",oe(qr);class Qr extends er{_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&ve.throw("You may only add groups and shapes to groups.")}}Qr.prototype.nodeType="Group",oe(Qr);var $r=ae.performance&&ae.performance.now?function(){return ae.performance.now()}:function(){return(new Date).getTime()};class Zr{constructor(t,e){this.id=Zr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:$r(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){var e;return e=t?t.length>0?t:[t]:[],this.layers=e,this}getLayers(){return this.layers}addLayer(t){var e,r=this.layers,i=r.length;for(e=0;e<i;e++)if(r[e]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){var t,e=Zr.animations,r=e.length;for(t=0;t<r;t++)if(e[t].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=$r(),Zr._addAnimation(this),this}stop(){return Zr._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){var e,r=t.id,i=this.animations,n=i.length;for(e=0;e<n;e++)if(i[e].id===r){this.animations.splice(e,1);break}}static _runFrames(){var t,e,r,i,n,a,s,o,h={},l=this.animations;for(i=0;i<l.length;i++)if(e=(t=l[i]).layers,r=t.func,t._updateFrameObject($r()),a=e.length,!r||!1!==r.call(t,t.frame))for(n=0;n<a;n++)void 0!==(s=e[n])._id&&(h[s._id]=s);for(o in h)h.hasOwnProperty(o)&&h[o].batchDraw()}static _animationLoop(){var t=Zr;t.animations.length?(t._runFrames(),ve.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,ve.requestAnimFrame(this._animationLoop))}}Zr.animations=[],Zr.animIdCounter=0,Zr.animRunning=!1;var Kr={node:1,duration:1,easing:1,onFinish:1,yoyo:1},Jr=0,ti=["fill","stroke","shadowColor"];class ei{constructor(t,e,r,i,n,a,s){this.prop=t,this.propFunc=e,this.begin=i,this._pos=i,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=s,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=r,this._change=n-this.begin,this.pause()}fire(t){var e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)}pause(){this.state=1,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class ri{constructor(t){var e,r,i=this,n=t.node,a=n._id,s=t.easing||ii.Linear,o=!!t.yoyo;e=void 0===t.duration?.3:0===t.duration?.001:t.duration,this.node=n,this._id=Jr++;var h=n.getLayer()||(n instanceof se.Stage?n.getLayers():null);for(r in h||ve.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Zr((function(){i.tween.onEnterFrame()}),h),this.tween=new ei(r,(function(t){i._tweenFunc(t)}),s,0,1,1e3*e,o),this._addListeners(),ri.attrs[a]||(ri.attrs[a]={}),ri.attrs[a][this._id]||(ri.attrs[a][this._id]={}),ri.tweens[a]||(ri.tweens[a]={}),t)void 0===Kr[r]&&this._addAttr(r,t[r]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){var r,i,n,a,s,o,h,l,c=this.node,u=c._id;if((n=ri.tweens[u][t])&&delete ri.attrs[u][n][t],r=c.getAttr(t),ve._isArray(e))if(i=[],s=Math.max(e.length,r.length),"points"===t&&e.length!==r.length&&(e.length>r.length?(h=r,r=ve._prepareArrayForTween(r,e,c.closed())):(o=e,e=ve._prepareArrayForTween(e,r,c.closed()))),0===t.indexOf("fill"))for(a=0;a<s;a++)if(a%2==0)i.push(e[a]-r[a]);else{var d=ve.colorToRGBA(r[a]);l=ve.colorToRGBA(e[a]),r[a]=d,i.push({r:l.r-d.r,g:l.g-d.g,b:l.b-d.b,a:l.a-d.a})}else for(a=0;a<s;a++)i.push(e[a]-r[a]);else-1!==ti.indexOf(t)?(r=ve.colorToRGBA(r),i={r:(l=ve.colorToRGBA(e)).r-r.r,g:l.g-r.g,b:l.b-r.b,a:l.a-r.a}):i=e-r;ri.attrs[u][this._id][t]={start:r,diff:i,end:e,trueEnd:o,trueStart:h},ri.tweens[u][t]=this._id}_tweenFunc(t){var e,r,i,n,a,s,o,h,l=this.node,c=ri.attrs[l._id][this._id];for(e in c){if(i=(r=c[e]).start,n=r.diff,h=r.end,ve._isArray(i))if(a=[],o=Math.max(i.length,h.length),0===e.indexOf("fill"))for(s=0;s<o;s++)s%2==0?a.push((i[s]||0)+n[s]*t):a.push("rgba("+Math.round(i[s].r+n[s].r*t)+","+Math.round(i[s].g+n[s].g*t)+","+Math.round(i[s].b+n[s].b*t)+","+(i[s].a+n[s].a*t)+")");else for(s=0;s<o;s++)a.push((i[s]||0)+n[s]*t);else a=-1!==ti.indexOf(e)?"rgba("+Math.round(i.r+n.r*t)+","+Math.round(i.g+n.g*t)+","+Math.round(i.b+n.b*t)+","+(i.a+n.a*t)+")":i+n*t;l.setAttr(e,a)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var t=this.node,e=ri.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var t=this.node,e=ri.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var t,e=this.node._id,r=this._id,i=ri.tweens[e];for(t in this.pause(),i)delete ri.tweens[e][t];delete ri.attrs[e][r]}}ri.attrs={},ri.tweens={},Je.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new ri(t).play()};const ii={BackEaseIn(t,e,r,i){var n=1.70158;return r*(t/=i)*t*((n+1)*t-n)+e},BackEaseOut(t,e,r,i){var n=1.70158;return r*((t=t/i-1)*t*((n+1)*t+n)+1)+e},BackEaseInOut(t,e,r,i){var n=1.70158;return(t/=i/2)<1?r/2*(t*t*((1+(n*=1.525))*t-n))+e:r/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e},ElasticEaseIn(t,e,r,i,n,a){var s=0;return 0===t?e:1==(t/=i)?e+r:(a||(a=.3*i),!n||n<Math.abs(r)?(n=r,s=a/4):s=a/(2*Math.PI)*Math.asin(r/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*(2*Math.PI)/a)+e)},ElasticEaseOut(t,e,r,i,n,a){var s=0;return 0===t?e:1==(t/=i)?e+r:(a||(a=.3*i),!n||n<Math.abs(r)?(n=r,s=a/4):s=a/(2*Math.PI)*Math.asin(r/n),n*Math.pow(2,-10*t)*Math.sin((t*i-s)*(2*Math.PI)/a)+r+e)},ElasticEaseInOut(t,e,r,i,n,a){var s=0;return 0===t?e:2==(t/=i/2)?e+r:(a||(a=i*(.3*1.5)),!n||n<Math.abs(r)?(n=r,s=a/4):s=a/(2*Math.PI)*Math.asin(r/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*(2*Math.PI)/a)*-.5+e:n*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*(2*Math.PI)/a)*.5+r+e)},BounceEaseOut:(t,e,r,i)=>(t/=i)<1/2.75?r*(7.5625*t*t)+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e,BounceEaseIn:(t,e,r,i)=>r-ii.BounceEaseOut(i-t,0,r,i)+e,BounceEaseInOut:(t,e,r,i)=>t<i/2?.5*ii.BounceEaseIn(2*t,0,r,i)+e:.5*ii.BounceEaseOut(2*t-i,0,r,i)+.5*r+e,EaseIn:(t,e,r,i)=>r*(t/=i)*t+e,EaseOut:(t,e,r,i)=>-r*(t/=i)*(t-2)+e,EaseInOut:(t,e,r,i)=>(t/=i/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e,StrongEaseIn:(t,e,r,i)=>r*(t/=i)*t*t*t*t+e,StrongEaseOut:(t,e,r,i)=>r*((t=t/i-1)*t*t*t*t+1)+e,StrongEaseInOut:(t,e,r,i)=>(t/=i/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e,Linear:(t,e,r,i)=>r*t/i+e},ni=ve._assign(se,{Util:ve,Transform:he,Node:Je,Container:er,Stage:Ir,stages:Nr,Layer:Xr,FastLayer:qr,Group:Qr,DD:Ge,Shape:Wr,shapes:Hr,Animation:Zr,Tween:ri,Easings:ii,Context:Ee,Canvas:Ne});class ai extends Wr{_sceneFunc(t){var e=se.getAngle(this.angle()),r=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,r),t.arc(0,0,this.innerRadius(),e,0,!r),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}function si(t,e,r,i,n,a,s){var o=Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2)),h=Math.sqrt(Math.pow(n-r,2)+Math.pow(a-i,2)),l=s*o/(o+h),c=s*h/(o+h);return[r-l*(n-t),i-l*(a-e),r+c*(n-t),i+c*(a-e)]}function oi(t,e){var r,i,n=t.length,a=[];for(r=2;r<n-2;r+=2)i=si(t[r-2],t[r-1],t[r],t[r+1],t[r+2],t[r+3],e),isNaN(i[0])||(a.push(i[0]),a.push(i[1]),a.push(t[r]),a.push(t[r+1]),a.push(i[2]),a.push(i[3]));return a}ai.prototype._centroid=!0,ai.prototype.className="Arc",ai.prototype._attrsAffectingSize=["innerRadius","outerRadius"],oe(ai),Te.addGetterSetter(ai,"innerRadius",0,xe()),Te.addGetterSetter(ai,"outerRadius",0,xe()),Te.addGetterSetter(ai,"angle",0,xe()),Te.addGetterSetter(ai,"clockwise",!1,Ce());class hi extends Wr{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(t){var e,r,i,n=this.points(),a=n.length,s=this.tension(),o=this.closed(),h=this.bezier();if(a){if(t.beginPath(),t.moveTo(n[0],n[1]),0!==s&&a>4){for(r=(e=this.getTensionPoints()).length,i=o?0:4,o||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);i<r-2;)t.bezierCurveTo(e[i++],e[i++],e[i++],e[i++],e[i++],e[i++]);o||t.quadraticCurveTo(e[r-2],e[r-1],n[a-2],n[a-1])}else if(h)for(i=2;i<a;)t.bezierCurveTo(n[i++],n[i++],n[i++],n[i++],n[i++],n[i++]);else for(i=2;i<a;i+=2)t.lineTo(n[i],n[i+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():oi(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,r=this.tension(),i=si(t[e-2],t[e-1],t[0],t[1],t[2],t[3],r),n=si(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],r),a=oi(t,r);return[i[2],i[3]].concat(a).concat([n[0],n[1],t[e-2],t[e-1],n[2],n[3],i[0],i[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};for(var e,r,i=(t=0!==this.tension()?[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.points())[0],n=t[0],a=t[1],s=t[1],o=0;o<t.length/2;o++)e=t[2*o],r=t[2*o+1],i=Math.min(i,e),n=Math.max(n,e),a=Math.min(a,r),s=Math.max(s,r);return{x:i,y:a,width:n-i,height:s-a}}}hi.prototype.className="Line",hi.prototype._attrsAffectingSize=["points","bezier","tension"],oe(hi),Te.addGetterSetter(hi,"closed",!1),Te.addGetterSetter(hi,"bezier",!1),Te.addGetterSetter(hi,"tension",0,xe()),Te.addGetterSetter(hi,"points",[],function(){if(se.isUnminified)return function(t,e){return ve._isArray(t)?t.forEach((function(t){ve._isNumber(t)||ve.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):ve.warn(me(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}}());class li extends Wr{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this.dataArray=li.parsePathData(this.data()),this.pathLength=0;for(var e=0;e<this.dataArray.length;++e)this.pathLength+=this.dataArray[e].pathLength;this.on("dataChange.konva",(function(){this.dataArray=li.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength}))}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var r=!1,i=0;i<e.length;i++){var n=e[i].command,a=e[i].points;switch(n){case"L":t.lineTo(a[0],a[1]);break;case"M":t.moveTo(a[0],a[1]);break;case"C":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var s=a[0],o=a[1],h=a[2],l=a[3],c=a[4],u=a[5],d=a[6],g=a[7],f=h>l?h:l,p=h>l?1:h/l,v=h>l?l/h:1;t.translate(s,o),t.rotate(d),t.scale(p,v),t.arc(0,0,f,c,c+u,1-g),t.scale(1/p,1/v),t.rotate(-d),t.translate(-s,-o);break;case"z":r=!0,t.closePath()}}r||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach((function(e){if("A"===e.command){var r=e.points[4],i=e.points[5],n=e.points[4]+i,a=Math.PI/180;if(Math.abs(r-n)<a&&(a=Math.abs(r-n)),i<0)for(let i=r-a;i>n;i-=a){const r=li.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],i,0);t.push(r.x,r.y)}else for(let i=r+a;i<n;i+=a){const r=li.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],i,0);t.push(r.x,r.y)}}else if("C"===e.command)for(let r=0;r<=1;r+=.01){const i=li.getPointOnCubicBezier(r,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(i.x,i.y)}else t=t.concat(e.points)}));for(var e,r,i=t[0],n=t[0],a=t[1],s=t[1],o=0;o<t.length/2;o++)e=t[2*o],r=t[2*o+1],isNaN(e)||(i=Math.min(i,e),n=Math.max(n,e)),isNaN(r)||(a=Math.min(a,r),s=Math.max(s,r));return{x:Math.round(i),y:Math.round(a),width:Math.round(n-i),height:Math.round(s-a)}}getLength(){return this.pathLength}getPointAtLength(t){var e,r=0,i=this.dataArray.length;if(!i)return null;for(;r<i&&t>this.dataArray[r].pathLength;)t-=this.dataArray[r].pathLength,++r;if(r===i)return{x:(e=this.dataArray[r-1].points.slice(-2))[0],y:e[1]};if(t<.01)return{x:(e=this.dataArray[r].points.slice(0,2))[0],y:e[1]};var n=this.dataArray[r],a=n.points;switch(n.command){case"L":return li.getPointOnLine(t,n.start.x,n.start.y,a[0],a[1]);case"C":return li.getPointOnCubicBezier(t/n.pathLength,n.start.x,n.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return li.getPointOnQuadraticBezier(t/n.pathLength,n.start.x,n.start.y,a[0],a[1],a[2],a[3]);case"A":var s=a[0],o=a[1],h=a[2],l=a[3],c=a[4],u=a[5],d=a[6];return c+=u*t/n.pathLength,li.getPointOnEllipticalArc(s,o,h,l,c,d)}return null}static getLineLength(t,e,r,i){return Math.sqrt((r-t)*(r-t)+(i-e)*(i-e))}static getPointOnLine(t,e,r,i,n,a,s){void 0===a&&(a=e),void 0===s&&(s=r);var o=(n-r)/(i-e+1e-8),h=Math.sqrt(t*t/(1+o*o));i<e&&(h*=-1);var l,c=o*h;if(i===e)l={x:a,y:s+c};else if((s-r)/(a-e+1e-8)===o)l={x:a+h,y:s+c};else{var u,d,g=this.getLineLength(e,r,i,n),f=(a-e)*(i-e)+(s-r)*(n-r);u=e+(f/=g*g)*(i-e),d=r+f*(n-r);var p=this.getLineLength(a,s,u,d),v=Math.sqrt(t*t-p*p);h=Math.sqrt(v*v/(1+o*o)),i<e&&(h*=-1),l={x:u+h,y:d+(c=o*h)}}return l}static getPointOnCubicBezier(t,e,r,i,n,a,s,o,h){function l(t){return t*t*t}function c(t){return 3*t*t*(1-t)}function u(t){return 3*t*(1-t)*(1-t)}function d(t){return(1-t)*(1-t)*(1-t)}return{x:o*l(t)+a*c(t)+i*u(t)+e*d(t),y:h*l(t)+s*c(t)+n*u(t)+r*d(t)}}static getPointOnQuadraticBezier(t,e,r,i,n,a,s){function o(t){return t*t}function h(t){return 2*t*(1-t)}function l(t){return(1-t)*(1-t)}return{x:a*o(t)+i*h(t)+e*l(t),y:s*o(t)+n*h(t)+r*l(t)}}static getPointOnEllipticalArc(t,e,r,i,n,a){var s=Math.cos(a),o=Math.sin(a),h=r*Math.cos(n),l=i*Math.sin(n);return{x:t+(h*s-l*o),y:e+(h*o+l*s)}}static parsePathData(t){if(!t)return[];var e=t,r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var i=0;i<r.length;i++)e=e.replace(new RegExp(r[i],"g"),"|"+r[i]);var n,a=e.split("|"),s=[],o=[],h=0,l=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(i=1;i<a.length;i++){var u=a[i],d=u.charAt(0);for(u=u.slice(1),o.length=0;n=c.exec(u);)o.push(n[0]);for(var g=[],f=0,p=o.length;f<p;f++)if("00"!==o[f]){var v=parseFloat(o[f]);isNaN(v)?g.push(0):g.push(v)}else g.push(0,0);for(;g.length>0&&!isNaN(g[0]);){var m,y,x,b,_,S,w,C,P,A,T=null,O=[],k=h,M=l;switch(d){case"l":h+=g.shift(),l+=g.shift(),T="L",O.push(h,l);break;case"L":h=g.shift(),l=g.shift(),O.push(h,l);break;case"m":var E=g.shift(),R=g.shift();if(h+=E,l+=R,T="M",s.length>2&&"z"===s[s.length-1].command)for(var L=s.length-2;L>=0;L--)if("M"===s[L].command){h=s[L].points[0]+E,l=s[L].points[1]+R;break}O.push(h,l),d="l";break;case"M":h=g.shift(),l=g.shift(),T="M",O.push(h,l),d="L";break;case"h":h+=g.shift(),T="L",O.push(h,l);break;case"H":h=g.shift(),T="L",O.push(h,l);break;case"v":l+=g.shift(),T="L",O.push(h,l);break;case"V":l=g.shift(),T="L",O.push(h,l);break;case"C":O.push(g.shift(),g.shift(),g.shift(),g.shift()),h=g.shift(),l=g.shift(),O.push(h,l);break;case"c":O.push(h+g.shift(),l+g.shift(),h+g.shift(),l+g.shift()),h+=g.shift(),l+=g.shift(),T="C",O.push(h,l);break;case"S":y=h,x=l,"C"===(m=s[s.length-1]).command&&(y=h+(h-m.points[2]),x=l+(l-m.points[3])),O.push(y,x,g.shift(),g.shift()),h=g.shift(),l=g.shift(),T="C",O.push(h,l);break;case"s":y=h,x=l,"C"===(m=s[s.length-1]).command&&(y=h+(h-m.points[2]),x=l+(l-m.points[3])),O.push(y,x,h+g.shift(),l+g.shift()),h+=g.shift(),l+=g.shift(),T="C",O.push(h,l);break;case"Q":O.push(g.shift(),g.shift()),h=g.shift(),l=g.shift(),O.push(h,l);break;case"q":O.push(h+g.shift(),l+g.shift()),h+=g.shift(),l+=g.shift(),T="Q",O.push(h,l);break;case"T":y=h,x=l,"Q"===(m=s[s.length-1]).command&&(y=h+(h-m.points[0]),x=l+(l-m.points[1])),h=g.shift(),l=g.shift(),T="Q",O.push(y,x,h,l);break;case"t":y=h,x=l,"Q"===(m=s[s.length-1]).command&&(y=h+(h-m.points[0]),x=l+(l-m.points[1])),h+=g.shift(),l+=g.shift(),T="Q",O.push(y,x,h,l);break;case"A":b=g.shift(),_=g.shift(),S=g.shift(),w=g.shift(),C=g.shift(),P=h,A=l,h=g.shift(),l=g.shift(),T="A",O=this.convertEndpointToCenterParameterization(P,A,h,l,w,C,b,_,S);break;case"a":b=g.shift(),_=g.shift(),S=g.shift(),w=g.shift(),C=g.shift(),P=h,A=l,h+=g.shift(),l+=g.shift(),T="A",O=this.convertEndpointToCenterParameterization(P,A,h,l,w,C,b,_,S)}s.push({command:T||d,points:O,start:{x:k,y:M},pathLength:this.calcLength(k,M,T||d,O)})}"z"!==d&&"Z"!==d||s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(t,e,r,i){var n,a,s,o,h=li;switch(r){case"L":return h.getLineLength(t,e,i[0],i[1]);case"C":for(n=0,a=h.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),o=.01;o<=1;o+=.01)s=h.getPointOnCubicBezier(o,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),n+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;return n;case"Q":for(n=0,a=h.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),o=.01;o<=1;o+=.01)s=h.getPointOnQuadraticBezier(o,t,e,i[0],i[1],i[2],i[3]),n+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;return n;case"A":n=0;var l=i[4],c=i[5],u=i[4]+c,d=Math.PI/180;if(Math.abs(l-u)<d&&(d=Math.abs(l-u)),a=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),c<0)for(o=l-d;o>u;o-=d)s=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],o,0),n+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;else for(o=l+d;o<u;o+=d)s=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],o,0),n+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;return s=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),n+h.getLineLength(a.x,a.y,s.x,s.y)}return 0}static convertEndpointToCenterParameterization(t,e,r,i,n,a,s,o,h){var l=h*(Math.PI/180),c=Math.cos(l)*(t-r)/2+Math.sin(l)*(e-i)/2,u=-1*Math.sin(l)*(t-r)/2+Math.cos(l)*(e-i)/2,d=c*c/(s*s)+u*u/(o*o);d>1&&(s*=Math.sqrt(d),o*=Math.sqrt(d));var g=Math.sqrt((s*s*(o*o)-s*s*(u*u)-o*o*(c*c))/(s*s*(u*u)+o*o*(c*c)));n===a&&(g*=-1),isNaN(g)&&(g=0);var f=g*s*u/o,p=g*-o*c/s,v=(t+r)/2+Math.cos(l)*f-Math.sin(l)*p,m=(e+i)/2+Math.sin(l)*f+Math.cos(l)*p,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},x=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},b=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(x(t,e))},_=b([1,0],[(c-f)/s,(u-p)/o]),S=[(c-f)/s,(u-p)/o],w=[(-1*c-f)/s,(-1*u-p)/o],C=b(S,w);return x(S,w)<=-1&&(C=Math.PI),x(S,w)>=1&&(C=0),0===a&&C>0&&(C-=2*Math.PI),1===a&&C<0&&(C+=2*Math.PI),[v,m,s,o,_,C,l,a]}}li.prototype.className="Path",li.prototype._attrsAffectingSize=["data"],oe(li),Te.addGetterSetter(li,"data");class ci extends hi{_sceneFunc(t){super._sceneFunc(t);var e=2*Math.PI,r=this.points(),i=r,n=0!==this.tension()&&r.length>4;n&&(i=this.getTensionPoints());var a,s,o=this.pointerLength(),h=r.length;if(n){const t=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[h-2],r[h-1]],e=li.calcLength(i[i.length-4],i[i.length-3],"C",t),n=li.getPointOnQuadraticBezier(Math.min(1,1-o/e),t[0],t[1],t[2],t[3],t[4],t[5]);a=r[h-2]-n.x,s=r[h-1]-n.y}else a=r[h-2]-r[h-4],s=r[h-1]-r[h-3];var l=(Math.atan2(s,a)+e)%e,c=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(r[h-2],r[h-1]),t.rotate(l),t.moveTo(0,0),t.lineTo(-o,c/2),t.lineTo(-o,-c/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(r[0],r[1]),n?(a=(i[0]+i[2])/2-r[0],s=(i[1]+i[3])/2-r[1]):(a=r[2]-r[0],s=r[3]-r[1]),t.rotate((Math.atan2(-s,-a)+e)%e),t.moveTo(0,0),t.lineTo(-o,c/2),t.lineTo(-o,-c/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}ci.prototype.className="Arrow",oe(ci),Te.addGetterSetter(ci,"pointerLength",10,xe()),Te.addGetterSetter(ci,"pointerWidth",10,xe()),Te.addGetterSetter(ci,"pointerAtBeginning",!1),Te.addGetterSetter(ci,"pointerAtEnding",!0);class ui extends Wr{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}ui.prototype._centroid=!0,ui.prototype.className="Circle",ui.prototype._attrsAffectingSize=["radius"],oe(ui),Te.addGetterSetter(ui,"radius",0,xe());class di extends Wr{_sceneFunc(t){var e=this.radiusX(),r=this.radiusY();t.beginPath(),t.save(),e!==r&&t.scale(1,r/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}di.prototype.className="Ellipse",di.prototype._centroid=!0,di.prototype._attrsAffectingSize=["radiusX","radiusY"],oe(di),Te.addComponentsGetterSetter(di,"radius",["x","y"]),Te.addGetterSetter(di,"radiusX",0,xe()),Te.addGetterSetter(di,"radiusY",0,xe());class gi extends Wr{constructor(t){super(t),this.on("imageChange.konva",(()=>{this._setImageLoad()})),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&4===t.readyState||t&&t.addEventListener&&t.addEventListener("load",(()=>{this._requestDraw()}))}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),r=this.getHeight(),i=this.attrs.image;let n;if(i){const t=this.attrs.cropWidth,a=this.attrs.cropHeight;n=t&&a?[i,this.cropX(),this.cropY(),t,a,0,0,e,r]:[i,0,0,e,r]}(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)),i&&t.drawImage.apply(t,n)}_hitFunc(t){var e=this.width(),r=this.height();t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e){var r=ve.createImageElement();r.onload=function(){var t=new gi({image:r});e(t)},r.crossOrigin="Anonymous",r.src=t}}gi.prototype.className="Image",oe(gi),Te.addGetterSetter(gi,"image"),Te.addComponentsGetterSetter(gi,"crop",["x","y","width","height"]),Te.addGetterSetter(gi,"cropX",0,xe()),Te.addGetterSetter(gi,"cropY",0,xe()),Te.addGetterSetter(gi,"cropWidth",0,xe()),Te.addGetterSetter(gi,"cropHeight",0,xe());var fi=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height"],pi="up",vi="right",mi="down",yi="left",xi=fi.length;class bi extends Qr{constructor(t){super(t),this.on("add.konva",(function(t){this._addListeners(t.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e,r=this,i=function(){r._sync()};for(e=0;e<xi;e++)t.on(fi[e]+"Change.konva",i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t,e,r,i,n,a,s,o=this.getText(),h=this.getTag();if(o&&h){switch(t=o.width(),e=o.height(),r=h.pointerDirection(),i=h.pointerWidth(),s=h.pointerHeight(),n=0,a=0,r){case pi:n=t/2,a=-1*s;break;case vi:n=t+i,a=e/2;break;case mi:n=t/2,a=e+s;break;case yi:n=-1*i,a=e/2}h.setAttrs({x:-1*n,y:-1*a,width:t,height:e}),o.setAttrs({x:-1*n,y:-1*a})}}}bi.prototype.className="Label",oe(bi);class _i extends Wr{_sceneFunc(t){var e=this.width(),r=this.height(),i=this.pointerDirection(),n=this.pointerWidth(),a=this.pointerHeight(),s=this.cornerRadius();let o=0,h=0,l=0,c=0;"number"==typeof s?o=h=l=c=Math.min(s,e/2,r/2):(o=Math.min(s[0]||0,e/2,r/2),h=Math.min(s[1]||0,e/2,r/2),c=Math.min(s[2]||0,e/2,r/2),l=Math.min(s[3]||0,e/2,r/2)),t.beginPath(),t.moveTo(o,0),i===pi&&(t.lineTo((e-n)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+n)/2,0)),t.lineTo(e-h,0),t.arc(e-h,h,h,3*Math.PI/2,0,!1),i===vi&&(t.lineTo(e,(r-a)/2),t.lineTo(e+n,r/2),t.lineTo(e,(r+a)/2)),t.lineTo(e,r-c),t.arc(e-c,r-c,c,0,Math.PI/2,!1),i===mi&&(t.lineTo((e+n)/2,r),t.lineTo(e/2,r+a),t.lineTo((e-n)/2,r)),t.lineTo(l,r),t.arc(l,r-l,l,Math.PI/2,Math.PI,!1),i===yi&&(t.lineTo(0,(r+a)/2),t.lineTo(-1*n,r/2),t.lineTo(0,(r-a)/2)),t.lineTo(0,o),t.arc(o,o,o,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,r=this.pointerWidth(),i=this.pointerHeight(),n=this.pointerDirection(),a=this.width(),s=this.height();return n===pi?(e-=i,s+=i):n===mi?s+=i:n===yi?(t-=1.5*r,a+=r):n===vi&&(a+=1.5*r),{x:t,y:e,width:a,height:s}}}_i.prototype.className="Tag",oe(_i),Te.addGetterSetter(_i,"pointerDirection","none"),Te.addGetterSetter(_i,"pointerWidth",0,xe()),Te.addGetterSetter(_i,"pointerHeight",0,xe()),Te.addGetterSetter(_i,"cornerRadius",0,be(4));class Si extends Wr{_sceneFunc(t){var e=this.cornerRadius(),r=this.width(),i=this.height();if(t.beginPath(),e){let n=0,a=0,s=0,o=0;"number"==typeof e?n=a=s=o=Math.min(e,r/2,i/2):(n=Math.min(e[0]||0,r/2,i/2),a=Math.min(e[1]||0,r/2,i/2),o=Math.min(e[2]||0,r/2,i/2),s=Math.min(e[3]||0,r/2,i/2)),t.moveTo(n,0),t.lineTo(r-a,0),t.arc(r-a,a,a,3*Math.PI/2,0,!1),t.lineTo(r,i-o),t.arc(r-o,i-o,o,0,Math.PI/2,!1),t.lineTo(s,i),t.arc(s,i-s,s,Math.PI/2,Math.PI,!1),t.lineTo(0,n),t.arc(n,n,n,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,r,i);t.closePath(),t.fillStrokeShape(this)}}Si.prototype.className="Rect",oe(Si),Te.addGetterSetter(Si,"cornerRadius",0,be(4));class wi extends Wr{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,r=[];for(var i=0;i<t;i++)r.push({x:e*Math.sin(2*i*Math.PI/t),y:-1*e*Math.cos(2*i*Math.PI/t)});return r}getSelfRect(){const t=this._getPoints();var e=t[0].x,r=t[0].y,i=t[0].x,n=t[0].y;return t.forEach((t=>{e=Math.min(e,t.x),r=Math.max(r,t.x),i=Math.min(i,t.y),n=Math.max(n,t.y)})),{x:e,y:i,width:r-e,height:n-i}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}wi.prototype.className="RegularPolygon",wi.prototype._centroid=!0,wi.prototype._attrsAffectingSize=["radius"],oe(wi),Te.addGetterSetter(wi,"radius",0,xe()),Te.addGetterSetter(wi,"sides",0,xe());var Ci=2*Math.PI;class Pi extends Wr{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Ci,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Ci,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Pi.prototype.className="Ring",Pi.prototype._centroid=!0,Pi.prototype._attrsAffectingSize=["innerRadius","outerRadius"],oe(Pi),Te.addGetterSetter(Pi,"innerRadius",0,xe()),Te.addGetterSetter(Pi,"outerRadius",0,xe());class Ai extends Wr{constructor(t){super(t),this._updated=!0,this.anim=new Zr((()=>{var t=this._updated;return this._updated=!1,t})),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(t){var e=this.animation(),r=this.frameIndex(),i=4*r,n=this.animations()[e],a=this.frameOffsets(),s=n[i+0],o=n[i+1],h=n[i+2],l=n[i+3],c=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,h,l),t.closePath(),t.fillStrokeShape(this)),c)if(a){var u=a[e],d=2*r;t.drawImage(c,s,o,h,l,u[d+0],u[d+1],h,l)}else t.drawImage(c,s,o,h,l,0,0,h,l)}_hitFunc(t){var e=this.animation(),r=this.frameIndex(),i=4*r,n=this.animations()[e],a=this.frameOffsets(),s=n[i+2],o=n[i+3];if(t.beginPath(),a){var h=a[e],l=2*r;t.rect(h[l+0],h[l+1],s,o)}else t.rect(0,0,s,o);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)}}Ai.prototype.className="Sprite",oe(Ai),Te.addGetterSetter(Ai,"animation"),Te.addGetterSetter(Ai,"animations"),Te.addGetterSetter(Ai,"frameOffsets"),Te.addGetterSetter(Ai,"image"),Te.addGetterSetter(Ai,"frameIndex",0,xe()),Te.addGetterSetter(Ai,"frameRate",17,xe()),Te.backCompat(Ai,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Ti extends Wr{_sceneFunc(t){var e=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-r);for(var n=1;n<2*i;n++){var a=n%2==0?r:e,s=a*Math.sin(n*Math.PI/i),o=-1*a*Math.cos(n*Math.PI/i);t.lineTo(s,o)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}function Oi(t){return Array.from(t)}Ti.prototype.className="Star",Ti.prototype._centroid=!0,Ti.prototype._attrsAffectingSize=["innerRadius","outerRadius"],oe(Ti),Te.addGetterSetter(Ti,"numPoints",5,xe()),Te.addGetterSetter(Ti,"innerRadius",0,xe()),Te.addGetterSetter(Ti,"outerRadius",0,xe());var ki,Mi="auto",Ei="justify",Ri="left",Li="middle",Ni="normal",Ii=" ",Di=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Gi=Di.length;function Fi(){return ki||(ki=ve.createCanvasElement().getContext("2d"))}class Vi extends Wr{constructor(t){super(function(t){return(t=t||{}).fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<Gi;e++)this.on(Di[e]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,r=e.length;if(this.text()){var i,n=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),h=0,l=this.align(),c=this.getWidth(),u=this.letterSpacing(),d=this.fill(),g=this.textDecoration(),f=-1!==g.indexOf("underline"),p=-1!==g.indexOf("line-through"),v=0,m=(v=s/2,0),y=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Li),t.setAttr("textAlign",Ri),o===Li?h=(this.getHeight()-r*s-2*n)/2:"bottom"===o&&(h=this.getHeight()-r*s-2*n),t.translate(n,h+n),i=0;i<r;i++){m=0,y=0;var x,b,_,S=e[i],w=S.text,C=S.width,P=i!==r-1;if(t.save(),"right"===l?m+=c-C-2*n:"center"===l&&(m+=(c-C-2*n)/2),f&&(t.save(),t.beginPath(),t.moveTo(m,v+y+Math.round(a/2)),b=0==(x=w.split(" ").length-1),_=l===Ei&&P&&!b?c-2*n:C,t.lineTo(m+Math.round(_),v+y+Math.round(a/2)),t.lineWidth=a/15,t.strokeStyle=d,t.stroke(),t.restore()),p&&(t.save(),t.beginPath(),t.moveTo(m,v+y),b=0==(x=w.split(" ").length-1),_=l===Ei&&P&&!b?c-2*n:C,t.lineTo(m+Math.round(_),v+y),t.lineWidth=a/15,t.strokeStyle=d,t.stroke(),t.restore()),0!==u||l===Ei){x=w.split(" ").length-1;for(var A=Oi(w),T=0;T<A.length;T++){var O=A[T];" "===O&&i!==r-1&&l===Ei&&(m+=(c-2*n-C)/x),this._partialTextX=m,this._partialTextY=v+y,this._partialText=O,t.fillStrokeShape(this),m+=this.measureSize(O).width+u}}else this._partialTextX=m,this._partialTextY=v+y,this._partialText=w,t.fillStrokeShape(this);t.restore(),r>1&&(v+=s)}}}_hitFunc(t){var e=this.getWidth(),r=this.getHeight();t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=ve._isString(t)?t:null==t?"":t+"";return this._setAttr("text",e),this}getWidth(){return this.attrs.width===Mi||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===Mi||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return ve.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,r=Fi(),i=this.fontSize();return r.save(),r.font=this._getContextFont(),e=r.measureText(t),r.restore(),{width:e.width,height:i}}_getContextFont(){return this.fontStyle()+Ii+this.fontVariant()+Ii+(this.fontSize()+"px ")+this.fontFamily().split(",").map((t=>{const e=(t=t.trim()).indexOf(" ")>=0,r=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!r&&(t=`"${t}"`),t})).join(", ")}_addTextLine(t){this.align()===Ei&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e})}_getTextWidth(t){var e=this.letterSpacing(),r=t.length;return Fi().measureText(t).width+(r?e*(r-1):0)}_setTextData(){var t=this.text().split("\n"),e=+this.fontSize(),r=0,i=this.lineHeight()*e,n=this.attrs.width,a=this.attrs.height,s=n!==Mi&&void 0!==n,o=a!==Mi&&void 0!==a,h=this.padding(),l=n-2*h,c=a-2*h,u=0,d=this.wrap(),g="none"!==d,f="char"!==d&&g,p=this.ellipsis();this.textArr=[],Fi().font=this._getContextFont();for(var v=p?this._getTextWidth(""):0,m=0,y=t.length;m<y;++m){var x=t[m],b=this._getTextWidth(x);if(s&&b>l)for(;x.length>0;){for(var _=0,S=x.length,w="",C=0;_<S;){var P=_+S>>>1,A=x.slice(0,P+1),T=this._getTextWidth(A)+v;T<=l?(_=P+1,w=A,C=T):S=P}if(!w)break;if(f){var O,k=x[w.length];(O=(k===Ii||"-"===k)&&C<=l?w.length:Math.max(w.lastIndexOf(Ii),w.lastIndexOf("-"))+1)>0&&(_=O,w=w.slice(0,_),C=this._getTextWidth(w))}if(w=w.trimRight(),this._addTextLine(w),r=Math.max(r,C),u+=i,!g||o&&u+i>c){var M=this.textArr[this.textArr.length-1];M&&p&&(this._getTextWidth(M.text+"")<l||(M.text=M.text.slice(0,M.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(M.text+""));break}if((x=(x=x.slice(_)).trimLeft()).length>0&&(b=this._getTextWidth(x))<=l){this._addTextLine(x),u+=i,r=Math.max(r,b);break}}else this._addTextLine(x),u+=i,r=Math.max(r,b);if(o&&u+i>c)break}this.textHeight=e,this.textWidth=r}getStrokeScaleEnabled(){return!0}}Vi.prototype._fillFunc=function(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)},Vi.prototype._strokeFunc=function(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)},Vi.prototype.className="Text",Vi.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],oe(Vi),Te.overWriteSetter(Vi,"width",_e()),Te.overWriteSetter(Vi,"height",_e()),Te.addGetterSetter(Vi,"fontFamily","Arial"),Te.addGetterSetter(Vi,"fontSize",12,xe()),Te.addGetterSetter(Vi,"fontStyle",Ni),Te.addGetterSetter(Vi,"fontVariant",Ni),Te.addGetterSetter(Vi,"padding",0,xe()),Te.addGetterSetter(Vi,"align",Ri),Te.addGetterSetter(Vi,"verticalAlign","top"),Te.addGetterSetter(Vi,"lineHeight",1,xe()),Te.addGetterSetter(Vi,"wrap","word"),Te.addGetterSetter(Vi,"ellipsis",!1,Ce()),Te.addGetterSetter(Vi,"letterSpacing",0,xe()),Te.addGetterSetter(Vi,"text","",Se()),Te.addGetterSetter(Vi,"textDecoration","");var Bi="normal";function zi(t){t.fillText(this.partialText,0,0)}function ji(t){t.strokeText(this.partialText,0,0)}class Hi extends Wr{constructor(t){super(t),this.dummyCanvas=ve.createCanvasElement(),this.dataArray=[],this.dataArray=li.parsePathData(this.attrs.data),this.on("dataChange.konva",(function(){this.dataArray=li.parsePathData(this.attrs.data),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva",this._setTextData),this._setTextData()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),r=this.fill(),i=this.fontSize(),n=this.glyphInfo;"underline"===e&&t.beginPath();for(var a=0;a<n.length;a++){t.save();var s=n[a].p0;t.translate(s.x,s.y),t.rotate(n[a].rotation),this.partialText=n[a].text,t.fillStrokeShape(this),"underline"===e&&(0===a&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=r,t.lineWidth=i/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var r=e[0].p0;t.moveTo(r.x,r.y)}for(var i=0;i<e.length;i++){var n=e[i].p1;t.lineTo(n.x,n.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return ve.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Vi.prototype.setText.call(this,t)}_getContextFont(){return Vi.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();var r=e.measureText(t);return e.restore(),{width:r.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var t=this,e=this._getTextSize(this.attrs.text),r=this.letterSpacing(),i=this.align(),n=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);this.glyphInfo=[];for(var s=0,o=0;o<t.dataArray.length;o++)t.dataArray[o].pathLength>0&&(s+=t.dataArray[o].pathLength);var h=0;"center"===i&&(h=Math.max(0,s/2-a/2)),"right"===i&&(h=Math.max(0,s-a));for(var l,c,u,d=Oi(this.text()),g=this.text().split(" ").length-1,f=-1,p=0,v=function(){p=0;for(var e=t.dataArray,r=f+1;r<e.length;r++){if(e[r].pathLength>0)return f=r,e[r];"M"===e[r].command&&(l={x:e[r].points[0],y:e[r].points[1]})}return{}},m=function(e){var n=t._getTextSize(e).width+r;" "===e&&"justify"===i&&(n+=(s-a)/g);var o=0,h=0;for(c=void 0;Math.abs(n-o)/n>.01&&h<20;){h++;for(var d=o;void 0===u;)(u=v())&&d+u.pathLength<n&&(d+=u.pathLength,u=void 0);if(u==={}||void 0===l)return;var f=!1;switch(u.command){case"L":li.getLineLength(l.x,l.y,u.points[0],u.points[1])>n?c=li.getPointOnLine(n,l.x,l.y,u.points[0],u.points[1],l.x,l.y):u=void 0;break;case"A":var m=u.points[4],y=u.points[5],x=u.points[4]+y;0===p?p=m+1e-8:n>o?p+=Math.PI/180*y/Math.abs(y):p-=Math.PI/360*y/Math.abs(y),(y<0&&p<x||y>=0&&p>x)&&(p=x,f=!0),c=li.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],p,u.points[6]);break;case"C":0===p?p=n>u.pathLength?1e-8:n/u.pathLength:n>o?p+=(n-o)/u.pathLength/2:p=Math.max(p-(o-n)/u.pathLength/2,0),p>1&&(p=1,f=!0),c=li.getPointOnCubicBezier(p,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);break;case"Q":0===p?p=n/u.pathLength:n>o?p+=(n-o)/u.pathLength:p-=(o-n)/u.pathLength,p>1&&(p=1,f=!0),c=li.getPointOnQuadraticBezier(p,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3])}void 0!==c&&(o=li.getLineLength(l.x,l.y,c.x,c.y)),f&&(f=!1,u=void 0)}},y=h/(t._getTextSize("C").width+r)-1,x=0;x<y&&(m("C"),void 0!==l&&void 0!==c);x++)l=c;for(var b=0;b<d.length&&(m(d[b]),void 0!==l&&void 0!==c);b++){var _=li.getLineLength(l.x,l.y,c.x,c.y),S=0;if(n)try{S=n(d[b-1],d[b])*this.fontSize()}catch(t){S=0}l.x+=S,c.x+=S,this.textWidth+=S;var w=li.getPointOnLine(S+_/2,l.x,l.y,c.x,c.y),C=Math.atan2(c.y-l.y,c.x-l.x);this.glyphInfo.push({transposeX:w.x,transposeY:w.y,text:d[b],rotation:C,p0:l,p1:c}),l=c}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,r,i=t[0]||0,n=t[0]||0,a=t[1]||0,s=t[1]||0,o=0;o<t.length/2;o++)e=t[2*o],r=t[2*o+1],i=Math.min(i,e),n=Math.max(n,e),a=Math.min(a,r),s=Math.max(s,r);var h=this.fontSize();return{x:i-h/2,y:a-h/2,width:n-i+h,height:s-a+h}}}Hi.prototype._fillFunc=zi,Hi.prototype._strokeFunc=ji,Hi.prototype._fillFuncHit=zi,Hi.prototype._strokeFuncHit=ji,Hi.prototype.className="TextPath",Hi.prototype._attrsAffectingSize=["text","fontSize","data"],oe(Hi),Te.addGetterSetter(Hi,"data"),Te.addGetterSetter(Hi,"fontFamily","Arial"),Te.addGetterSetter(Hi,"fontSize",12,xe()),Te.addGetterSetter(Hi,"fontStyle",Bi),Te.addGetterSetter(Hi,"align","left"),Te.addGetterSetter(Hi,"letterSpacing",0,xe()),Te.addGetterSetter(Hi,"textBaseline","middle"),Te.addGetterSetter(Hi,"fontVariant",Bi),Te.addGetterSetter(Hi,"text",""),Te.addGetterSetter(Hi,"textDecoration",null),Te.addGetterSetter(Hi,"kerningFunc",null);var Wi=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map((t=>t+".tr-konva")).join(" "),Ui="nodesRect",Yi=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"].map((t=>t+".tr-konva")).join(" "),Xi={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const qi="ontouchstart"in se._global;var Qi=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function $i(t,e,r){const i=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),n=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return Object.assign(Object.assign({},t),{rotation:t.rotation+e,x:i,y:n})}class Zi extends Qr{constructor(t){super(t),this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Wi,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return ve.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}setNodes(t=[]){return this._nodes&&this._nodes.length&&this.detach(),this._nodes=t,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((t=>{const e=t._attrsAffectingSize.map((t=>t+"Change.tr-konva")).join(" "),r=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()};t.on(e,r),t.on(Yi,r),t.on("absoluteTransformChange.tr-konva",r),t.on("xChange.tr-konva yChange.tr-konva",r),this._proxyDrag(t)})),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on("dragstart.tr-konva",(r=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(r,!1)})),t.on("dragmove.tr-konva",(r=>{if(!e)return;const i=t.getAbsolutePosition(),n=i.x-e.x,a=i.y-e.y;this.nodes().forEach((e=>{if(e===t)return;if(e.isDragging())return;const i=e.getAbsolutePosition();e.setAbsolutePosition({x:i.x+n,y:i.y+a}),e.startDrag(r)})),e=null}))}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach((t=>{t.off(".tr-konva")})),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Ui),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Ui,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),r){var i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),n=t.getAbsoluteScale(r),a=t.getAbsolutePosition(r),s=i.x*n.x-t.offsetX()*n.x,o=i.y*n.y-t.offsetY()*n.y;const h=(se.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return $i({x:a.x+s*Math.cos(h)+o*Math.sin(-h),y:a.y+o*Math.cos(h)+s*Math.sin(h),width:i.width*n.x,height:i.height*n.y,rotation:h},-se.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map((e=>{const r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var i=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],n=e.getAbsoluteTransform();i.forEach((function(e){var r=n.point(e);t.push(r)}))}));const e=new he;var r,i,n,a;e.rotate(-se.getAngle(this.rotation())),t.forEach((function(t){var s=e.point(t);void 0===r&&(r=n=s.x,i=a=s.y),r=Math.min(r,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x),a=Math.max(a,s.y)})),e.invert();const s=e.point({x:r,y:i});return{x:s.x,y:s.y,width:n-r,height:a-i,rotation:se.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Qi.forEach(function(t){this._createAnchor(t)}.bind(this)),this._createAnchor("rotater")}_createAnchor(t){var e=new Si({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:qi?10:"auto"}),r=this;e.on("mousedown touchstart",(function(t){r._handleMouseDown(t)})),e.on("dragstart",(t=>{e.stopDrag(),t.cancelBubble=!0})),e.on("dragend",(t=>{t.cancelBubble=!0})),e.on("mouseenter",(()=>{var r=se.getAngle(this.rotation()),i=function(t,e){if("rotater"===t)return"crosshair";e+=ve.degToRad(Xi[t]||0);var r=(ve.radToDeg(e)%360+360)%360;return ve._inRange(r,337.5,360)||ve._inRange(r,0,22.5)?"ns-resize":ve._inRange(r,22.5,67.5)?"nesw-resize":ve._inRange(r,67.5,112.5)?"ew-resize":ve._inRange(r,112.5,157.5)?"nwse-resize":ve._inRange(r,157.5,202.5)?"ns-resize":ve._inRange(r,202.5,247.5)?"nesw-resize":ve._inRange(r,247.5,292.5)?"ew-resize":ve._inRange(r,292.5,337.5)?"nwse-resize":(ve.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}(t,r);e.getStage().content&&(e.getStage().content.style.cursor=i),this._cursorChange=!0})),e.on("mouseout",(()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1})),this.add(e)}_createBack(){var t=new Wr({name:"back",width:0,height:0,draggable:!0,sceneFunc(t){var e=this.getParent(),r=e.padding();t.beginPath(),t.rect(-r,-r,this.width()+2*r,this.height()+2*r),t.moveTo(this.width()/2,-r),e.rotateEnabled()&&t.lineTo(this.width()/2,-e.rotateAnchorOffset()*ve._sign(this.height())-r),t.fillStrokeShape(this)},hitFunc:(t,e)=>{if(this.shouldOverdrawWholeArea()){var r=this.padding();t.beginPath(),t.rect(-r,-r,e.width()+2*r,e.height()+2*r),t.fillStrokeShape(e)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",(t=>{t.cancelBubble=!0})),t.on("dragmove",(t=>{t.cancelBubble=!0})),t.on("dragend",(t=>{t.cancelBubble=!0})),this.on("dragmove",(t=>{this.update()}))}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),r=e.width,i=e.height,n=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/n),this.cos=Math.abs(r/n),"undefined"!=typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=t.target.getAbsolutePosition(),s=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:s.x-a.x,y:s.y-a.y},this._fire("transformstart",{evt:t,target:this.getNode()}),this._nodes.forEach((e=>{e._fire("transformstart",{evt:t,target:e})}))}_handleMouseMove(t){var e,r,i,n=this.findOne("."+this._movingAnchorName),a=n.getStage();a.setPointersPositions(t);const s=a.getPointerPosition();var o={x:s.x-this._anchorDragOffset.x,y:s.y-this._anchorDragOffset.y};const h=n.getAbsolutePosition();n.setAbsolutePosition(o);const l=n.getAbsolutePosition();if(h.x!==l.x||h.y!==l.y)if("rotater"!==this._movingAnchorName){var c=this.keepRatio()||t.shiftKey,u=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(c){var d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(d.x-n.x(),2)+Math.pow(d.y-n.y(),2));var g=this.findOne(".top-left").x()>d.x?-1:1,f=this.findOne(".top-left").y()>d.y?-1:1;e=i*this.cos*g,r=i*this.sin*f,this.findOne(".top-left").x(d.x-e),this.findOne(".top-left").y(d.y-r)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(n.y());else if("top-right"===this._movingAnchorName){c&&(d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()},i=Math.sqrt(Math.pow(n.x()-d.x,2)+Math.pow(d.y-n.y(),2)),g=this.findOne(".top-right").x()<d.x?-1:1,f=this.findOne(".top-right").y()>d.y?-1:1,e=i*this.cos*g,r=i*this.sin*f,this.findOne(".top-right").x(d.x+e),this.findOne(".top-right").y(d.y-r));var p=n.position();this.findOne(".top-left").y(p.y),this.findOne(".bottom-right").x(p.x)}else"middle-left"===this._movingAnchorName?this.findOne(".top-left").x(n.x()):"middle-right"===this._movingAnchorName?this.findOne(".bottom-right").x(n.x()):"bottom-left"===this._movingAnchorName?(c&&(d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()},i=Math.sqrt(Math.pow(d.x-n.x(),2)+Math.pow(n.y()-d.y,2)),g=d.x<n.x()?-1:1,f=n.y()<d.y?-1:1,e=i*this.cos*g,r=i*this.sin*f,n.x(d.x-e),n.y(d.y+r)),p=n.position(),this.findOne(".top-left").x(p.x),this.findOne(".bottom-right").y(p.y)):"bottom-center"===this._movingAnchorName?this.findOne(".bottom-right").y(n.y()):"bottom-right"===this._movingAnchorName?c&&(d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()},i=Math.sqrt(Math.pow(n.x()-d.x,2)+Math.pow(n.y()-d.y,2)),g=this.findOne(".bottom-right").x()<d.x?-1:1,f=this.findOne(".bottom-right").y()<d.y?-1:1,e=i*this.cos*g,r=i*this.sin*f,this.findOne(".bottom-right").x(d.x+e),this.findOne(".bottom-right").y(d.y+r)):console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(u=this.centeredScaling()||t.altKey){var v=this.findOne(".top-left"),m=this.findOne(".bottom-right"),y=v.x(),x=v.y(),b=this.getWidth()-m.x(),_=this.getHeight()-m.y();m.move({x:-y,y:-x}),v.move({x:b,y:_})}var S=this.findOne(".top-left").getAbsolutePosition();e=S.x,r=S.y;var w=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:r,width:w,height:C,rotation:se.getAngle(this.rotation())},t)}else{var P=this._getNodeRect();e=n.x()-P.width/2,r=-n.y()+P.height/2;let i=Math.atan2(-r,e)+Math.PI/2;P.height<0&&(i-=Math.PI);const a=se.getAngle(this.rotation())+i,s=se.getAngle(this.rotationSnapTolerance()),o=function(t,e,r){let i=e;for(let n=0;n<t.length;n++){const a=se.getAngle(t[n]),s=Math.abs(a-e)%(2*Math.PI);Math.min(s,2*Math.PI-s)<r&&(i=a)}return i}(this.rotationSnaps(),a,s),h=function(t,e){const r=function(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}(t);return $i(t,e,r)}(P,o-P.rotation);this._fitNodesInto(h,t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,"undefined"!=typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach((e=>{e._fire("transformend",{evt:t,target:e})})),this._movingAnchorName=null}}_fitNodesInto(t,e){var r=this._getNodeRect();if(ve._inRange(t.width,2*-this.padding()-1,1))return void this.update();if(ve._inRange(t.height,2*-this.padding()-1,1))return void this.update();const i=this.flipEnabled();var n=new he;if(n.rotate(se.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const e=n.point({x:2*-this.padding(),y:0});if(t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,!i)return void this.update()}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const e=n.point({x:2*this.padding(),y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding(),!i)return void this.update()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const e=n.point({x:0,y:2*-this.padding()});if(t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!i)return void this.update()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const e=n.point({x:0,y:2*this.padding()});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!i)return void this.update()}if(this.boundBoxFunc()){const e=this.boundBoxFunc()(r,t);e?t=e:ve.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,s=new he;s.translate(r.x,r.y),s.rotate(r.rotation),s.scale(r.width/a,r.height/a);const o=new he;o.translate(t.x,t.y),o.rotate(t.rotation),o.scale(t.width/a,t.height/a);const h=o.multiply(s.invert());this._nodes.forEach((t=>{var r;const i=t.getParent().getAbsoluteTransform(),n=t.getTransform().copy();n.translate(t.offsetX(),t.offsetY());const a=new he;a.multiply(i.copy().invert()).multiply(h).multiply(i).multiply(n);const s=a.decompose();t.setAttrs(s),this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t}),null===(r=t.getLayer())||void 0===r||r.batchDraw()})),this.rotation(ve._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(ve._getRotation(e.rotation));var r=e.width,i=e.height,n=this.enabledAnchors(),a=this.resizeEnabled(),s=this.padding(),o=this.anchorSize();this.find("._anchor").forEach((t=>{t.setAttrs({width:o,height:o,offsetX:o/2,offsetY:o/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:o/2+s,offsetY:o/2+s,visible:a&&n.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:o/2+s,visible:a&&n.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:o/2-s,offsetY:o/2+s,visible:a&&n.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:o/2+s,visible:a&&n.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:o/2-s,visible:a&&n.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:o/2+s,offsetY:o/2-s,visible:a&&n.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:o/2-s,visible:a&&n.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:o/2-s,offsetY:o/2-s,visible:a&&n.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*ve._sign(i)-s,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Qr.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Je.prototype.toObject.call(this)}}Zi.prototype.className="Transformer",oe(Zi),Te.addGetterSetter(Zi,"enabledAnchors",Qi,(function(t){return t instanceof Array||ve.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===Qi.indexOf(t)&&ve.warn("Unknown anchor name: "+t+". Available names are: "+Qi.join(", "))})),t||[]})),Te.addGetterSetter(Zi,"flipEnabled",!0,Ce()),Te.addGetterSetter(Zi,"resizeEnabled",!0),Te.addGetterSetter(Zi,"anchorSize",10,xe()),Te.addGetterSetter(Zi,"rotateEnabled",!0),Te.addGetterSetter(Zi,"rotationSnaps",[]),Te.addGetterSetter(Zi,"rotateAnchorOffset",50,xe()),Te.addGetterSetter(Zi,"rotationSnapTolerance",5,xe()),Te.addGetterSetter(Zi,"borderEnabled",!0),Te.addGetterSetter(Zi,"anchorStroke","rgb(0, 161, 255)"),Te.addGetterSetter(Zi,"anchorStrokeWidth",1,xe()),Te.addGetterSetter(Zi,"anchorFill","white"),Te.addGetterSetter(Zi,"anchorCornerRadius",0,xe()),Te.addGetterSetter(Zi,"borderStroke","rgb(0, 161, 255)"),Te.addGetterSetter(Zi,"borderStrokeWidth",1,xe()),Te.addGetterSetter(Zi,"borderDash"),Te.addGetterSetter(Zi,"keepRatio",!0),Te.addGetterSetter(Zi,"centeredScaling",!1),Te.addGetterSetter(Zi,"ignoreStroke",!1),Te.addGetterSetter(Zi,"padding",0,xe()),Te.addGetterSetter(Zi,"node"),Te.addGetterSetter(Zi,"nodes"),Te.addGetterSetter(Zi,"boundBoxFunc"),Te.addGetterSetter(Zi,"shouldOverdrawWholeArea",!1),Te.addGetterSetter(Zi,"useSingleNodeRotation",!0),Te.backCompat(Zi,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Ki extends Wr{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,se.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}function Ji(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}Ki.prototype.className="Wedge",Ki.prototype._centroid=!0,Ki.prototype._attrsAffectingSize=["radius"],oe(Ki),Te.addGetterSetter(Ki,"radius",0,xe()),Te.addGetterSetter(Ki,"angle",0,xe()),Te.addGetterSetter(Ki,"clockwise",!1),Te.backCompat(Ki,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var tn=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],en=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function rn(t,e,r,i,n){var a=r-e,s=n-i;return 0===a?i+s/2:0===s?i:s*((t-e)/a)+i}function nn(t,e,r){var i=4*(r*t.width+e),n=[];return n.push(t.data[i++],t.data[i++],t.data[i++],t.data[i++]),n}function an(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}Te.addGetterSetter(Je,"blurRadius",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"brightness",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"contrast",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"embossStrength",.5,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"embossWhiteLevel",.5,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"embossDirection","top-left",null,Te.afterSetFilter),Te.addGetterSetter(Je,"embossBlend",!1,null,Te.afterSetFilter),Te.addGetterSetter(Je,"enhance",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"hue",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"saturation",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"luminance",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"hue",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"saturation",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"value",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"kaleidoscopePower",2,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"kaleidoscopeAngle",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"threshold",0,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"noise",.2,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"pixelSize",8,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"levels",.5,xe(),Te.afterSetFilter),Te.addGetterSetter(Je,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Te.addGetterSetter(Je,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Te.addGetterSetter(Je,"blue",0,ye,Te.afterSetFilter),Te.addGetterSetter(Je,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Te.addGetterSetter(Je,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Te.addGetterSetter(Je,"blue",0,ye,Te.afterSetFilter),Te.addGetterSetter(Je,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t})),Te.addGetterSetter(Je,"threshold",.5,xe(),Te.afterSetFilter);const sn=ni.Util._assign(ni,{Arc:ai,Arrow:ci,Circle:ui,Ellipse:di,Image:gi,Label:bi,Tag:_i,Line:hi,Path:li,Rect:Si,RegularPolygon:wi,Ring:Pi,Sprite:Ai,Star:Ti,Text:Vi,TextPath:Hi,Transformer:Zi,Wedge:Ki,Filters:{Blur:function(t){var e=Math.round(this.blurRadius());e>0&&function(t,e){var r,i,n,a,s,o,h,l,c,u,d,g,f,p,v,m,y,x,b,_,S,w,C,P,A=t.data,T=t.width,O=t.height,k=e+e+1,M=T-1,E=O-1,R=e+1,L=R*(R+1)/2,N=new Ji,I=null,D=N,G=null,F=null,V=tn[e],B=en[e];for(n=1;n<k;n++)D=D.next=new Ji,n===R&&(I=D);for(D.next=N,h=o=0,i=0;i<O;i++){for(m=y=x=b=l=c=u=d=0,g=R*(_=A[o]),f=R*(S=A[o+1]),p=R*(w=A[o+2]),v=R*(C=A[o+3]),l+=L*_,c+=L*S,u+=L*w,d+=L*C,D=N,n=0;n<R;n++)D.r=_,D.g=S,D.b=w,D.a=C,D=D.next;for(n=1;n<R;n++)a=o+((M<n?M:n)<<2),l+=(D.r=_=A[a])*(P=R-n),c+=(D.g=S=A[a+1])*P,u+=(D.b=w=A[a+2])*P,d+=(D.a=C=A[a+3])*P,m+=_,y+=S,x+=w,b+=C,D=D.next;for(G=N,F=I,r=0;r<T;r++)A[o+3]=C=d*V>>B,0!==C?(C=255/C,A[o]=(l*V>>B)*C,A[o+1]=(c*V>>B)*C,A[o+2]=(u*V>>B)*C):A[o]=A[o+1]=A[o+2]=0,l-=g,c-=f,u-=p,d-=v,g-=G.r,f-=G.g,p-=G.b,v-=G.a,a=h+((a=r+e+1)<M?a:M)<<2,l+=m+=G.r=A[a],c+=y+=G.g=A[a+1],u+=x+=G.b=A[a+2],d+=b+=G.a=A[a+3],G=G.next,g+=_=F.r,f+=S=F.g,p+=w=F.b,v+=C=F.a,m-=_,y-=S,x-=w,b-=C,F=F.next,o+=4;h+=T}for(r=0;r<T;r++){for(y=x=b=m=c=u=d=l=0,g=R*(_=A[o=r<<2]),f=R*(S=A[o+1]),p=R*(w=A[o+2]),v=R*(C=A[o+3]),l+=L*_,c+=L*S,u+=L*w,d+=L*C,D=N,n=0;n<R;n++)D.r=_,D.g=S,D.b=w,D.a=C,D=D.next;for(s=T,n=1;n<=e;n++)o=s+r<<2,l+=(D.r=_=A[o])*(P=R-n),c+=(D.g=S=A[o+1])*P,u+=(D.b=w=A[o+2])*P,d+=(D.a=C=A[o+3])*P,m+=_,y+=S,x+=w,b+=C,D=D.next,n<E&&(s+=T);for(o=r,G=N,F=I,i=0;i<O;i++)A[3+(a=o<<2)]=C=d*V>>B,C>0?(C=255/C,A[a]=(l*V>>B)*C,A[a+1]=(c*V>>B)*C,A[a+2]=(u*V>>B)*C):A[a]=A[a+1]=A[a+2]=0,l-=g,c-=f,u-=p,d-=v,g-=G.r,f-=G.g,p-=G.b,v-=G.a,a=r+((a=i+R)<E?a:E)*T<<2,l+=m+=G.r=A[a],c+=y+=G.g=A[a+1],u+=x+=G.b=A[a+2],d+=b+=G.a=A[a+3],G=G.next,g+=_=F.r,f+=S=F.g,p+=w=F.b,v+=C=F.a,m-=_,y-=S,x-=w,b-=C,F=F.next,o+=T}}(t,e)},Brighten:function(t){var e,r=255*this.brightness(),i=t.data,n=i.length;for(e=0;e<n;e+=4)i[e]+=r,i[e+1]+=r,i[e+2]+=r},Contrast:function(t){var e,r=Math.pow((this.contrast()+100)/100,2),i=t.data,n=i.length,a=150,s=150,o=150;for(e=0;e<n;e+=4)a=i[e],s=i[e+1],o=i[e+2],a/=255,a-=.5,a*=r,a+=.5,s/=255,s-=.5,s*=r,s+=.5,o/=255,o-=.5,o*=r,o+=.5,a=(a*=255)<0?0:a>255?255:a,s=(s*=255)<0?0:s>255?255:s,o=(o*=255)<0?0:o>255?255:o,i[e]=a,i[e+1]=s,i[e+2]=o},Emboss:function(t){var e=10*this.embossStrength(),r=255*this.embossWhiteLevel(),i=this.embossDirection(),n=this.embossBlend(),a=0,s=0,o=t.data,h=t.width,l=t.height,c=4*h,u=l;switch(i){case"top-left":a=-1,s=-1;break;case"top":a=-1,s=0;break;case"top-right":a=-1,s=1;break;case"right":a=0,s=1;break;case"bottom-right":a=1,s=1;break;case"bottom":a=1,s=0;break;case"bottom-left":a=1,s=-1;break;case"left":a=0,s=-1;break;default:ve.error("Unknown emboss direction: "+i)}do{var d=(u-1)*c,g=a;u+g<1&&(g=0),u+g>l&&(g=0);var f=(u-1+g)*h*4,p=h;do{var v=d+4*(p-1),m=s;p+m<1&&(m=0),p+m>h&&(m=0);var y=f+4*(p-1+m),x=o[v]-o[y],b=o[v+1]-o[y+1],_=o[v+2]-o[y+2],S=x,w=S>0?S:-S;if((b>0?b:-b)>w&&(S=b),(_>0?_:-_)>w&&(S=_),S*=e,n){var C=o[v]+S,P=o[v+1]+S,A=o[v+2]+S;o[v]=C>255?255:C<0?0:C,o[v+1]=P>255?255:P<0?0:P,o[v+2]=A>255?255:A<0?0:A}else{var T=r-S;T<0?T=0:T>255&&(T=255),o[v]=o[v+1]=o[v+2]=T}}while(--p)}while(--u)},Enhance:function(t){var e,r,i,n,a=t.data,s=a.length,o=a[0],h=o,l=a[1],c=l,u=a[2],d=u,g=this.enhance();if(0!==g){for(n=0;n<s;n+=4)(e=a[n+0])<o?o=e:e>h&&(h=e),(r=a[n+1])<l?l=r:r>c&&(c=r),(i=a[n+2])<u?u=i:i>d&&(d=i);var f,p,v,m,y,x,b,_,S;for(h===o&&(h=255,o=0),c===l&&(c=255,l=0),d===u&&(d=255,u=0),g>0?(p=h+g*(255-h),v=o-g*(o-0),y=c+g*(255-c),x=l-g*(l-0),_=d+g*(255-d),S=u-g*(u-0)):(p=h+g*(h-(f=.5*(h+o))),v=o+g*(o-f),y=c+g*(c-(m=.5*(c+l))),x=l+g*(l-m),_=d+g*(d-(b=.5*(d+u))),S=u+g*(u-b)),n=0;n<s;n+=4)a[n+0]=rn(a[n+0],o,h,v,p),a[n+1]=rn(a[n+1],l,c,x,y),a[n+2]=rn(a[n+2],u,d,S,_)}},Grayscale:function(t){var e,r,i=t.data,n=i.length;for(e=0;e<n;e+=4)r=.34*i[e]+.5*i[e+1]+.16*i[e+2],i[e]=r,i[e+1]=r,i[e+2]=r},HSL:function(t){var e,r,i,n,a,s=t.data,o=s.length,h=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=127*this.luminance(),u=1*h*Math.cos(l*Math.PI/180),d=1*h*Math.sin(l*Math.PI/180),g=.299+.701*u+.167*d,f=.587-.587*u+.33*d,p=.114-.114*u-.497*d,v=.299-.299*u-.328*d,m=.587+.413*u+.035*d,y=.114-.114*u+.293*d,x=.299-.3*u+1.25*d,b=.587-.586*u-1.05*d,_=.114+.886*u-.2*d;for(e=0;e<o;e+=4)r=s[e+0],i=s[e+1],n=s[e+2],a=s[e+3],s[e+0]=g*r+f*i+p*n+c,s[e+1]=v*r+m*i+y*n+c,s[e+2]=x*r+b*i+_*n+c,s[e+3]=a},HSV:function(t){var e,r,i,n,a,s=t.data,o=s.length,h=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,u=h*l*Math.cos(c*Math.PI/180),d=h*l*Math.sin(c*Math.PI/180),g=.299*h+.701*u+.167*d,f=.587*h-.587*u+.33*d,p=.114*h-.114*u-.497*d,v=.299*h-.299*u-.328*d,m=.587*h+.413*u+.035*d,y=.114*h-.114*u+.293*d,x=.299*h-.3*u+1.25*d,b=.587*h-.586*u-1.05*d,_=.114*h+.886*u-.2*d;for(e=0;e<o;e+=4)r=s[e+0],i=s[e+1],n=s[e+2],a=s[e+3],s[e+0]=g*r+f*i+p*n,s[e+1]=v*r+m*i+y*n,s[e+2]=x*r+b*i+_*n,s[e+3]=a},Invert:function(t){var e,r=t.data,i=r.length;for(e=0;e<i;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2]},Kaleidoscope:function(t){var e,r,i,n,a,s,o,h,l,c=t.width,u=t.height,d=Math.round(this.kaleidoscopePower()),g=Math.round(this.kaleidoscopeAngle()),f=Math.floor(c*(g%360)/360);if(!(d<1)){var p=ve.createCanvasElement();p.width=c,p.height=u;var v=p.getContext("2d").getImageData(0,0,c,u);!function(t,e,r){var i,n,a,s,o=t.data,h=e.data,l=t.width,c=t.height,u=r.polarCenterX||l/2,d=r.polarCenterY||c/2,g=0,f=0,p=0,v=0,m=Math.sqrt(u*u+d*d);n=l-u,a=c-d,m=(s=Math.sqrt(n*n+a*a))>m?s:m;var y,x,b,_,S=c,w=l,C=360/w*Math.PI/180;for(x=0;x<w;x+=1)for(b=Math.sin(x*C),_=Math.cos(x*C),y=0;y<S;y+=1)n=Math.floor(u+m*y/S*_),g=o[0+(i=4*((a=Math.floor(d+m*y/S*b))*l+n))],f=o[i+1],p=o[i+2],v=o[i+3],h[0+(i=4*(x+y*l))]=g,h[i+1]=f,h[i+2]=p,h[i+3]=v}(t,v,{polarCenterX:c/2,polarCenterY:u/2});for(var m=c/Math.pow(2,d);m<=8;)m*=2,d-=1;var y=m=Math.ceil(m),x=0,b=y,_=1;for(f+m>c&&(x=y,b=0,_=-1),r=0;r<u;r+=1)for(e=x;e!==b;e+=_)h=4*(c*r+Math.round(e+f)%c),n=v.data[h+0],a=v.data[h+1],s=v.data[h+2],o=v.data[h+3],l=4*(c*r+e),v.data[l+0]=n,v.data[l+1]=a,v.data[l+2]=s,v.data[l+3]=o;for(r=0;r<u;r+=1)for(y=Math.floor(m),i=0;i<d;i+=1){for(e=0;e<y+1;e+=1)h=4*(c*r+e),n=v.data[h+0],a=v.data[h+1],s=v.data[h+2],o=v.data[h+3],l=4*(c*r+2*y-e-1),v.data[l+0]=n,v.data[l+1]=a,v.data[l+2]=s,v.data[l+3]=o;y*=2}!function(t,e,r){var i,n,a,s,o,h,l=t.data,c=e.data,u=t.width,d=t.height,g=r.polarCenterX||u/2,f=r.polarCenterY||d/2,p=0,v=0,m=0,y=0,x=Math.sqrt(g*g+f*f);n=u-g,a=d-f,x=(h=Math.sqrt(n*n+a*a))>x?h:x;var b,_,S,w=d,C=u,P=r.polarRotation||0;for(n=0;n<u;n+=1)for(a=0;a<d;a+=1)s=n-g,o=a-f,b=Math.sqrt(s*s+o*o)*w/x,_=(_=(180*Math.atan2(o,s)/Math.PI+360+P)%360)*C/360,S=Math.floor(_),p=l[0+(i=4*(Math.floor(b)*u+S))],v=l[i+1],m=l[i+2],y=l[i+3],c[0+(i=4*(a*u+n))]=p,c[i+1]=v,c[i+2]=m,c[i+3]=y}(v,t,{polarRotation:0})}},Mask:function(t){var e=function(t,e){var r=nn(t,0,0),i=nn(t,t.width-1,0),n=nn(t,0,t.height-1),a=nn(t,t.width-1,t.height-1),s=e||10;if(an(r,i)<s&&an(i,a)<s&&an(a,n)<s&&an(n,r)<s){for(var o=function(t){for(var e=[0,0,0],r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([i,r,a,n]),h=[],l=0;l<t.width*t.height;l++){var c=an(o,[t.data[4*l],t.data[4*l+1],t.data[4*l+2]]);h[l]=c<s?0:255}return h}}(t,this.threshold());return e&&(e=function(t,e,r){for(var i=[1,1,1,1,0,1,1,1,1],n=Math.round(Math.sqrt(i.length)),a=Math.floor(n/2),s=[],o=0;o<r;o++)for(var h=0;h<e;h++){for(var l=o*e+h,c=0,u=0;u<n;u++)for(var d=0;d<n;d++){var g=o+u-a,f=h+d-a;if(g>=0&&g<r&&f>=0&&f<e){var p=i[u*n+d];c+=t[g*e+f]*p}}s[l]=2040===c?255:0}return s}(e,t.width,t.height),e=function(t,e,r){for(var i=[1,1,1,1,1,1,1,1,1],n=Math.round(Math.sqrt(i.length)),a=Math.floor(n/2),s=[],o=0;o<r;o++)for(var h=0;h<e;h++){for(var l=o*e+h,c=0,u=0;u<n;u++)for(var d=0;d<n;d++){var g=o+u-a,f=h+d-a;if(g>=0&&g<r&&f>=0&&f<e){var p=i[u*n+d];c+=t[g*e+f]*p}}s[l]=c>=1020?255:0}return s}(e,t.width,t.height),e=function(t,e,r){for(var i=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],n=Math.round(Math.sqrt(i.length)),a=Math.floor(n/2),s=[],o=0;o<r;o++)for(var h=0;h<e;h++){for(var l=o*e+h,c=0,u=0;u<n;u++)for(var d=0;d<n;d++){var g=o+u-a,f=h+d-a;if(g>=0&&g<r&&f>=0&&f<e){var p=i[u*n+d];c+=t[g*e+f]*p}}s[l]=c}return s}(e,t.width,t.height),function(t,e){for(var r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}(t,e)),t},Noise:function(t){var e,r=255*this.noise(),i=t.data,n=i.length,a=r/2;for(e=0;e<n;e+=4)i[e+0]+=a-2*a*Math.random(),i[e+1]+=a-2*a*Math.random(),i[e+2]+=a-2*a*Math.random()},Pixelate:function(t){var e,r,i,n,a,s,o,h,l,c,u,d,g,f,p=Math.ceil(this.pixelSize()),v=t.width,m=t.height,y=Math.ceil(v/p),x=Math.ceil(m/p),b=t.data;if(p<=0)ve.error("pixelSize value can not be <= 0");else for(d=0;d<y;d+=1)for(g=0;g<x;g+=1){for(n=0,a=0,s=0,o=0,l=(h=d*p)+p,u=(c=g*p)+p,f=0,e=h;e<l;e+=1)if(!(e>=v))for(r=c;r<u;r+=1)r>=m||(n+=b[0+(i=4*(v*r+e))],a+=b[i+1],s+=b[i+2],o+=b[i+3],f+=1);for(n/=f,a/=f,s/=f,o/=f,e=h;e<l;e+=1)if(!(e>=v))for(r=c;r<u;r+=1)r>=m||(b[0+(i=4*(v*r+e))]=n,b[i+1]=a,b[i+2]=s,b[i+3]=o)}},Posterize:function(t){var e,r=Math.round(254*this.levels())+1,i=t.data,n=i.length,a=255/r;for(e=0;e<n;e+=1)i[e]=Math.floor(i[e]/a)*a},RGB:function(t){var e,r,i=t.data,n=i.length,a=this.red(),s=this.green(),o=this.blue();for(e=0;e<n;e+=4)r=(.34*i[e]+.5*i[e+1]+.16*i[e+2])/255,i[e]=r*a,i[e+1]=r*s,i[e+2]=r*o,i[e+3]=i[e+3]},RGBA:function(t){var e,r,i=t.data,n=i.length,a=this.red(),s=this.green(),o=this.blue(),h=this.alpha();for(e=0;e<n;e+=4)r=1-h,i[e]=a*h+i[e]*r,i[e+1]=s*h+i[e+1]*r,i[e+2]=o*h+i[e+2]*r},Sepia:function(t){var e,r,i,n,a=t.data,s=a.length;for(e=0;e<s;e+=4)r=a[e+0],i=a[e+1],n=a[e+2],a[e+0]=Math.min(255,.393*r+.769*i+.189*n),a[e+1]=Math.min(255,.349*r+.686*i+.168*n),a[e+2]=Math.min(255,.272*r+.534*i+.131*n)},Solarize:function(t){var e=t.data,r=t.width,i=4*r,n=t.height;do{var a=(n-1)*i,s=r;do{var o=a+4*(s-1),h=e[o],l=e[o+1],c=e[o+2];h>127&&(h=255-h),l>127&&(l=255-l),c>127&&(c=255-c),e[o]=h,e[o+1]=l,e[o+2]=c}while(--s)}while(--n)},Threshold:function(t){var e,r=255*this.threshold(),i=t.data,n=i.length;for(e=0;e<n;e+=1)i[e]=i[e]<r?0:255}}}),on=sn;var hn=r(9443),ln=r(2084),cn=r(3755);function un(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function dn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function gn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?dn(Object(r),!0).forEach((function(e){fn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function fn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const pn=function(t,e){var r=e,i=r.clientWidth,a=r.clientHeight,s=i/10,o=a/10,h=2.5,l=new on.Stage({container:r.id,width:i,height:a,id:t}),c={gridLayer:new on.Layer,shipsLayer:new on.Layer,attacksLayer:new on.Layer},u={water:document.createElement("canvas"),hit:document.createElement("canvas")};function d(t,e){var r=t.x,i=t.y,n=new on.Group({x:r,y:i,width:s*e,height:o,id:"ship-".concat(e,"-").concat(r,"-").concat(i),visible:l.id()===hn.O.PJ1});return n.add(new on.Rect({x:h,y:h,width:s*e-5,height:o-5,fill:"#007F5F",stroke:"#D4D700",strokeWidth:1,name:"body",draggable:l.id()===hn.O.PJ1})),n.add(new on.Rect({x:h,y:h,width:s*e-5,height:o-5,fill:"#80004A",stroke:"#FFE6E4",strokeWidth:1,name:"shadow",visible:!1})),c.shipsLayer.add(n),n}function g(t){var e=t.getAbsolutePosition();return e.x+t.width()<l.width()&&e.x>0&&e.y+t.height()<l.height()&&e.y>0}function f(t){var e=t.getClientRect(),r=t.getAbsolutePosition(),i=e.x-r.x,n=e.y-r.y,a=gn({},r);e.x<0&&(a.x=-i),e.y<0&&(a.y=-n),e.x+e.width>l.width()&&(a.x=l.width()-e.width-i),e.y+e.height>l.height()&&(a.y=l.height()-e.height-n),t.setAbsolutePosition(a)}function p(t){return t.getParent().find(".shadow")[0]}function v(t,e){90===t.rotation()?t.position({x:Math.round(e.x()/s)*s-h,y:Math.round(e.y()/o)*o+h}):t.position({x:Math.round(e.x()/s)*s+h,y:Math.round(e.y()/o)*o+h})}function m(t,e){var r=e.getClientRect();return t.find(".body").some((function(t){var i,n;if(t!==e)return i=t.getClientRect(),!((n=r).x>i.x+i.width+s||n.x+n.width+s<i.x||n.y>i.y+i.height+o||n.y+n.height+o<i.y)}))}function y(t){var e=p(t),r=gn({},t.getAttrs()),i=gn({},e.getAttrs()),n=t.rotation(),a=e.rotation();90===t.rotation()?(t.rotate(-90),t.x(r.x-t.height()),e.rotate(-90),e.x(i.x-e.height())):(t.rotate(90),t.x(r.x+t.height()),e.rotate(90),e.x(i.x+e.height())),f(t),f(e),m(c.shipsLayer,t)&&(t.rotation(n),t.setAttrs(r),e.rotation(n),e.setAttrs(a))}function x(t,e){return Math.round(Math.random()*(e-t))+t}function b(){var t=r.parentElement.clientWidth/i;l.width(i*t),l.height(a*t),l.scale({x:t,y:t})}c.gridLayer.listening(!1),c.attacksLayer.listening(!1),l.add(c.gridLayer),l.add(c.shipsLayer),l.add(c.attacksLayer);var _={newIcon:function(t){var e=t.iconType,r=t.coords,i=t.playerID;if(l.id()===i){var n=new on.Image({image:u[e],x:r.x*s,y:r.y*o,width:s,height:o,strokeWidth:1,scale:{x:.8,y:.8},opacity:.2}),a=n.getClientRect();n.position({x:a.x+(n.width()-a.width)/2,y:a.y+(n.height()-a.height)/2}),c.attacksLayer.add(n),n.to({duration:.5,opacity:1})}},showSunkenShip:function(e){var r=e.playerID,i=e.size,n=e.coords;if(r===t){var a=c.shipsLayer.findOne("#ship-".concat(i,"-").concat(n[1]*s,"-").concat(n[0]*o));a.setAttrs({visible:!0}),a.opacity(.25)}}};function S(t,e){_[t](e)}return window.addEventListener("load",(function(){b(),ie.from(u.water.getContext("2d"),ln).then((function(t){t.resize(s,o,"xMidYMid meet"),t.render()})),ie.from(u.hit.getContext("2d"),cn).then((function(t){t.resize(s,o,"xMidYMid meet"),t.render()}))})),window.addEventListener("resize",b),c.shipsLayer.on("click tap",(function(t){y(t.target)})),c.shipsLayer.on("dragstart",(function(t){l.container().style.cursor="grabbing";var e=p(t.target);e.show(),e.moveToTop(),t.target.moveToTop()})),c.shipsLayer.on("dragend",(function(t){l.container().style.cursor="grab";var e=p(t.target);v(t.target,e),l.batchDraw(),e.hide()})),c.shipsLayer.on("dragmove",(function(t){var e=p(t.target);f(t.target),f(e),m(c.shipsLayer,t.target)||v(e,t.target),l.batchDraw()})),c.shipsLayer.on("mouseenter",(function(){l.container().style.cursor="grab"})),c.shipsLayer.on("mouseleave",(function(){l.container().style.cursor="default"})),n().subscribe("newIcon",S),n().subscribe("showSunkenShip",S),{id:t,element:r,getShips:function(){var t=[];return c.shipsLayer.find(".body").forEach((function(e){var r=e.getAbsolutePosition(),i={};i.startCoords=[Math.floor(r.y/o),Math.floor(r.x/s)],i.direction=e.rotation()?hn.E.VERTICAL:hn.E.HORIZONTAL,i.size=Math.round(e.width()/s),t.push(i)})),t},drawBoard:function(){for(var t=s;t<i;t+=s)c.gridLayer.add(new on.Line({points:[t,0,t,a],stroke:"white",strokeWidth:1,dash:[10,5]}));for(var e=o;e<a;e+=o)c.gridLayer.add(new on.Line({points:[0,e,i,e],stroke:"white",strokeWidth:1,dash:[10,5]}))},newRectangle:d,placeRandom:function t(){-1===function(){for(var t=function(){for(var t=[],e=0;e<9;e+=1)for(var r=0;r<10;r+=1)t.push({x:s*e,y:o*r});return t}(),e=2;e<=5;e+=1)for(var r=e;r<=5;r+=1){var i=t[x(0,t.length-1)],n=d(i,e),a=n.children[0],h=!1,l=function(t){if(Array.isArray(t))return un(t)}(p=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(p)||function(t,e){if(t){if("string"==typeof t)return un(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?un(t,e):void 0}}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();do{if(!m(c.shipsLayer,a)&&g(a)){h=!0,t.splice(t.indexOf(i),1);break}var u=a.rotation();if(y(a),u!==a.rotation()){h=!0,t.splice(t.indexOf(i),1);break}if(l.splice(l.indexOf(i),1),0===l.length)return-1;i=l[x(0,l.length-1)],n.position(i)}while(!h);var f=n.id().replace(/((\d{1,3}(\.?\d{1,14})?)-(\d{1,3}(\.?\d{1,14})?))$/,"".concat(i.x,"-").concat(i.y));n.id(f)}var p;return c.shipsLayer}()&&(c.shipsLayer.removeChildren(),t())},startGame:function(){c.shipsLayer.listening(!1),l.on("click tap",(function(){var t=l.getPointerPosition();n().publishSync("playRound",{id:l.id(),coords:[Math.floor(t.y/o),Math.floor(t.x/s)]})}))},subcriptionHandler:S}}},9443:(t,e,r)=>{"use strict";r.d(e,{O:()=>i,E:()=>n});var i={PJ1:"player1",PJ2:"player2"};Object.freeze(i);var n={HORIZONTAL:"horizontal",VERTICAL:"vertical"};Object.freeze(n)},9662:(t,e,r)=>{var i=r(7854),n=r(614),a=r(6330),s=i.TypeError;t.exports=function(t){if(n(t))return t;throw s(a(t)+" is not a function")}},9483:(t,e,r)=>{var i=r(7854),n=r(4411),a=r(6330),s=i.TypeError;t.exports=function(t){if(n(t))return t;throw s(a(t)+" is not a constructor")}},6077:(t,e,r)=>{var i=r(7854),n=r(614),a=i.String,s=i.TypeError;t.exports=function(t){if("object"==typeof t||n(t))return t;throw s("Can't set "+a(t)+" as a prototype")}},1223:(t,e,r)=>{var i=r(5112),n=r(30),a=r(3070),s=i("unscopables"),o=Array.prototype;null==o[s]&&a.f(o,s,{configurable:!0,value:n(null)}),t.exports=function(t){o[s][t]=!0}},1530:(t,e,r)=>{"use strict";var i=r(8710).charAt;t.exports=function(t,e,r){return e+(r?i(t,e).length:1)}},5787:(t,e,r)=>{var i=r(7854),n=r(7976),a=i.TypeError;t.exports=function(t,e){if(n(e,t))return t;throw a("Incorrect invocation")}},9670:(t,e,r)=>{var i=r(7854),n=r(111),a=i.String,s=i.TypeError;t.exports=function(t){if(n(t))return t;throw s(a(t)+" is not an object")}},1318:(t,e,r)=>{var i=r(5656),n=r(1400),a=r(6244),s=function(t){return function(e,r,s){var o,h=i(e),l=a(h),c=n(s,l);if(t&&r!=r){for(;l>c;)if((o=h[c++])!=o)return!0}else for(;l>c;c++)if((t||c in h)&&h[c]===r)return t||c||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},9341:(t,e,r)=>{"use strict";var i=r(7293);t.exports=function(t,e){var r=[][t];return!!r&&i((function(){r.call(null,e||function(){throw 1},1)}))}},3671:(t,e,r)=>{var i=r(7854),n=r(9662),a=r(7908),s=r(8361),o=r(6244),h=i.TypeError,l=function(t){return function(e,r,i,l){n(r);var c=a(e),u=s(c),d=o(c),g=t?d-1:0,f=t?-1:1;if(i<2)for(;;){if(g in u){l=u[g],g+=f;break}if(g+=f,t?g<0:d<=g)throw h("Reduce of empty array with no initial value")}for(;t?g>=0:d>g;g+=f)g in u&&(l=r(l,u[g],g,c));return l}};t.exports={left:l(!1),right:l(!0)}},206:(t,e,r)=>{var i=r(1702);t.exports=i([].slice)},7072:(t,e,r)=>{var i=r(5112)("iterator"),n=!1;try{var a=0,s={next:function(){return{done:!!a++}},return:function(){n=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!n)return!1;var r=!1;try{var a={};a[i]=function(){return{next:function(){return{done:r=!0}}}},t(a)}catch(t){}return r}},4326:(t,e,r)=>{var i=r(1702),n=i({}.toString),a=i("".slice);t.exports=function(t){return a(n(t),8,-1)}},648:(t,e,r)=>{var i=r(7854),n=r(1694),a=r(614),s=r(4326),o=r(5112)("toStringTag"),h=i.Object,l="Arguments"==s(function(){return arguments}());t.exports=n?s:function(t){var e,r,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=h(t),o))?r:l?s(e):"Object"==(i=s(e))&&a(e.callee)?"Arguments":i}},9920:(t,e,r)=>{var i=r(2597),n=r(3887),a=r(1236),s=r(3070);t.exports=function(t,e){for(var r=n(e),o=s.f,h=a.f,l=0;l<r.length;l++){var c=r[l];i(t,c)||o(t,c,h(e,c))}}},4964:(t,e,r)=>{var i=r(5112)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[i]=!1,"/./"[t](e)}catch(t){}}return!1}},8544:(t,e,r)=>{var i=r(7293);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},4994:(t,e,r)=>{"use strict";var i=r(3383).IteratorPrototype,n=r(30),a=r(9114),s=r(8003),o=r(7497),h=function(){return this};t.exports=function(t,e,r){var l=e+" Iterator";return t.prototype=n(i,{next:a(1,r)}),s(t,l,!1,!0),o[l]=h,t}},8880:(t,e,r)=>{var i=r(9781),n=r(3070),a=r(9114);t.exports=i?function(t,e,r){return n.f(t,e,a(1,r))}:function(t,e,r){return t[e]=r,t}},9114:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},654:(t,e,r)=>{"use strict";var i=r(2109),n=r(6916),a=r(1913),s=r(6530),o=r(614),h=r(4994),l=r(9518),c=r(7674),u=r(8003),d=r(8880),g=r(1320),f=r(5112),p=r(7497),v=r(3383),m=s.PROPER,y=s.CONFIGURABLE,x=v.IteratorPrototype,b=v.BUGGY_SAFARI_ITERATORS,_=f("iterator"),S="keys",w="values",C="entries",P=function(){return this};t.exports=function(t,e,r,s,f,v,A){h(r,e,s);var T,O,k,M=function(t){if(t===f&&I)return I;if(!b&&t in L)return L[t];switch(t){case S:case w:case C:return function(){return new r(this,t)}}return function(){return new r(this)}},E=e+" Iterator",R=!1,L=t.prototype,N=L[_]||L["@@iterator"]||f&&L[f],I=!b&&N||M(f),D="Array"==e&&L.entries||N;if(D&&(T=l(D.call(new t)))!==Object.prototype&&T.next&&(a||l(T)===x||(c?c(T,x):o(T[_])||g(T,_,P)),u(T,E,!0,!0),a&&(p[E]=P)),m&&f==w&&N&&N.name!==w&&(!a&&y?d(L,"name",w):(R=!0,I=function(){return n(N,this)})),f)if(O={values:M(w),keys:v?I:M(S),entries:M(C)},A)for(k in O)(b||R||!(k in L))&&g(L,k,O[k]);else i({target:e,proto:!0,forced:b||R},O);return a&&!A||L[_]===I||g(L,_,I,{name:f}),p[e]=I,O}},9781:(t,e,r)=>{var i=r(7293);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:(t,e,r)=>{var i=r(7854),n=r(111),a=i.document,s=n(a)&&n(a.createElement);t.exports=function(t){return s?a.createElement(t):{}}},8324:t=>{t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(t,e,r)=>{var i=r(317)("span").classList,n=i&&i.constructor&&i.constructor.prototype;t.exports=n===Object.prototype?void 0:n},7871:t=>{t.exports="object"==typeof window},1528:(t,e,r)=>{var i=r(8113),n=r(7854);t.exports=/ipad|iphone|ipod/i.test(i)&&void 0!==n.Pebble},6833:(t,e,r)=>{var i=r(8113);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},5268:(t,e,r)=>{var i=r(4326),n=r(7854);t.exports="process"==i(n.process)},1036:(t,e,r)=>{var i=r(8113);t.exports=/web0s(?!.*chrome)/i.test(i)},8113:(t,e,r)=>{var i=r(5005);t.exports=i("navigator","userAgent")||""},7392:(t,e,r)=>{var i,n,a=r(7854),s=r(8113),o=a.process,h=a.Deno,l=o&&o.versions||h&&h.version,c=l&&l.v8;c&&(n=(i=c.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!n&&s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(n=+i[1]),t.exports=n},748:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:(t,e,r)=>{var i=r(7854),n=r(1236).f,a=r(8880),s=r(1320),o=r(3505),h=r(9920),l=r(4705);t.exports=function(t,e){var r,c,u,d,g,f=t.target,p=t.global,v=t.stat;if(r=p?i:v?i[f]||o(f,{}):(i[f]||{}).prototype)for(c in e){if(d=e[c],u=t.noTargetGet?(g=n(r,c))&&g.value:r[c],!l(p?c:f+(v?".":"#")+c,t.forced)&&void 0!==u){if(typeof d==typeof u)continue;h(d,u)}(t.sham||u&&u.sham)&&a(d,"sham",!0),s(r,c,d,t)}}},7293:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},7007:(t,e,r)=>{"use strict";r(4916);var i=r(1702),n=r(1320),a=r(2261),s=r(7293),o=r(5112),h=r(8880),l=o("species"),c=RegExp.prototype;t.exports=function(t,e,r,u){var d=o(t),g=!s((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),f=g&&!s((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[l]=function(){return r},r.flags="",r[d]=/./[d]),r.exec=function(){return e=!0,null},r[d](""),!e}));if(!g||!f||r){var p=i(/./[d]),v=e(d,""[t],(function(t,e,r,n,s){var o=i(t),h=e.exec;return h===a||h===c.exec?g&&!s?{done:!0,value:p(e,r,n)}:{done:!0,value:o(r,e,n)}:{done:!1}}));n(String.prototype,t,v[0]),n(c,d,v[1])}u&&h(c[d],"sham",!0)}},2104:t=>{var e=Function.prototype,r=e.apply,i=e.bind,n=e.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?n.bind(r):function(){return n.apply(r,arguments)})},9974:(t,e,r)=>{var i=r(1702),n=r(9662),a=i(i.bind);t.exports=function(t,e){return n(t),void 0===e?t:a?a(t,e):function(){return t.apply(e,arguments)}}},6916:t=>{var e=Function.prototype.call;t.exports=e.bind?e.bind(e):function(){return e.apply(e,arguments)}},6530:(t,e,r)=>{var i=r(9781),n=r(2597),a=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,o=n(a,"name"),h=o&&"something"===function(){}.name,l=o&&(!i||i&&s(a,"name").configurable);t.exports={EXISTS:o,PROPER:h,CONFIGURABLE:l}},1702:t=>{var e=Function.prototype,r=e.bind,i=e.call,n=r&&r.bind(i);t.exports=r?function(t){return t&&n(i,t)}:function(t){return t&&function(){return i.apply(t,arguments)}}},5005:(t,e,r)=>{var i=r(7854),n=r(614),a=function(t){return n(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?a(i[t]):i[t]&&i[t][e]}},1246:(t,e,r)=>{var i=r(648),n=r(8173),a=r(7497),s=r(5112)("iterator");t.exports=function(t){if(null!=t)return n(t,s)||n(t,"@@iterator")||a[i(t)]}},8554:(t,e,r)=>{var i=r(7854),n=r(6916),a=r(9662),s=r(9670),o=r(6330),h=r(1246),l=i.TypeError;t.exports=function(t,e){var r=arguments.length<2?h(t):e;if(a(r))return s(n(r,t));throw l(o(t)+" is not iterable")}},8173:(t,e,r)=>{var i=r(9662);t.exports=function(t,e){var r=t[e];return null==r?void 0:i(r)}},647:(t,e,r)=>{var i=r(1702),n=r(7908),a=Math.floor,s=i("".charAt),o=i("".replace),h=i("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,r,i,u,d){var g=r+t.length,f=i.length,p=c;return void 0!==u&&(u=n(u),p=l),o(d,p,(function(n,o){var l;switch(s(o,0)){case"$":return"$";case"&":return t;case"`":return h(e,0,r);case"'":return h(e,g);case"<":l=u[h(o,1,-1)];break;default:var c=+o;if(0===c)return n;if(c>f){var d=a(c/10);return 0===d?n:d<=f?void 0===i[d-1]?s(o,1):i[d-1]+s(o,1):n}l=i[c-1]}return void 0===l?"":l}))}},7854:(t,e,r)=>{var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},2597:(t,e,r)=>{var i=r(1702),n=r(7908),a=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return a(n(t),e)}},3501:t=>{t.exports={}},842:(t,e,r)=>{var i=r(7854);t.exports=function(t,e){var r=i.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}},490:(t,e,r)=>{var i=r(5005);t.exports=i("document","documentElement")},4664:(t,e,r)=>{var i=r(9781),n=r(7293),a=r(317);t.exports=!i&&!n((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},8361:(t,e,r)=>{var i=r(7854),n=r(1702),a=r(7293),s=r(4326),o=i.Object,h=n("".split);t.exports=a((function(){return!o("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?h(t,""):o(t)}:o},2788:(t,e,r)=>{var i=r(1702),n=r(614),a=r(5465),s=i(Function.toString);n(a.inspectSource)||(a.inspectSource=function(t){return s(t)}),t.exports=a.inspectSource},9909:(t,e,r)=>{var i,n,a,s=r(8536),o=r(7854),h=r(1702),l=r(111),c=r(8880),u=r(2597),d=r(5465),g=r(6200),f=r(3501),p="Object already initialized",v=o.TypeError,m=o.WeakMap;if(s||d.state){var y=d.state||(d.state=new m),x=h(y.get),b=h(y.has),_=h(y.set);i=function(t,e){if(b(y,t))throw new v(p);return e.facade=t,_(y,t,e),e},n=function(t){return x(y,t)||{}},a=function(t){return b(y,t)}}else{var S=g("state");f[S]=!0,i=function(t,e){if(u(t,S))throw new v(p);return e.facade=t,c(t,S,e),e},n=function(t){return u(t,S)?t[S]:{}},a=function(t){return u(t,S)}}t.exports={set:i,get:n,has:a,enforce:function(t){return a(t)?n(t):i(t,{})},getterFor:function(t){return function(e){var r;if(!l(e)||(r=n(e)).type!==t)throw v("Incompatible receiver, "+t+" required");return r}}}},7659:(t,e,r)=>{var i=r(5112),n=r(7497),a=i("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||s[a]===t)}},1349:(t,e,r)=>{var i=r(4326);t.exports=Array.isArray||function(t){return"Array"==i(t)}},614:t=>{t.exports=function(t){return"function"==typeof t}},4411:(t,e,r)=>{var i=r(1702),n=r(7293),a=r(614),s=r(648),o=r(5005),h=r(2788),l=function(){},c=[],u=o("Reflect","construct"),d=/^\s*(?:class|function)\b/,g=i(d.exec),f=!d.exec(l),p=function(t){if(!a(t))return!1;try{return u(l,c,t),!0}catch(t){return!1}};t.exports=!u||n((function(){var t;return p(p.call)||!p(Object)||!p((function(){t=!0}))||t}))?function(t){if(!a(t))return!1;switch(s(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return f||!!g(d,h(t))}:p},4705:(t,e,r)=>{var i=r(7293),n=r(614),a=/#|\.prototype\./,s=function(t,e){var r=h[o(t)];return r==c||r!=l&&(n(e)?i(e):!!e)},o=s.normalize=function(t){return String(t).replace(a,".").toLowerCase()},h=s.data={},l=s.NATIVE="N",c=s.POLYFILL="P";t.exports=s},111:(t,e,r)=>{var i=r(614);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},1913:t=>{t.exports=!1},7850:(t,e,r)=>{var i=r(111),n=r(4326),a=r(5112)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==n(t))}},2190:(t,e,r)=>{var i=r(7854),n=r(5005),a=r(614),s=r(7976),o=r(3307),h=i.Object;t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return a(e)&&s(e.prototype,h(t))}},408:(t,e,r)=>{var i=r(7854),n=r(9974),a=r(6916),s=r(9670),o=r(6330),h=r(7659),l=r(6244),c=r(7976),u=r(8554),d=r(1246),g=r(9212),f=i.TypeError,p=function(t,e){this.stopped=t,this.result=e},v=p.prototype;t.exports=function(t,e,r){var i,m,y,x,b,_,S,w=r&&r.that,C=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),T=n(e,w),O=function(t){return i&&g(i,"normal",t),new p(!0,t)},k=function(t){return C?(s(t),A?T(t[0],t[1],O):T(t[0],t[1])):A?T(t,O):T(t)};if(P)i=t;else{if(!(m=d(t)))throw f(o(t)+" is not iterable");if(h(m)){for(y=0,x=l(t);x>y;y++)if((b=k(t[y]))&&c(v,b))return b;return new p(!1)}i=u(t,m)}for(_=i.next;!(S=a(_,i)).done;){try{b=k(S.value)}catch(t){g(i,"throw",t)}if("object"==typeof b&&b&&c(v,b))return b}return new p(!1)}},9212:(t,e,r)=>{var i=r(6916),n=r(9670),a=r(8173);t.exports=function(t,e,r){var s,o;n(t);try{if(!(s=a(t,"return"))){if("throw"===e)throw r;return r}s=i(s,t)}catch(t){o=!0,s=t}if("throw"===e)throw r;if(o)throw s;return n(s),r}},3383:(t,e,r)=>{"use strict";var i,n,a,s=r(7293),o=r(614),h=r(30),l=r(9518),c=r(1320),u=r(5112),d=r(1913),g=u("iterator"),f=!1;[].keys&&("next"in(a=[].keys())?(n=l(l(a)))!==Object.prototype&&(i=n):f=!0),null==i||s((function(){var t={};return i[g].call(t)!==t}))?i={}:d&&(i=h(i)),o(i[g])||c(i,g,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},7497:t=>{t.exports={}},6244:(t,e,r)=>{var i=r(7466);t.exports=function(t){return i(t.length)}},5948:(t,e,r)=>{var i,n,a,s,o,h,l,c,u=r(7854),d=r(9974),g=r(1236).f,f=r(261).set,p=r(6833),v=r(1528),m=r(1036),y=r(5268),x=u.MutationObserver||u.WebKitMutationObserver,b=u.document,_=u.process,S=u.Promise,w=g(u,"queueMicrotask"),C=w&&w.value;C||(i=function(){var t,e;for(y&&(t=_.domain)&&t.exit();n;){e=n.fn,n=n.next;try{e()}catch(t){throw n?s():a=void 0,t}}a=void 0,t&&t.enter()},p||y||m||!x||!b?!v&&S&&S.resolve?((l=S.resolve(void 0)).constructor=S,c=d(l.then,l),s=function(){c(i)}):y?s=function(){_.nextTick(i)}:(f=d(f,u),s=function(){f(i)}):(o=!0,h=b.createTextNode(""),new x(i).observe(h,{characterData:!0}),s=function(){h.data=o=!o})),t.exports=C||function(t){var e={fn:t,next:void 0};a&&(a.next=e),n||(n=e,s()),a=e}},3366:(t,e,r)=>{var i=r(7854);t.exports=i.Promise},133:(t,e,r)=>{var i=r(7392),n=r(7293);t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},8536:(t,e,r)=>{var i=r(7854),n=r(614),a=r(2788),s=i.WeakMap;t.exports=n(s)&&/native code/.test(a(s))},8523:(t,e,r)=>{"use strict";var i=r(9662),n=function(t){var e,r;this.promise=new t((function(t,i){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=i})),this.resolve=i(e),this.reject=i(r)};t.exports.f=function(t){return new n(t)}},3929:(t,e,r)=>{var i=r(7854),n=r(7850),a=i.TypeError;t.exports=function(t){if(n(t))throw a("The method doesn't accept regular expressions");return t}},30:(t,e,r)=>{var i,n=r(9670),a=r(6048),s=r(748),o=r(3501),h=r(490),l=r(317),c=r(6200)("IE_PROTO"),u=function(){},d=function(t){return"<script>"+t+"<\/script>"},g=function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e},f=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}var t,e;f="undefined"!=typeof document?document.domain&&i?g(i):((e=l("iframe")).style.display="none",h.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F):g(i);for(var r=s.length;r--;)delete f.prototype[s[r]];return f()};o[c]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(u.prototype=n(t),r=new u,u.prototype=null,r[c]=t):r=f(),void 0===e?r:a(r,e)}},6048:(t,e,r)=>{var i=r(9781),n=r(3070),a=r(9670),s=r(5656),o=r(1956);t.exports=i?Object.defineProperties:function(t,e){a(t);for(var r,i=s(e),h=o(e),l=h.length,c=0;l>c;)n.f(t,r=h[c++],i[r]);return t}},3070:(t,e,r)=>{var i=r(7854),n=r(9781),a=r(4664),s=r(9670),o=r(4948),h=i.TypeError,l=Object.defineProperty;e.f=n?l:function(t,e,r){if(s(t),e=o(e),s(r),a)try{return l(t,e,r)}catch(t){}if("get"in r||"set"in r)throw h("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},1236:(t,e,r)=>{var i=r(9781),n=r(6916),a=r(5296),s=r(9114),o=r(5656),h=r(4948),l=r(2597),c=r(4664),u=Object.getOwnPropertyDescriptor;e.f=i?u:function(t,e){if(t=o(t),e=h(e),c)try{return u(t,e)}catch(t){}if(l(t,e))return s(!n(a.f,t,e),t[e])}},8006:(t,e,r)=>{var i=r(6324),n=r(748).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,n)}},5181:(t,e)=>{e.f=Object.getOwnPropertySymbols},9518:(t,e,r)=>{var i=r(7854),n=r(2597),a=r(614),s=r(7908),o=r(6200),h=r(8544),l=o("IE_PROTO"),c=i.Object,u=c.prototype;t.exports=h?c.getPrototypeOf:function(t){var e=s(t);if(n(e,l))return e[l];var r=e.constructor;return a(r)&&e instanceof r?r.prototype:e instanceof c?u:null}},7976:(t,e,r)=>{var i=r(1702);t.exports=i({}.isPrototypeOf)},6324:(t,e,r)=>{var i=r(1702),n=r(2597),a=r(5656),s=r(1318).indexOf,o=r(3501),h=i([].push);t.exports=function(t,e){var r,i=a(t),l=0,c=[];for(r in i)!n(o,r)&&n(i,r)&&h(c,r);for(;e.length>l;)n(i,r=e[l++])&&(~s(c,r)||h(c,r));return c}},1956:(t,e,r)=>{var i=r(6324),n=r(748);t.exports=Object.keys||function(t){return i(t,n)}},5296:(t,e)=>{"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,n=i&&!r.call({1:2},1);e.f=n?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},7674:(t,e,r)=>{var i=r(1702),n=r(9670),a=r(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,i){return n(r),a(i),e?t(r,i):r.__proto__=i,r}}():void 0)},2140:(t,e,r)=>{var i=r(7854),n=r(6916),a=r(614),s=r(111),o=i.TypeError;t.exports=function(t,e){var r,i;if("string"===e&&a(r=t.toString)&&!s(i=n(r,t)))return i;if(a(r=t.valueOf)&&!s(i=n(r,t)))return i;if("string"!==e&&a(r=t.toString)&&!s(i=n(r,t)))return i;throw o("Can't convert object to primitive value")}},3887:(t,e,r)=>{var i=r(5005),n=r(1702),a=r(8006),s=r(5181),o=r(9670),h=n([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=a.f(o(t)),r=s.f;return r?h(e,r(t)):e}},2534:t=>{t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},9478:(t,e,r)=>{var i=r(9670),n=r(111),a=r(8523);t.exports=function(t,e){if(i(t),n(e)&&e.constructor===t)return e;var r=a.f(t);return(0,r.resolve)(e),r.promise}},2248:(t,e,r)=>{var i=r(1320);t.exports=function(t,e,r){for(var n in e)i(t,n,e[n],r);return t}},1320:(t,e,r)=>{var i=r(7854),n=r(614),a=r(2597),s=r(8880),o=r(3505),h=r(2788),l=r(9909),c=r(6530).CONFIGURABLE,u=l.get,d=l.enforce,g=String(String).split("String");(t.exports=function(t,e,r,h){var l,u=!!h&&!!h.unsafe,f=!!h&&!!h.enumerable,p=!!h&&!!h.noTargetGet,v=h&&void 0!==h.name?h.name:e;n(r)&&("Symbol("===String(v).slice(0,7)&&(v="["+String(v).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!a(r,"name")||c&&r.name!==v)&&s(r,"name",v),(l=d(r)).source||(l.source=g.join("string"==typeof v?v:""))),t!==i?(u?!p&&t[e]&&(f=!0):delete t[e],f?t[e]=r:s(t,e,r)):f?t[e]=r:o(e,r)})(Function.prototype,"toString",(function(){return n(this)&&u(this).source||h(this)}))},7651:(t,e,r)=>{var i=r(7854),n=r(6916),a=r(9670),s=r(614),o=r(4326),h=r(2261),l=i.TypeError;t.exports=function(t,e){var r=t.exec;if(s(r)){var i=n(r,t,e);return null!==i&&a(i),i}if("RegExp"===o(t))return n(h,t,e);throw l("RegExp#exec called on incompatible receiver")}},2261:(t,e,r)=>{"use strict";var i,n,a=r(6916),s=r(1702),o=r(1340),h=r(7066),l=r(2999),c=r(2309),u=r(30),d=r(9909).get,g=r(9441),f=r(7168),p=c("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,m=v,y=s("".charAt),x=s("".indexOf),b=s("".replace),_=s("".slice),S=(n=/b*/g,a(v,i=/a/,"a"),a(v,n,"a"),0!==i.lastIndex||0!==n.lastIndex),w=l.UNSUPPORTED_Y||l.BROKEN_CARET,C=void 0!==/()??/.exec("")[1];(S||C||w||g||f)&&(m=function(t){var e,r,i,n,s,l,c,g=this,f=d(g),P=o(t),A=f.raw;if(A)return A.lastIndex=g.lastIndex,e=a(m,A,P),g.lastIndex=A.lastIndex,e;var T=f.groups,O=w&&g.sticky,k=a(h,g),M=g.source,E=0,R=P;if(O&&(k=b(k,"y",""),-1===x(k,"g")&&(k+="g"),R=_(P,g.lastIndex),g.lastIndex>0&&(!g.multiline||g.multiline&&"\n"!==y(P,g.lastIndex-1))&&(M="(?: "+M+")",R=" "+R,E++),r=new RegExp("^(?:"+M+")",k)),C&&(r=new RegExp("^"+M+"$(?!\\s)",k)),S&&(i=g.lastIndex),n=a(v,O?r:g,R),O?n?(n.input=_(n.input,E),n[0]=_(n[0],E),n.index=g.lastIndex,g.lastIndex+=n[0].length):g.lastIndex=0:S&&n&&(g.lastIndex=g.global?n.index+n[0].length:i),C&&n&&n.length>1&&a(p,n[0],r,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(n[s]=void 0)})),n&&T)for(n.groups=l=u(null),s=0;s<T.length;s++)l[(c=T[s])[0]]=n[c[1]];return n}),t.exports=m},7066:(t,e,r)=>{"use strict";var i=r(9670);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},2999:(t,e,r)=>{var i=r(7293),n=r(7854).RegExp;e.UNSUPPORTED_Y=i((function(){var t=n("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=i((function(){var t=n("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},9441:(t,e,r)=>{var i=r(7293),n=r(7854).RegExp;t.exports=i((function(){var t=n(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))},7168:(t,e,r)=>{var i=r(7293),n=r(7854).RegExp;t.exports=i((function(){var t=n("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},4488:(t,e,r)=>{var i=r(7854).TypeError;t.exports=function(t){if(null==t)throw i("Can't call method on "+t);return t}},3505:(t,e,r)=>{var i=r(7854),n=Object.defineProperty;t.exports=function(t,e){try{n(i,t,{value:e,configurable:!0,writable:!0})}catch(r){i[t]=e}return e}},6340:(t,e,r)=>{"use strict";var i=r(5005),n=r(3070),a=r(5112),s=r(9781),o=a("species");t.exports=function(t){var e=i(t),r=n.f;s&&e&&!e[o]&&r(e,o,{configurable:!0,get:function(){return this}})}},8003:(t,e,r)=>{var i=r(3070).f,n=r(2597),a=r(5112)("toStringTag");t.exports=function(t,e,r){t&&!n(t=r?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},6200:(t,e,r)=>{var i=r(2309),n=r(9711),a=i("keys");t.exports=function(t){return a[t]||(a[t]=n(t))}},5465:(t,e,r)=>{var i=r(7854),n=r(3505),a="__core-js_shared__",s=i[a]||n(a,{});t.exports=s},2309:(t,e,r)=>{var i=r(1913),n=r(5465);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.19.1",mode:i?"pure":"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})},6707:(t,e,r)=>{var i=r(9670),n=r(9483),a=r(5112)("species");t.exports=function(t,e){var r,s=i(t).constructor;return void 0===s||null==(r=i(s)[a])?e:n(r)}},8710:(t,e,r)=>{var i=r(1702),n=r(9303),a=r(1340),s=r(4488),o=i("".charAt),h=i("".charCodeAt),l=i("".slice),c=function(t){return function(e,r){var i,c,u=a(s(e)),d=n(r),g=u.length;return d<0||d>=g?t?"":void 0:(i=h(u,d))<55296||i>56319||d+1===g||(c=h(u,d+1))<56320||c>57343?t?o(u,d):i:t?l(u,d,d+2):c-56320+(i-55296<<10)+65536}};t.exports={codeAt:c(!1),charAt:c(!0)}},153:(t,e,r)=>{var i=r(6530).PROPER,n=r(7293),a=r(1361);t.exports=function(t){return n((function(){return!!a[t]()||""!==""[t]()||i&&a[t].name!==t}))}},3111:(t,e,r)=>{var i=r(1702),n=r(4488),a=r(1340),s=r(1361),o=i("".replace),h="["+s+"]",l=RegExp("^"+h+h+"*"),c=RegExp(h+h+"*$"),u=function(t){return function(e){var r=a(n(e));return 1&t&&(r=o(r,l,"")),2&t&&(r=o(r,c,"")),r}};t.exports={start:u(1),end:u(2),trim:u(3)}},261:(t,e,r)=>{var i,n,a,s,o=r(7854),h=r(2104),l=r(9974),c=r(614),u=r(2597),d=r(7293),g=r(490),f=r(206),p=r(317),v=r(6833),m=r(5268),y=o.setImmediate,x=o.clearImmediate,b=o.process,_=o.Dispatch,S=o.Function,w=o.MessageChannel,C=o.String,P=0,A={};try{i=o.location}catch(t){}var T=function(t){if(u(A,t)){var e=A[t];delete A[t],e()}},O=function(t){return function(){T(t)}},k=function(t){T(t.data)},M=function(t){o.postMessage(C(t),i.protocol+"//"+i.host)};y&&x||(y=function(t){var e=f(arguments,1);return A[++P]=function(){h(c(t)?t:S(t),void 0,e)},n(P),P},x=function(t){delete A[t]},m?n=function(t){b.nextTick(O(t))}:_&&_.now?n=function(t){_.now(O(t))}:w&&!v?(s=(a=new w).port2,a.port1.onmessage=k,n=l(s.postMessage,s)):o.addEventListener&&c(o.postMessage)&&!o.importScripts&&i&&"file:"!==i.protocol&&!d(M)?(n=M,o.addEventListener("message",k,!1)):n="onreadystatechange"in p("script")?function(t){g.appendChild(p("script")).onreadystatechange=function(){g.removeChild(this),T(t)}}:function(t){setTimeout(O(t),0)}),t.exports={set:y,clear:x}},1400:(t,e,r)=>{var i=r(9303),n=Math.max,a=Math.min;t.exports=function(t,e){var r=i(t);return r<0?n(r+e,0):a(r,e)}},5656:(t,e,r)=>{var i=r(8361),n=r(4488);t.exports=function(t){return i(n(t))}},9303:t=>{var e=Math.ceil,r=Math.floor;t.exports=function(t){var i=+t;return i!=i||0===i?0:(i>0?r:e)(i)}},7466:(t,e,r)=>{var i=r(9303),n=Math.min;t.exports=function(t){return t>0?n(i(t),9007199254740991):0}},7908:(t,e,r)=>{var i=r(7854),n=r(4488),a=i.Object;t.exports=function(t){return a(n(t))}},7593:(t,e,r)=>{var i=r(7854),n=r(6916),a=r(111),s=r(2190),o=r(8173),h=r(2140),l=r(5112),c=i.TypeError,u=l("toPrimitive");t.exports=function(t,e){if(!a(t)||s(t))return t;var r,i=o(t,u);if(i){if(void 0===e&&(e="default"),r=n(i,t,e),!a(r)||s(r))return r;throw c("Can't convert object to primitive value")}return void 0===e&&(e="number"),h(t,e)}},4948:(t,e,r)=>{var i=r(7593),n=r(2190);t.exports=function(t){var e=i(t,"string");return n(e)?e:e+""}},1694:(t,e,r)=>{var i={};i[r(5112)("toStringTag")]="z",t.exports="[object z]"===String(i)},1340:(t,e,r)=>{var i=r(7854),n=r(648),a=i.String;t.exports=function(t){if("Symbol"===n(t))throw TypeError("Cannot convert a Symbol value to a string");return a(t)}},6330:(t,e,r)=>{var i=r(7854).String;t.exports=function(t){try{return i(t)}catch(t){return"Object"}}},9711:(t,e,r)=>{var i=r(1702),n=0,a=Math.random(),s=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++n+a,36)}},3307:(t,e,r)=>{var i=r(133);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5112:(t,e,r)=>{var i=r(7854),n=r(2309),a=r(2597),s=r(9711),o=r(133),h=r(3307),l=n("wks"),c=i.Symbol,u=c&&c.for,d=h?c:c&&c.withoutSetter||s;t.exports=function(t){if(!a(l,t)||!o&&"string"!=typeof l[t]){var e="Symbol."+t;o&&a(c,t)?l[t]=c[t]:l[t]=h&&u?u(e):d(e)}return l[t]}},1361:t=>{t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},2772:(t,e,r)=>{"use strict";var i=r(2109),n=r(1702),a=r(1318).indexOf,s=r(9341),o=n([].indexOf),h=!!o&&1/o([1],1,-0)<0,l=s("indexOf");i({target:"Array",proto:!0,forced:h||!l},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return h?o(this,t,e)||0:a(this,t,e)}})},6992:(t,e,r)=>{"use strict";var i=r(5656),n=r(1223),a=r(7497),s=r(9909),o=r(654),h="Array Iterator",l=s.set,c=s.getterFor(h);t.exports=o(Array,"Array",(function(t,e){l(this,{type:h,target:i(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,r=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},5827:(t,e,r)=>{"use strict";var i=r(2109),n=r(3671).left,a=r(9341),s=r(7392),o=r(5268);i({target:"Array",proto:!0,forced:!a("reduce")||!o&&s>79&&s<83},{reduce:function(t){var e=arguments.length;return n(this,t,e,e>1?arguments[1]:void 0)}})},5069:(t,e,r)=>{"use strict";var i=r(2109),n=r(1702),a=r(1349),s=n([].reverse),o=[1,2];i({target:"Array",proto:!0,forced:String(o)===String(o.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),s(this)}})},8674:(t,e,r)=>{"use strict";var i,n,a,s,o=r(2109),h=r(1913),l=r(7854),c=r(5005),u=r(6916),d=r(3366),g=r(1320),f=r(2248),p=r(7674),v=r(8003),m=r(6340),y=r(9662),x=r(614),b=r(111),_=r(5787),S=r(2788),w=r(408),C=r(7072),P=r(6707),A=r(261).set,T=r(5948),O=r(9478),k=r(842),M=r(8523),E=r(2534),R=r(9909),L=r(4705),N=r(5112),I=r(7871),D=r(5268),G=r(7392),F=N("species"),V="Promise",B=R.get,z=R.set,j=R.getterFor(V),H=d&&d.prototype,W=d,U=H,Y=l.TypeError,X=l.document,q=l.process,Q=M.f,$=Q,Z=!!(X&&X.createEvent&&l.dispatchEvent),K=x(l.PromiseRejectionEvent),J="unhandledrejection",tt=!1,et=L(V,(function(){var t=S(W),e=t!==String(W);if(!e&&66===G)return!0;if(h&&!U.finally)return!0;if(G>=51&&/native code/.test(t))return!1;var r=new W((function(t){t(1)})),i=function(t){t((function(){}),(function(){}))};return(r.constructor={})[F]=i,!(tt=r.then((function(){}))instanceof i)||!e&&I&&!K})),rt=et||!C((function(t){W.all(t).catch((function(){}))})),it=function(t){var e;return!(!b(t)||!x(e=t.then))&&e},nt=function(t,e){if(!t.notified){t.notified=!0;var r=t.reactions;T((function(){for(var i=t.value,n=1==t.state,a=0;r.length>a;){var s,o,h,l=r[a++],c=n?l.ok:l.fail,d=l.resolve,g=l.reject,f=l.domain;try{c?(n||(2===t.rejection&&ht(t),t.rejection=1),!0===c?s=i:(f&&f.enter(),s=c(i),f&&(f.exit(),h=!0)),s===l.promise?g(Y("Promise-chain cycle")):(o=it(s))?u(o,s,d,g):d(s)):g(i)}catch(t){f&&!h&&f.exit(),g(t)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&st(t)}))}},at=function(t,e,r){var i,n;Z?((i=X.createEvent("Event")).promise=e,i.reason=r,i.initEvent(t,!1,!0),l.dispatchEvent(i)):i={promise:e,reason:r},!K&&(n=l["on"+t])?n(i):t===J&&k("Unhandled promise rejection",r)},st=function(t){u(A,l,(function(){var e,r=t.facade,i=t.value;if(ot(t)&&(e=E((function(){D?q.emit("unhandledRejection",i,r):at(J,r,i)})),t.rejection=D||ot(t)?2:1,e.error))throw e.value}))},ot=function(t){return 1!==t.rejection&&!t.parent},ht=function(t){u(A,l,(function(){var e=t.facade;D?q.emit("rejectionHandled",e):at("rejectionhandled",e,t.value)}))},lt=function(t,e,r){return function(i){t(e,i,r)}},ct=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,nt(t,!0))},ut=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Y("Promise can't be resolved itself");var i=it(e);i?T((function(){var r={done:!1};try{u(i,e,lt(ut,r,t),lt(ct,r,t))}catch(e){ct(r,e,t)}})):(t.value=e,t.state=1,nt(t,!1))}catch(e){ct({done:!1},e,t)}}};if(et&&(U=(W=function(t){_(this,U),y(t),u(i,this);var e=B(this);try{t(lt(ut,e),lt(ct,e))}catch(t){ct(e,t)}}).prototype,(i=function(t){z(this,{type:V,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=f(U,{then:function(t,e){var r=j(this),i=r.reactions,n=Q(P(this,W));return n.ok=!x(t)||t,n.fail=x(e)&&e,n.domain=D?q.domain:void 0,r.parent=!0,i[i.length]=n,0!=r.state&&nt(r,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new i,e=B(t);this.promise=t,this.resolve=lt(ut,e),this.reject=lt(ct,e)},M.f=Q=function(t){return t===W||t===a?new n(t):$(t)},!h&&x(d)&&H!==Object.prototype)){s=H.then,tt||(g(H,"then",(function(t,e){var r=this;return new W((function(t,e){u(s,r,t,e)})).then(t,e)}),{unsafe:!0}),g(H,"catch",U.catch,{unsafe:!0}));try{delete H.constructor}catch(t){}p&&p(H,U)}o({global:!0,wrap:!0,forced:et},{Promise:W}),v(W,V,!1,!0),m(V),a=c(V),o({target:V,stat:!0,forced:et},{reject:function(t){var e=Q(this);return u(e.reject,void 0,t),e.promise}}),o({target:V,stat:!0,forced:h||et},{resolve:function(t){return O(h&&this===a?W:this,t)}}),o({target:V,stat:!0,forced:rt},{all:function(t){var e=this,r=Q(e),i=r.resolve,n=r.reject,a=E((function(){var r=y(e.resolve),a=[],s=0,o=1;w(t,(function(t){var h=s++,l=!1;o++,u(r,e,t).then((function(t){l||(l=!0,a[h]=t,--o||i(a))}),n)})),--o||i(a)}));return a.error&&n(a.value),r.promise},race:function(t){var e=this,r=Q(e),i=r.reject,n=E((function(){var n=y(e.resolve);w(t,(function(t){u(n,e,t).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}})},4916:(t,e,r)=>{"use strict";var i=r(2109),n=r(2261);i({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},9714:(t,e,r)=>{"use strict";var i=r(1702),n=r(6530).PROPER,a=r(1320),s=r(9670),o=r(7976),h=r(1340),l=r(7293),c=r(7066),u="toString",d=RegExp.prototype,g=d.toString,f=i(c),p=l((function(){return"/a/b"!=g.call({source:"a",flags:"b"})})),v=n&&g.name!=u;(p||v)&&a(RegExp.prototype,u,(function(){var t=s(this),e=h(t.source),r=t.flags;return"/"+e+"/"+h(void 0===r&&o(d,t)&&!("flags"in d)?f(t):r)}),{unsafe:!0})},7852:(t,e,r)=>{"use strict";var i,n=r(2109),a=r(1702),s=r(1236).f,o=r(7466),h=r(1340),l=r(3929),c=r(4488),u=r(4964),d=r(1913),g=a("".endsWith),f=a("".slice),p=Math.min,v=u("endsWith");n({target:"String",proto:!0,forced:!(!d&&!v&&(i=s(String.prototype,"endsWith"),i&&!i.writable)||v)},{endsWith:function(t){var e=h(c(this));l(t);var r=arguments.length>1?arguments[1]:void 0,i=e.length,n=void 0===r?i:p(o(r),i),a=h(t);return g?g(e,a,n):f(e,n-a.length,n)===a}})},2023:(t,e,r)=>{"use strict";var i=r(2109),n=r(1702),a=r(3929),s=r(4488),o=r(1340),h=r(4964),l=n("".indexOf);i({target:"String",proto:!0,forced:!h("includes")},{includes:function(t){return!!~l(o(s(this)),o(a(t)),arguments.length>1?arguments[1]:void 0)}})},4723:(t,e,r)=>{"use strict";var i=r(6916),n=r(7007),a=r(9670),s=r(7466),o=r(1340),h=r(4488),l=r(8173),c=r(1530),u=r(7651);n("match",(function(t,e,r){return[function(e){var r=h(this),n=null==e?void 0:l(e,t);return n?i(n,e,r):new RegExp(e)[t](o(r))},function(t){var i=a(this),n=o(t),h=r(e,i,n);if(h.done)return h.value;if(!i.global)return u(i,n);var l=i.unicode;i.lastIndex=0;for(var d,g=[],f=0;null!==(d=u(i,n));){var p=o(d[0]);g[f]=p,""===p&&(i.lastIndex=c(n,s(i.lastIndex),l)),f++}return 0===f?null:g}]}))},5306:(t,e,r)=>{"use strict";var i=r(2104),n=r(6916),a=r(1702),s=r(7007),o=r(7293),h=r(9670),l=r(614),c=r(9303),u=r(7466),d=r(1340),g=r(4488),f=r(1530),p=r(8173),v=r(647),m=r(7651),y=r(5112)("replace"),x=Math.max,b=Math.min,_=a([].concat),S=a([].push),w=a("".indexOf),C=a("".slice),P="$0"==="a".replace(/./,"$0"),A=!!/./[y]&&""===/./[y]("a","$0");s("replace",(function(t,e,r){var a=A?"$":"$0";return[function(t,r){var i=g(this),a=null==t?void 0:p(t,y);return a?n(a,t,i,r):n(e,d(i),t,r)},function(t,n){var s=h(this),o=d(t);if("string"==typeof n&&-1===w(n,a)&&-1===w(n,"$<")){var g=r(e,s,o,n);if(g.done)return g.value}var p=l(n);p||(n=d(n));var y=s.global;if(y){var P=s.unicode;s.lastIndex=0}for(var A=[];;){var T=m(s,o);if(null===T)break;if(S(A,T),!y)break;""===d(T[0])&&(s.lastIndex=f(o,u(s.lastIndex),P))}for(var O,k="",M=0,E=0;E<A.length;E++){for(var R=d((T=A[E])[0]),L=x(b(c(T.index),o.length),0),N=[],I=1;I<T.length;I++)S(N,void 0===(O=T[I])?O:String(O));var D=T.groups;if(p){var G=_([R],N,L,o);void 0!==D&&S(G,D);var F=d(i(n,void 0,G))}else F=v(R,o,L,N,D,n);L>=M&&(k+=C(o,M,L)+F,M=L+R.length)}return k+C(o,M)}]}),!!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!P||A)},3123:(t,e,r)=>{"use strict";var i=r(2104),n=r(6916),a=r(1702),s=r(7007),o=r(7850),h=r(9670),l=r(4488),c=r(6707),u=r(1530),d=r(7466),g=r(1340),f=r(8173),p=r(206),v=r(7651),m=r(2261),y=r(2999),x=r(7293),b=y.UNSUPPORTED_Y,_=4294967295,S=Math.min,w=[].push,C=a(/./.exec),P=a(w),A=a("".slice);s("split",(function(t,e,r){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var a=g(l(this)),s=void 0===r?_:r>>>0;if(0===s)return[];if(void 0===t)return[a];if(!o(t))return n(e,a,t,s);for(var h,c,u,d=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,y=new RegExp(t.source,f+"g");(h=n(m,y,a))&&!((c=y.lastIndex)>v&&(P(d,A(a,v,h.index)),h.length>1&&h.index<a.length&&i(w,d,p(h,1)),u=h[0].length,v=c,d.length>=s));)y.lastIndex===h.index&&y.lastIndex++;return v===a.length?!u&&C(y,"")||P(d,""):P(d,A(a,v)),d.length>s?p(d,0,s):d}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:n(e,this,t,r)}:e,[function(e,r){var i=l(this),s=null==e?void 0:f(e,t);return s?n(s,e,i,r):n(a,g(i),e,r)},function(t,i){var n=h(this),s=g(t),o=r(a,n,s,i,a!==e);if(o.done)return o.value;var l=c(n,RegExp),f=n.unicode,p=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(b?"g":"y"),m=new l(b?"^(?:"+n.source+")":n,p),y=void 0===i?_:i>>>0;if(0===y)return[];if(0===s.length)return null===v(m,s)?[s]:[];for(var x=0,w=0,C=[];w<s.length;){m.lastIndex=b?0:w;var T,O=v(m,b?A(s,w):s);if(null===O||(T=S(d(m.lastIndex+(b?w:0)),s.length))===x)w=u(s,w,f);else{if(P(C,A(s,x,w)),C.length===y)return C;for(var k=1;k<=O.length-1;k++)if(P(C,O[k]),C.length===y)return C;w=x=T}}return P(C,A(s,x)),C}]}),!!x((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]})),b)},3157:(t,e,r)=>{"use strict";var i,n=r(2109),a=r(1702),s=r(1236).f,o=r(7466),h=r(1340),l=r(3929),c=r(4488),u=r(4964),d=r(1913),g=a("".startsWith),f=a("".slice),p=Math.min,v=u("startsWith");n({target:"String",proto:!0,forced:!(!d&&!v&&(i=s(String.prototype,"startsWith"),i&&!i.writable)||v)},{startsWith:function(t){var e=h(c(this));l(t);var r=o(p(arguments.length>1?arguments[1]:void 0,e.length)),i=h(t);return g?g(e,i,r):f(e,r,r+i.length)===i}})},3210:(t,e,r)=>{"use strict";var i=r(2109),n=r(3111).trim;i({target:"String",proto:!0,forced:r(153)("trim")},{trim:function(){return n(this)}})},3948:(t,e,r)=>{var i=r(7854),n=r(8324),a=r(8509),s=r(6992),o=r(8880),h=r(5112),l=h("iterator"),c=h("toStringTag"),u=s.values,d=function(t,e){if(t){if(t[l]!==u)try{o(t,l,u)}catch(e){t[l]=u}if(t[c]||o(t,c,e),n[e])for(var r in s)if(t[r]!==s[r])try{o(t,r,s[r])}catch(e){t[r]=s[r]}}};for(var g in n)d(i[g]&&i[g].prototype,g);d(a,"DOMTokenList")},75:function(t){(function(){var e,r,i,n,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(t.exports=function(){return(e()-a)/1e6},r=process.hrtime,n=(e=function(){var t;return 1e9*(t=r())[0]+t[1]})(),s=1e9*process.uptime(),a=n-s):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)},1798:function(t,e,r){t=r.nmd(t),function(r,i){"use strict";var n={};r.PubSub=n,function(t){var e={},r=-1;function i(t,e,r){try{t(e,r)}catch(t){setTimeout(function(t){return function(){throw t}}(t),0)}}function n(t,e,r){t(e,r)}function a(t,r,a,s){var o,h=e[r],l=s?n:i;if(Object.prototype.hasOwnProperty.call(e,r))for(o in h)Object.prototype.hasOwnProperty.call(h,o)&&l(h[o],t,a)}function s(t){var r=String(t);return Boolean(Object.prototype.hasOwnProperty.call(e,r)&&function(t){var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}(e[r]))}function o(t,e,r,i){var n=function(t,e,r){return function(){var i=String(t),n=i.lastIndexOf(".");for(a(t,t,e,r);-1!==n;)n=(i=i.substr(0,n)).lastIndexOf("."),a(t,i,e,r);a(t,"*",e,r)}}(t="symbol"==typeof t?t.toString():t,e,i);return!!function(t){for(var e=String(t),r=s(e)||s("*"),i=e.lastIndexOf(".");!r&&-1!==i;)i=(e=e.substr(0,i)).lastIndexOf("."),r=s(e);return r}(t)&&(!0===r?n():setTimeout(n,0),!0)}t.publish=function(e,r){return o(e,r,!1,t.immediateExceptions)},t.publishSync=function(e,r){return o(e,r,!0,t.immediateExceptions)},t.subscribe=function(t,i){if("function"!=typeof i)return!1;t="symbol"==typeof t?t.toString():t,Object.prototype.hasOwnProperty.call(e,t)||(e[t]={});var n="uid_"+String(++r);return e[t][n]=i,n},t.subscribeAll=function(e){return t.subscribe("*",e)},t.subscribeOnce=function(e,r){var i=t.subscribe(e,(function(){t.unsubscribe(i),r.apply(this,arguments)}));return t},t.clearAllSubscriptions=function(){e={}},t.clearSubscriptions=function(t){var r;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t)&&delete e[r]},t.countSubscriptions=function(t){var r,i,n=0;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t)){for(i in e[r])n++;break}return n},t.getSubscriptions=function(t){var r,i=[];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t)&&i.push(r);return i},t.unsubscribe=function(r){var i,n,a,s="string"==typeof r&&(Object.prototype.hasOwnProperty.call(e,r)||function(t){var r;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t))return!0;return!1}(r)),o=!s&&"string"==typeof r,h="function"==typeof r,l=!1;if(!s){for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(n=e[i],o&&n[r]){delete n[r],l=r;break}if(h)for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&n[a]===r&&(delete n[a],l=!0)}return l}t.clearSubscriptions(r)}}(n),void 0!==t&&t.exports&&(e=t.exports=n),e.PubSub=n,t.exports=e=n}("object"==typeof window&&window||this)},4087:(t,e,r)=>{for(var i=r(75),n="undefined"==typeof window?r.g:window,a=["moz","webkit"],s="AnimationFrame",o=n["request"+s],h=n["cancel"+s]||n["cancelRequest"+s],l=0;!o&&l<a.length;l++)o=n[a[l]+"Request"+s],h=n[a[l]+"Cancel"+s]||n[a[l]+"CancelRequest"+s];if(!o||!h){var c=0,u=0,d=[];o=function(t){if(0===d.length){var e=i(),r=Math.max(0,16.666666666666668-(e-c));c=r+e,setTimeout((function(){var t=d.slice(0);d.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(c)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(r))}return d.push({handle:++u,callback:t,cancelled:!1}),u},h=function(t){for(var e=0;e<d.length;e++)d[e].handle===t&&(d[e].cancelled=!0)}}t.exports=function(t){return o.call(n,t)},t.exports.cancel=function(){h.apply(n,arguments)},t.exports.polyfill=function(t){t||(t=n),t.requestAnimationFrame=o,t.cancelAnimationFrame=h}},6131:t=>{t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var r=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<r.length;i++){var n=r[i].re,a=r[i].process,s=n.exec(t);if(s){var o=a(s);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),r=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==r.length&&(r="0"+r),"#"+t+e+r},this.getHelpXML=function(){for(var t=new Array,i=0;i<r.length;i++)for(var n=r[i].example,a=0;a<n.length;a++)t[t.length]=n[a];for(var s in e)t[t.length]=s;var o=document.createElement("ul");for(o.setAttribute("id","rgbcolor-examples"),i=0;i<t.length;i++)try{var h=document.createElement("li"),l=new RGBColor(t[i]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+l.toHex()+"; color:"+l.toHex(),c.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+t[i]+" -> "+l.toRGB()+" -> "+l.toHex());h.appendChild(c),h.appendChild(u),o.appendChild(h)}catch(t){}return o}}},3755:(t,e,r)=>{"use strict";t.exports=r.p+"47482e1f50a40d1def18.svg"},2084:(t,e,r)=>{"use strict";t.exports=r.p+"f0ab5d58fe1ebf7d7fd0.svg"}},t=>{t(t.s=227)}]);