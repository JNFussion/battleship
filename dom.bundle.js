"use strict";(self.webpackChunkbattleship=self.webpackChunkbattleship||[]).push([[907,35,539],{231:(e,t,r)=>{var n,o,i,a,d,s=r(1798),u=r.n(s),c=r(227),l=r(9443),h=r(6838);n={win:{title:"Your enemy is now sleeping with the fishes.",subtitle:"Keep ploughing through the Sea."},defeat:{title:"You have been tossed into Davy Jones's Locker.",subtitle:"Emerge among the dead and seek revenge."}},o=(0,c.Z)(l.O.PJ1,document.getElementById("player-board")),i=(0,c.Z)(l.O.PJ2,document.getElementById("enemy-board")),a=document.getElementById("randomise-btn"),d=document.getElementById("play-btn"),window.addEventListener("load",(function(){o.drawBoard(),o.placeRandom(),i.drawBoard(),i.placeRandom()})),a.addEventListener("click",o.placeRandom),d.addEventListener("click",(function(){o.startGame(),i.startGame(),h.Z.player1.initPlayerBoard(o.getShips()),h.Z.player2.initPlayerBoard(i.getShips()),a.removeEventListener("click",o.placeRandom),document.getElementById("overlay").remove()}),{once:!0}),u().subscribe("endGame",(function(e,t){var r=document.getElementById("end-game-overlay"),i=document.getElementById("end-game-title"),a=document.getElementById("end-game-subtitle"),d=document.getElementById("new-game"),s=t===o.id?"win":"defeat";i.textContent=n[s].title,a.textContent=n[s].subtitle,d.addEventListener("click",(function(){location.reload()})),r.classList.toggle("hidden")}))},6838:(e,t,r)=>{r.d(t,{Z:()=>d});var n=r(1798),o=r.n(n),i=r(1997),a=r(9443);const d=function(){var e=(0,i.Z)(a.O.PJ1,!0),t=(0,i.Z)(a.O.PJ2,!1,!0);function r(e,t,n){var i=e.attack(t,n);if(i.goodHit){if(o().publish("newIcon",{iconType:"hit",coords:{x:i.attackedCoords[1],y:i.attackedCoords[0]},playerID:t.id}),!e.isPc()){var a=t.board.getCell(n);a.ship.isSunk()&&o().publish("showSunkenShip",{playerID:t.id,size:a.ship.size,coords:a.startCoords})}}else o().publish("newIcon",{iconType:"water",coords:{x:i.attackedCoords[1],y:i.attackedCoords[0]},playerID:t.id});t.board.allAreSunk()&&o().publish("endGame",e.id),t.isPc()&&setTimeout((function(){r(t,e)}),500)}var n={playRound:function(n){var o=n.id,i=n.coords,a=e.turn?e:t,d=a===e?t:e;a.id!==o&&r(a,d,i)},round:r};function d(e,t){n[e](t)}return o().subscribe("playRound",d),{player1:e,player2:t,subcriptionHandler:d}}()},4937:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(9443);const o=function(){var e=Array(10).fill().map((function(){return Array(10).fill()})),t=[];return{grid:e,getCell:function(r){return t[e[r[0]][r[1]]]},placeShip:function(r,o,i){if(!Array.isArray(r))throw Error("Invalid starCoords value");if(r[0]<0||r[0]>9)throw Error("Row start coord out of grid");if(r[1]<0||r[1]>9)throw Error("Column start coord out of grid");if(o!==n.E.HORIZONTAL&&o!==n.E.VERTICAL)throw Error("Invalid direction value");if(!i)throw Error("Missing ship object");if(o===n.E.HORIZONTAL&&r[1]+i.size>10)throw Error("Ship overflow grid");if(o===n.E.VERTICAL&&r[0]+i.size>10)throw Error("Ship overflow grid");for(var a=0,d=o===n.E.HORIZONTAL?r[1]:r[0];a<i.size;a+=1,d+=1){var s=o===n.E.HORIZONTAL?d:r[1],u=o===n.E.HORIZONTAL?r[0]:d;if(void 0!==e[u][s])return-1;e[u][s]=t.length}t.push(function(e,t,r){return{startCoords:e,direction:t,ship:r}}(r,o,i))},receiveAttack:function(r){if(void 0===e[r[0]][r[1]])return e[r[0]][r[1]]="W",!1;if("W"===e[r[0]][r[1]])return!1;var n=t[e[r[0]][r[1]]],o=Math.sqrt(Math.pow(r[0]-n.startCoords[0],2)+Math.pow(r[1]-n.startCoords[1],2));return n.ship.hit(o)},allAreSunk:function(){return t.every((function(e){return e.ship.isSunk()}))}}}},1997:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(4937),o=r(5386);const i=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=(0,n.Z)(),a=[],d=function(){return r},s=function(e){return!(e[0]<0||e[0]>9||e[1]<0||e[1]>9||a.some((function(t){return t[0]===e[0]&&t[1]===e[1]})))},u=function(e){e.forEach((function(e){i.placeShip(e.startCoords,e.direction,(0,o.Z)(e.size))}))},c=function(){var e,t;do{e=[Math.floor(10*Math.random()),Math.floor(10*Math.random())],t=a.some((function(t){return t[0]===e[0]&&t[1]===e[1]}))}while(t);return e};return{id:e,turn:t,board:i,isPc:d,initPlayerBoard:u,attack:function(e,t){if(d()&&(t=c()),s(t))return this.turn?(this.turn=!1,e.turn=!0,a.push(t),{goodHit:e.board.receiveAttack(t),attackedCoords:t}):void 0}}}},5386:(e,t,r)=>{r.d(t,{Z:()=>n});const n=function(e){if(![2,3,4,5].includes(e))throw RangeError("Invalid Size");var t=Array(e).fill(!1);return{size:e,hit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return!(e<0||e>=t.length)&&!0!==t[e]&&(t[e]=!0,t[e])},isSunk:function(){return t.every((function(e){return e}))}}}}},e=>{e.O(0,[519],(()=>(231,e(e.s=231)))),e.O()}]);